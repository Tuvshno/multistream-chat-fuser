"use strict";var Tf=Object.defineProperty;var Df=(n,e,t)=>e in n?Tf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var I=(n,e,t)=>(Df(n,typeof e!="symbol"?e+"":e,t),t),Zu=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var s=(n,e,t)=>(Zu(n,e,"read from private field"),t?t.call(n):e.get(n)),u=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},h=(n,e,t,r)=>(Zu(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var ed=(n,e,t,r)=>({set _(i){h(n,e,i,t)},get _(){return s(n,e,r)}}),f=(n,e,t)=>(Zu(n,e,"access private method"),t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("./main-05d12f33.js"),Of=require("crypto");require("electron");require("events");require("node:path");require("path");require("util");require("fs");require("assert");require("os");require("fs/promises");require("child_process");require("readline");require("http");require("https");require("url");require("tty");require("net");require("tls");require("buffer");require("stream");require("dns");require("constants");require("zlib");require("process");require("module");require("inspector");var vu={},bu={},zs={};function Nf(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}const Mf=Object.freeze(Object.defineProperty({__proto__:null,default:Nf},Symbol.toStringTag,{value:"Module"})),Ff=d.getAugmentedNamespace(Mf);var jf=d.commonjsGlobal&&d.commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(zs,"__esModule",{value:!0});zs.EventEmitter=void 0;const Bf=jf(Ff);var Pt;class Af{constructor(){u(this,Pt,(0,Bf.default)())}on(e,t){return s(this,Pt).on(e,t),this}once(e,t){const r=i=>{t(i),this.off(e,r)};return this.on(e,r)}off(e,t){return s(this,Pt).off(e,t),this}emit(e,t){s(this,Pt).emit(e,t)}removeAllListeners(e){return e?s(this,Pt).all.delete(e):s(this,Pt).all.clear(),this}}Pt=new WeakMap;zs.EventEmitter=Af;var Re={};Object.defineProperty(Re,"__esModule",{value:!0});Re.LogType=void 0;var Rl;(function(n){n.bidi="bidi",n.cdp="cdp",n.debug="debug",n.debugError="debug:error",n.debugInfo="debug:info"})(Rl||(Re.LogType=Rl={}));var xu={};Object.defineProperty(xu,"__esModule",{value:!0});xu.ProcessingQueue=void 0;const td=Re;var as,Gn,nr,ir,Da,oh;const Oa=class Oa{constructor(e,t){u(this,Da);u(this,as,void 0);u(this,Gn,void 0);u(this,nr,[]);u(this,ir,!1);h(this,Gn,e),h(this,as,t)}add(e,t){s(this,nr).push([e,t]),f(this,Da,oh).call(this)}};as=new WeakMap,Gn=new WeakMap,nr=new WeakMap,ir=new WeakMap,Da=new WeakSet,oh=async function(){var e;if(!s(this,ir)){for(h(this,ir,!0);s(this,nr).length>0;){const t=s(this,nr).shift();if(!t)continue;const[r,i]=t;(e=s(this,as))==null||e.call(this,Oa.LOGGER_PREFIX,"Processing event:",i),await r.then(o=>{var a;if(o.kind==="error"){(a=s(this,as))==null||a.call(this,td.LogType.debugError,"Event threw before sending:",o.error.message,o.error.stack);return}return s(this,Gn).call(this,o.value)}).catch(o=>{var a;(a=s(this,as))==null||a.call(this,td.LogType.debugError,"Event was not processed:",o==null?void 0:o.message)})}h(this,ir,!1)}},I(Oa,"LOGGER_PREFIX",`${td.LogType.debug}:queue`);let pd=Oa;xu.ProcessingQueue=pd;var Cu={},B={},ah={};Object.defineProperty(ah,"__esModule",{value:!0});var pe={};Object.defineProperty(pe,"__esModule",{value:!0});pe.EVENT_NAMES=pe.Network=pe.BrowsingContext=pe.Log=pe.Script=pe.BiDiModule=void 0;var fd;(function(n){n.Browser="browser",n.BrowsingContext="browsingContext",n.Cdp="cdp",n.Input="input",n.Log="log",n.Network="network",n.Script="script",n.Session="session"})(fd||(pe.BiDiModule=fd={}));var md;(function(n){(function(e){e.Message="script.message",e.RealmCreated="script.realmCreated",e.RealmDestroyed="script.realmDestroyed"})(n.EventNames||(n.EventNames={}))})(md||(pe.Script=md={}));var gd;(function(n){(function(e){e.LogEntryAdded="log.entryAdded"})(n.EventNames||(n.EventNames={}))})(gd||(pe.Log=gd={}));var wd;(function(n){(function(e){e.ContextCreated="browsingContext.contextCreated",e.ContextDestroyed="browsingContext.contextDestroyed",e.DomContentLoaded="browsingContext.domContentLoaded",e.DownloadWillBegin="browsingContext.downloadWillBegin",e.FragmentNavigated="browsingContext.fragmentNavigated",e.Load="browsingContext.load",e.NavigationAborted="browsingContext.navigationAborted",e.NavigationFailed="browsingContext.navigationFailed",e.NavigationStarted="browsingContext.navigationStarted",e.UserPromptClosed="browsingContext.userPromptClosed",e.UserPromptOpened="browsingContext.userPromptOpened"})(n.EventNames||(n.EventNames={}))})(wd||(pe.BrowsingContext=wd={}));var yd;(function(n){(function(e){e.AuthRequired="network.authRequired",e.BeforeRequestSent="network.beforeRequestSent",e.FetchError="network.fetchError",e.ResponseCompleted="network.responseCompleted",e.ResponseStarted="network.responseStarted"})(n.EventNames||(n.EventNames={}))})(yd||(pe.Network=yd={}));pe.EVENT_NAMES=new Set([...Object.values(fd),...Object.values(wd.EventNames),...Object.values(gd.EventNames),...Object.values(yd.EventNames),...Object.values(md.EventNames)]);var ch={};Object.defineProperty(ch,"__esModule",{value:!0});var T={};Object.defineProperty(T,"__esModule",{value:!0});T.UnderspecifiedStoragePartitionException=T.UnableToSetFileInputException=T.UnableToSetCookieException=T.NoSuchStoragePartitionException=T.UnsupportedOperationException=T.UnableToCloseBrowserException=T.UnableToCaptureScreenException=T.UnknownErrorException=T.UnknownCommandException=T.SessionNotCreatedException=T.NoSuchUserContextException=T.NoSuchScriptException=T.NoSuchRequestException=T.NoSuchNodeException=T.NoSuchInterceptException=T.NoSuchHistoryEntryException=T.NoSuchHandleException=T.NoSuchFrameException=T.NoSuchElementException=T.NoSuchAlertException=T.MoveTargetOutOfBoundsException=T.InvalidSessionIdException=T.InvalidArgumentException=T.Exception=void 0;class z{constructor(e,t,r){I(this,"error");I(this,"message");I(this,"stacktrace");this.error=e,this.message=t,this.stacktrace=r}toErrorResponse(e){return{type:"error",id:e,error:this.error,message:this.message,stacktrace:this.stacktrace}}}T.Exception=z;class $f extends z{constructor(e,t){super("invalid argument",e,t)}}T.InvalidArgumentException=$f;class Uf extends z{constructor(e,t){super("invalid session id",e,t)}}T.InvalidSessionIdException=Uf;class Lf extends z{constructor(e,t){super("move target out of bounds",e,t)}}T.MoveTargetOutOfBoundsException=Lf;class qf extends z{constructor(e,t){super("no such alert",e,t)}}T.NoSuchAlertException=qf;class Kf extends z{constructor(e,t){super("no such element",e,t)}}T.NoSuchElementException=Kf;class Hf extends z{constructor(e,t){super("no such frame",e,t)}}T.NoSuchFrameException=Hf;class zf extends z{constructor(e,t){super("no such handle",e,t)}}T.NoSuchHandleException=zf;class Wf extends z{constructor(e,t){super("no such history entry",e,t)}}T.NoSuchHistoryEntryException=Wf;class Vf extends z{constructor(e,t){super("no such intercept",e,t)}}T.NoSuchInterceptException=Vf;class Gf extends z{constructor(e,t){super("no such node",e,t)}}T.NoSuchNodeException=Gf;class Xf extends z{constructor(e,t){super("no such request",e,t)}}T.NoSuchRequestException=Xf;class Jf extends z{constructor(e,t){super("no such script",e,t)}}T.NoSuchScriptException=Jf;class Yf extends z{constructor(e,t){super("no such user context",e,t)}}T.NoSuchUserContextException=Yf;class Qf extends z{constructor(e,t){super("session not created",e,t)}}T.SessionNotCreatedException=Qf;class Zf extends z{constructor(e,t){super("unknown command",e,t)}}T.UnknownCommandException=Zf;class em extends z{constructor(e,t=new Error().stack){super("unknown error",e,t)}}T.UnknownErrorException=em;class tm extends z{constructor(e,t){super("unable to capture screen",e,t)}}T.UnableToCaptureScreenException=tm;class sm extends z{constructor(e,t){super("unable to close browser",e,t)}}T.UnableToCloseBrowserException=sm;class rm extends z{constructor(e,t){super("unsupported operation",e,t)}}T.UnsupportedOperationException=rm;class nm extends z{constructor(e,t){super("no such storage partition",e,t)}}T.NoSuchStoragePartitionException=nm;class im extends z{constructor(e,t){super("unable to set cookie",e,t)}}T.UnableToSetCookieException=im;class om extends z{constructor(e,t){super("unable to set file input",e,t)}}T.UnableToSetFileInputException=om;class am extends z{constructor(e,t){super("underspecified storage partition",e,t)}}T.UnderspecifiedStoragePartitionException=am;var uh={};Object.defineProperty(uh,"__esModule",{value:!0});(function(n){var e=d.commonjsGlobal&&d.commonjsGlobal.__createBinding||(Object.create?function(o,a,c,l){l===void 0&&(l=c);var p=Object.getOwnPropertyDescriptor(a,c);(!p||("get"in p?!a.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(o,l,p)}:function(o,a,c,l){l===void 0&&(l=c),o[l]=a[c]}),t=d.commonjsGlobal&&d.commonjsGlobal.__setModuleDefault||(Object.create?function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}:function(o,a){o.default=a}),r=d.commonjsGlobal&&d.commonjsGlobal.__importStar||function(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var c in o)c!=="default"&&Object.prototype.hasOwnProperty.call(o,c)&&e(a,o,c);return t(a,o),a},i=d.commonjsGlobal&&d.commonjsGlobal.__exportStar||function(o,a){for(var c in o)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&e(a,o,c)};Object.defineProperty(n,"__esModule",{value:!0}),n.ChromiumBidi=n.Cdp=void 0,n.Cdp=r(ah),n.ChromiumBidi=r(pe),i(ch,n),i(T,n),i(uh,n)})(B);var Eu={};Object.defineProperty(Eu,"__esModule",{value:!0});Eu.BidiNoOpParser=void 0;class cm{parseActivateParams(e){return e}parseCaptureScreenshotParams(e){return e}parseCloseParams(e){return e}parseCreateParams(e){return e}parseGetTreeParams(e){return e}parseHandleUserPromptParams(e){return e}parseNavigateParams(e){return e}parsePrintParams(e){return e}parseReloadParams(e){return e}parseSetViewportParams(e){return e}parseTraverseHistoryParams(e){return e}parseGetSessionParams(e){return e}parseSendCommandParams(e){return e}parseAddPreloadScriptParams(e){return e}parseCallFunctionParams(e){return e}parseDisownParams(e){return e}parseEvaluateParams(e){return e}parseGetRealmsParams(e){return e}parseRemovePreloadScriptParams(e){return e}parsePerformActionsParams(e){return e}parseReleaseActionsParams(e){return e}parseSetFilesParams(e){return e}parseAddInterceptParams(e){return e}parseContinueRequestParams(e){return e}parseContinueResponseParams(e){return e}parseContinueWithAuthParams(e){return e}parseFailRequestParams(e){return e}parseProvideResponseParams(e){return e}parseRemoveInterceptParams(e){return e}parseSetPermissionsParams(e){return e}parseSubscribeParams(e){return e}parseDeleteCookiesParams(e){return e}parseGetCookiesParams(e){return e}parseSetCookieParams(e){return e}}Eu.BidiNoOpParser=cm;var Su={};Object.defineProperty(Su,"__esModule",{value:!0});Su.BrowserProcessor=void 0;const Tl=B;var _t;class um{constructor(e){u(this,_t,void 0);h(this,_t,e)}close(){return setTimeout(()=>s(this,_t).sendCommand("Browser.close"),0),{}}async createUserContext(){return{userContext:(await s(this,_t).sendCommand("Target.createBrowserContext")).browserContextId}}async removeUserContext(e){if(e==="default")throw new Tl.InvalidArgumentException("`default` user context cannot be removed");try{await s(this,_t).sendCommand("Target.disposeBrowserContext",{browserContextId:e})}catch(t){throw t.message.startsWith("Failed to find context with id")?new Tl.NoSuchUserContextException(t.message):t}return{}}async getUserContexts(){const e=await s(this,_t).sendCommand("Target.getBrowserContexts");return{userContexts:[{userContext:"default"},...e.browserContextIds.map(t=>({userContext:t}))]}}}_t=new WeakMap;Su.BrowserProcessor=um;var Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});Pu.CdpProcessor=void 0;var Xn,Jn,Yn;class dm{constructor(e,t,r){u(this,Xn,void 0);u(this,Jn,void 0);u(this,Yn,void 0);h(this,Xn,e),h(this,Jn,t),h(this,Yn,r)}getSession(e){const t=e.context,r=s(this,Xn).getContext(t).cdpTarget.cdpSessionId;return r===void 0?{}:{session:r}}async sendCommand(e){return{result:await(e.session?s(this,Jn).getCdpClient(e.session):s(this,Yn)).sendCommand(e.method,e.params),session:e.session}}}Xn=new WeakMap,Jn=new WeakMap,Yn=new WeakMap;Pu.CdpProcessor=dm;var _u={},ku={},ra={},Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.uuidv4=void 0;function lm(){if("crypto"in globalThis&&"randomUUID"in globalThis.crypto)return globalThis.crypto.randomUUID();const n=new Uint8Array(16);"crypto"in globalThis&&"getRandomValues"in globalThis.crypto?globalThis.crypto.getRandomValues(n):Of.webcrypto.getRandomValues(n),n[6]=n[6]&15|64,n[8]=n[8]&63|128;const e=t=>t.reduce((r,i)=>r+i.toString(16).padStart(2,"0"),"");return[e(n.subarray(0,4)),e(n.subarray(4,6)),e(n.subarray(6,8)),e(n.subarray(8,10)),e(n.subarray(10,16))].join("-")}Ws.uuidv4=lm;var na={};Object.defineProperty(na,"__esModule",{value:!0});na.ChannelProxy=void 0;const hm=B,Dl=Re,pm=Ws;var cs,or,ar,Qn,bd,Na,dh,Ma,lh,Zn,xd,Fa,hh;const Et=class Et{constructor(e,t){u(this,Zn);u(this,Fa);u(this,cs,void 0);u(this,or,(0,pm.uuidv4)());u(this,ar,void 0);h(this,cs,e),h(this,ar,t)}async init(e,t){var o,a;const r=await f(o=Et,Na,dh).call(o,e),i=await f(a=Et,Ma,lh).call(a,e,r);return f(this,Zn,xd).call(this,e,r,t),i}async startListenerFromWindow(e,t){var r;try{const i=await f(this,Fa,hh).call(this,e);f(this,Zn,xd).call(this,e,i,t)}catch(i){(r=s(this,ar))==null||r.call(this,Dl.LogType.debugError,i)}}getEvalInWindowStr(){var r;const e=String((i,o)=>{const a=window;return a[i]===void 0?a[i]=o:(a[i](o),delete a[i]),o.sendMessage}),t=f(r=Et,Qn,bd).call(r);return`(${e})('${s(this,or)}',${t})`}};cs=new WeakMap,or=new WeakMap,ar=new WeakMap,Qn=new WeakSet,bd=function(){return`(${String(()=>{const t=[];let r=null;return{async getMessage(){return await(t.length>0?Promise.resolve():new Promise(o=>{r=o})),t.shift()},sendMessage(i){t.push(i),r!==null&&(r(),r=null)}}})})()`},Na=new WeakSet,dh=async function(e){const t=await e.cdpClient.sendCommand("Runtime.evaluate",{expression:f(this,Qn,bd).call(this),contextId:e.executionContextId,serializationOptions:{serialization:"idOnly"}});if(t.exceptionDetails||t.result.objectId===void 0)throw new Error("Cannot create channel");return t.result.objectId},Ma=new WeakSet,lh=async function(e,t){return(await e.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(i=>i.sendMessage),arguments:[{objectId:t}],executionContextId:e.executionContextId,serializationOptions:{serialization:"idOnly"}})).result.objectId},Zn=new WeakSet,xd=async function(e,t,r){var i,o;for(;;)try{const a=await e.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(async c=>await c.getMessage()),arguments:[{objectId:t}],awaitPromise:!0,executionContextId:e.executionContextId,serializationOptions:{serialization:"deep",maxDepth:((i=s(this,cs).serializationOptions)==null?void 0:i.maxObjectDepth)??void 0}});if(a.exceptionDetails)throw a.exceptionDetails;for(const c of e.associatedBrowsingContexts)r.registerEvent({type:"event",method:hm.ChromiumBidi.Script.EventNames.Message,params:{channel:s(this,cs).channel,data:e.cdpToBidiValue(a,s(this,cs).ownership??"none"),source:e.source}},c.id)}catch(a){(o=s(this,ar))==null||o.call(this,Dl.LogType.debugError,a);break}},Fa=new WeakSet,hh=async function(e){const t=await e.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(r=>{const i=window;if(i[r]===void 0)return new Promise(a=>i[r]=a);const o=i[r];return delete i[r],o}),arguments:[{value:s(this,or)}],executionContextId:e.executionContextId,awaitPromise:!0,serializationOptions:{serialization:"idOnly"}});if(t.exceptionDetails!==void 0||t.result.objectId===void 0)throw new Error(`ChannelHandle not found in window["${s(this,or)}"]`);return t.result.objectId},u(Et,Qn),u(Et,Na),u(Et,Ma);let vd=Et;na.ChannelProxy=vd;Object.defineProperty(ra,"__esModule",{value:!0});ra.Realm=void 0;const da=B,fm=Re,mm=Ws,gm=na;var ei,us,ti,cr,si,ri,kt,ja,xe,ph,ni,Cd,ii,Ed,Ba,fh,oi,Sd,ai,Pd,Aa,mh,$a,gh,ci,_d;let wm=(xe=class{constructor(e,t,r,i,o,a,c){u(this,ni);u(this,ii);u(this,Ba);u(this,oi);u(this,ci);u(this,ei,void 0);u(this,us,void 0);u(this,ti,void 0);u(this,cr,void 0);u(this,si,void 0);u(this,ri,void 0);u(this,kt,void 0);h(this,ei,e),h(this,us,t),h(this,ti,r),h(this,cr,i),h(this,si,o),h(this,ri,a),h(this,kt,c),s(this,kt).addRealm(this)}cdpToBidiValue(e,t){const r=this.serializeForBiDi(e.result.deepSerializedValue,new Map);if(e.result.objectId){const i=e.result.objectId;t==="root"?(r.handle=i,s(this,kt).knownHandlesToRealmMap.set(i,this.realmId)):f(this,ci,_d).call(this,i).catch(o=>{var a;return(a=s(this,cr))==null?void 0:a.call(this,fm.LogType.debugError,o)})}if(e.result.type==="object")switch(e.result.subtype){case"generator":case"iterator":r.type=e.result.subtype,delete r.value;break}return r}serializeForBiDi(e,t){if(Object.hasOwn(e,"weakLocalObjectReference")){const i=e.weakLocalObjectReference;t.has(i)||t.set(i,(0,mm.uuidv4)()),e.internalId=t.get(i),delete e.weakLocalObjectReference}if(e.type==="platformobject")return{type:"object"};const r=e.value;if(r===void 0)return e;if(["array","set","htmlcollection","nodelist"].includes(e.type))for(const i in r)r[i]=this.serializeForBiDi(r[i],t);if(["object","map"].includes(e.type))for(const i in r)r[i]=[this.serializeForBiDi(r[i][0],t),this.serializeForBiDi(r[i][1],t)];return e}get realmId(){return s(this,ri)}get executionContextId(){return s(this,ti)}get origin(){return s(this,si)}get source(){return{realm:this.realmId}}get cdpClient(){return s(this,ei)}get baseInfo(){return{realm:this.realmId,origin:this.origin}}async evaluate(e,t,r,i,o=!1){var c;const a=await this.cdpClient.sendCommand("Runtime.evaluate",{contextId:this.executionContextId,expression:e,awaitPromise:t,serializationOptions:f(c=xe,ai,Pd).call(c,"deep",i),userGesture:o});return a.exceptionDetails?await f(this,oi,Sd).call(this,a.exceptionDetails,0,r):{realm:this.realmId,result:this.cdpToBidiValue(a,r),type:"success"}}initialize(){for(const e of this.associatedBrowsingContexts)s(this,us).registerEvent({type:"event",method:da.ChromiumBidi.Script.EventNames.RealmCreated,params:this.realmInfo},e.id)}async serializeCdpObject(e,t){var o;const r=f(o=xe,ja,ph).call(o,e),i=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(a=>a),awaitPromise:!1,arguments:[r],serializationOptions:{serialization:"deep"},executionContextId:this.executionContextId});return this.cdpToBidiValue(i,t)}async stringifyObject(e){const{result:t}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String(r=>String(r)),awaitPromise:!1,arguments:[e],returnByValue:!0,executionContextId:this.executionContextId});return t.value}async callFunction(e,t,r,i,o,a,c=!1){var m;const l=`(...args) => {
      function callFunction(f, args) {
        const deserializedThis = args.shift();
        const deserializedArgs = args;
        return f.apply(deserializedThis, deserializedArgs);
      }
      return callFunction((
        ${e}
      ), args);
    }`,p=[await this.deserializeForCdp(t),...await Promise.all(r.map(async x=>await this.deserializeForCdp(x)))];let g;try{g=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:l,awaitPromise:i,arguments:p,serializationOptions:f(m=xe,ai,Pd).call(m,"deep",a),executionContextId:this.executionContextId,userGesture:c})}catch(x){throw x.code===-32e3&&["Could not find object with given id","Argument should belong to the same JavaScript world as target object","Invalid remote object id"].includes(x.message)?new da.NoSuchHandleException("Handle was not found."):x}return g.exceptionDetails?await f(this,oi,Sd).call(this,g.exceptionDetails,1,o):{type:"success",result:this.cdpToBidiValue(g,o),realm:this.realmId}}async deserializeForCdp(e){if("handle"in e&&e.handle)return{objectId:e.handle};if("handle"in e||"sharedId"in e)throw new da.NoSuchHandleException("Handle was not found.");switch(e.type){case"undefined":return{unserializableValue:"undefined"};case"null":return{unserializableValue:"null"};case"string":return{value:e.value};case"number":return e.value==="NaN"?{unserializableValue:"NaN"}:e.value==="-0"?{unserializableValue:"-0"}:e.value==="Infinity"?{unserializableValue:"Infinity"}:e.value==="-Infinity"?{unserializableValue:"-Infinity"}:{value:e.value};case"boolean":return{value:!!e.value};case"bigint":return{unserializableValue:`BigInt(${JSON.stringify(e.value)})`};case"date":return{unserializableValue:`new Date(Date.parse(${JSON.stringify(e.value)}))`};case"regexp":return{unserializableValue:`new RegExp(${JSON.stringify(e.value.pattern)}, ${JSON.stringify(e.value.flags)})`};case"map":{const t=await f(this,ni,Cd).call(this,e.value),{result:r}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...i)=>{const o=new Map;for(let a=0;a<i.length;a+=2)o.set(i[a],i[a+1]);return o}),awaitPromise:!1,arguments:t,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:r.objectId}}case"object":{const t=await f(this,ni,Cd).call(this,e.value),{result:r}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...i)=>{const o={};for(let a=0;a<i.length;a+=2){const c=i[a];o[c]=i[a+1]}return o}),awaitPromise:!1,arguments:t,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:r.objectId}}case"array":{const t=await f(this,ii,Ed).call(this,e.value),{result:r}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...i)=>i),awaitPromise:!1,arguments:t,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:r.objectId}}case"set":{const t=await f(this,ii,Ed).call(this,e.value),{result:r}=await this.cdpClient.sendCommand("Runtime.callFunctionOn",{functionDeclaration:String((...i)=>new Set(i)),awaitPromise:!1,arguments:t,returnByValue:!1,executionContextId:this.executionContextId});return{objectId:r.objectId}}case"channel":return{objectId:await new gm.ChannelProxy(e.value,s(this,cr)).init(this,s(this,us))}}throw new Error(`Value ${JSON.stringify(e)} is not deserializable.`)}async disown(e){s(this,kt).knownHandlesToRealmMap.get(e)===this.realmId&&(await f(this,ci,_d).call(this,e),s(this,kt).knownHandlesToRealmMap.delete(e))}dispose(){for(const e of this.associatedBrowsingContexts)s(this,us).registerEvent({type:"event",method:da.ChromiumBidi.Script.EventNames.RealmDestroyed,params:{realm:this.realmId}},e.id)}},ei=new WeakMap,us=new WeakMap,ti=new WeakMap,cr=new WeakMap,si=new WeakMap,ri=new WeakMap,kt=new WeakMap,ja=new WeakSet,ph=function(e){return e.objectId!==void 0?{objectId:e.objectId}:e.unserializableValue!==void 0?{unserializableValue:e.unserializableValue}:{value:e.value}},ni=new WeakSet,Cd=async function(e){const t=[];for(const[r,i]of e){let o;typeof r=="string"?o={value:r}:o=await this.deserializeForCdp(r);const a=await this.deserializeForCdp(i);t.push(o),t.push(a)}return t},ii=new WeakSet,Ed=async function(e){return await Promise.all(e.map(t=>this.deserializeForCdp(t)))},Ba=new WeakSet,fh=async function(e,t,r){var a;const i=((a=e.stackTrace)==null?void 0:a.callFrames.map(c=>({url:c.url,functionName:c.functionName,lineNumber:c.lineNumber-t,columnNumber:c.columnNumber})))??[],o=e.exception;return{exception:await this.serializeCdpObject(o,r),columnNumber:e.columnNumber,lineNumber:e.lineNumber-t,stackTrace:{callFrames:i},text:await this.stringifyObject(o)||e.text}},oi=new WeakSet,Sd=async function(e,t,r){return{exceptionDetails:await f(this,Ba,fh).call(this,e,t,r),realm:this.realmId,type:"exception"}},ai=new WeakSet,Pd=function(e,t){var r,i;return{serialization:e,additionalParameters:f(r=xe,Aa,mh).call(r,t),...f(i=xe,$a,gh).call(i,t)}},Aa=new WeakSet,mh=function(e){const t={};return e.maxDomDepth!==void 0&&(t.maxNodeDepth=e.maxDomDepth===null?1e3:e.maxDomDepth),e.includeShadowTree!==void 0&&(t.includeShadowTree=e.includeShadowTree),t},$a=new WeakSet,gh=function(e){return e.maxObjectDepth===void 0||e.maxObjectDepth===null?{}:{maxDepth:e.maxObjectDepth}},ci=new WeakSet,_d=async function(e){try{await this.cdpClient.sendCommand("Runtime.releaseObject",{objectId:e})}catch(t){if(!(t.code===-32e3&&t.message==="Invalid remote object id"))throw t}},u(xe,ja),u(xe,ai),u(xe,Aa),u(xe,$a),xe);ra.Realm=wm;Object.defineProperty(ku,"__esModule",{value:!0});ku.DedicatedWorkerRealm=void 0;const ym=ra;var ur,eh;let vm=(eh=class extends ym.Realm{constructor(t,r,i,o,a,c,l,p){super(t,r,i,o,a,l,p);u(this,ur,void 0);h(this,ur,c),this.initialize()}get associatedBrowsingContexts(){return s(this,ur).associatedBrowsingContexts}get realmType(){return"dedicated-worker"}get source(){var t;return{realm:this.realmId,context:(t=this.associatedBrowsingContexts[0])==null?void 0:t.id}}get realmInfo(){return{...this.baseInfo,type:this.realmType,owners:[s(this,ur).realmId]}}},ur=new WeakMap,eh);ku.DedicatedWorkerRealm=vm;var Pn={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.assert=void 0;function bm(n,e){if(!n)throw new Error(e??"Internal assertion failed.")}Ue.assert=bm;var In={};Object.defineProperty(In,"__esModule",{value:!0});In.Deferred=void 0;var It,Rt,ui,di,Jy;class xm{constructor(){u(this,It,!1);u(this,Rt,void 0);u(this,ui,void 0);u(this,di,void 0);I(this,Jy,"Promise");h(this,Rt,new Promise((e,t)=>{h(this,ui,e),h(this,di,t)})),s(this,Rt).catch(e=>{})}get isFinished(){return s(this,It)}then(e,t){return s(this,Rt).then(e,t)}catch(e){return s(this,Rt).catch(e)}resolve(e){s(this,It)||(h(this,It,!0),s(this,ui).call(this,e))}reject(e){s(this,It)||(h(this,It,!0),s(this,di).call(this,e))}finally(e){return s(this,Rt).finally(e)}}Jy=Symbol.toStringTag,It=new WeakMap,Rt=new WeakMap,ui=new WeakMap,di=new WeakMap;In.Deferred=xm;var Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});Iu.inchesFromCm=void 0;function Cm(n){return n/2.54}Iu.inchesFromCm=Cm;var ia={},_n={};Object.defineProperty(_n,"__esModule",{value:!0});_n.parseSharedId=_n.getSharedId=void 0;const wh="_element_";function Em(n,e,t,r){return r?`f.${n}.d.${e}.e.${t}`:`${e}${wh}${t}`}_n.getSharedId=Em;function Sm(n){const e=n.match(new RegExp(`(.*)${wh}(.*)`));if(!e)return null;const t=e[1],r=e[2];if(t===void 0||r===void 0)return null;const i=parseInt(r??"");return isNaN(i)?null:{documentId:t,backendNodeId:i}}function Pm(n){const e=Sm(n);if(e!==null)return{...e,frameId:void 0};const t=n.match(/f\.(.*)\.d\.(.*)\.e\.([0-9]*)/);if(!t)return null;const r=t[1],i=t[2],o=t[3];if(r===void 0||i===void 0||o===void 0)return null;const a=parseInt(o??"");return isNaN(a)?null:{frameId:r,documentId:i,backendNodeId:a}}_n.parseSharedId=Pm;Object.defineProperty(ia,"__esModule",{value:!0});ia.WindowRealm=void 0;const la=B,_m=ra,Ol=_n;var Tt,Dt,li,Ua,yh,th;let km=(th=class extends _m.Realm{constructor(t,r,i,o,a,c,l,p,g,m,x){super(i,o,a,c,l,p,g);u(this,Ua);u(this,Tt,void 0);u(this,Dt,void 0);u(this,li,void 0);I(this,"sandbox");h(this,Tt,t),h(this,Dt,r),h(this,li,x),this.sandbox=m,this.initialize()}get browsingContext(){return s(this,Dt).getContext(s(this,Tt))}get associatedBrowsingContexts(){return[this.browsingContext]}get realmType(){return"window"}get realmInfo(){return{...this.baseInfo,type:this.realmType,context:s(this,Tt),sandbox:this.sandbox}}get source(){return{realm:this.realmId,context:this.browsingContext.id}}serializeForBiDi(t,r){const i=t.value;if(t.type==="node"){if(Object.hasOwn(i,"backendNodeId")){let o=this.browsingContext.navigableId??"UNKNOWN";Object.hasOwn(i,"loaderId")&&(o=i.loaderId,delete i.loaderId),t.sharedId=(0,Ol.getSharedId)(f(this,Ua,yh).call(this,o),o,i.backendNodeId,s(this,li)),delete i.backendNodeId}if(Object.hasOwn(i,"children"))for(const o in i.children)i.children[o]=this.serializeForBiDi(i.children[o],r);Object.hasOwn(i,"shadowRoot")&&i.shadowRoot!==null&&(i.shadowRoot=this.serializeForBiDi(i.shadowRoot,r)),i.namespaceURI===""&&(i.namespaceURI=null)}return super.serializeForBiDi(t,r)}async deserializeForCdp(t){if("sharedId"in t&&t.sharedId){const r=(0,Ol.parseSharedId)(t.sharedId);if(r===null)throw new la.NoSuchNodeException(`SharedId "${t.sharedId}" was not found.`);const{documentId:i,backendNodeId:o}=r;if(this.browsingContext.navigableId!==i)throw new la.NoSuchNodeException(`SharedId "${t.sharedId}" belongs to different document. Current document is ${this.browsingContext.navigableId}.`);try{const{object:a}=await this.cdpClient.sendCommand("DOM.resolveNode",{backendNodeId:o,executionContextId:this.executionContextId});return{objectId:a.objectId}}catch(a){throw a.code===-32e3&&a.message==="No node with given id found"?new la.NoSuchNodeException(`SharedId "${t.sharedId}" was not found.`):new la.UnknownErrorException(a.message,a.stack)}}return await super.deserializeForCdp(t)}async evaluate(t,r,i,o,a){return await s(this,Dt).getContext(s(this,Tt)).targetUnblockedOrThrow(),await super.evaluate(t,r,i,o,a)}async callFunction(t,r,i,o,a,c,l){return await s(this,Dt).getContext(s(this,Tt)).targetUnblockedOrThrow(),await super.callFunction(t,r,i,o,a,c,l)}},Tt=new WeakMap,Dt=new WeakMap,li=new WeakMap,Ua=new WeakSet,yh=function(t){const r=s(this,Dt).getAllContexts().find(i=>i.navigableId===t);return(r==null?void 0:r.id)??"UNKNOWN"},th);ia.WindowRealm=km;Object.defineProperty(Pn,"__esModule",{value:!0});Pn.serializeOrigin=Pn.BrowsingContextImpl=void 0;const H=B,Vs=Ue,Gs=In,Im=Re,Xs=Iu,Rm=ia;var ds,ls,dr,Ot,Q,Nt,Te,we,Ke,He,j,lr,hi,Mt,pi,Id,fi,Rd,mi,Td,gi,Dd,wi,Od,La,vh,qa,bh;const qe=class qe{constructor(e,t,r,i,o,a,c,l,p){u(this,pi);u(this,fi);u(this,mi);u(this,gi);u(this,wi);u(this,La);u(this,qa);u(this,ds,void 0);I(this,"userContext");u(this,ls,void 0);u(this,dr,new Set);u(this,Ot,void 0);u(this,Q,{DOMContentLoaded:new Gs.Deferred,load:new Gs.Deferred});u(this,Nt,{withinDocument:new Gs.Deferred});u(this,Te,"about:blank");u(this,we,void 0);u(this,Ke,void 0);u(this,He,void 0);u(this,j,void 0);u(this,lr,void 0);u(this,hi,void 0);u(this,Mt,void 0);h(this,j,e),h(this,Ke,t),h(this,ds,r),h(this,ls,i),this.userContext=o,h(this,we,a),h(this,Ot,c),h(this,hi,l),h(this,Mt,p)}static create(e,t,r,i,o,a,c,l,p){var m;const g=new qe(e,t,r,i,o,a,c,l,p);return f(m=g,mi,Td).call(m),c.addContext(g),g.isTopLevelContext()||g.parent.addChild(g.id),a.registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.ContextCreated,params:g.serializeToBidiValue()},g.id),g}static getTimestamp(){return new Date().getTime()}get navigableId(){return s(this,He)}dispose(){f(this,pi,Id).call(this),s(this,Ke).deleteRealms({browsingContextId:this.id}),this.isTopLevelContext()||s(this.parent,dr).delete(this.id),f(this,La,vh).call(this),s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.ContextDestroyed,params:this.serializeToBidiValue()},this.id),s(this,Ot).deleteContextById(this.id)}get id(){return s(this,ds)}get parentId(){return s(this,ls)}get parent(){return this.parentId===null?null:s(this,Ot).getContext(this.parentId)}get directChildren(){return[...s(this,dr)].map(e=>s(this,Ot).getContext(e))}get allChildren(){const e=this.directChildren;return e.concat(...e.map(t=>t.allChildren))}isTopLevelContext(){return s(this,ls)===null}get top(){let e=this,t=e.parent;for(;t;)e=t,t=e.parent;return e}addChild(e){s(this,dr).add(e)}get cdpTarget(){return s(this,j)}updateCdpTarget(e){h(this,j,e),f(this,mi,Td).call(this)}get url(){return s(this,Te)}async lifecycleLoaded(){await s(this,Q).load}async targetUnblockedOrThrow(){const e=await s(this,j).unblocked;if(e.kind==="error")throw e.error}async getOrCreateSandbox(e){if(e===void 0||e==="")return s(this,fi,Rd);let t=s(this,Ke).findRealms({browsingContextId:this.id,sandbox:e});return t.length===0&&(await s(this,j).cdpClient.sendCommand("Page.createIsolatedWorld",{frameId:this.id,worldName:e}),t=s(this,Ke).findRealms({browsingContextId:this.id,sandbox:e}),(0,Vs.assert)(t.length!==0)),t[0]}serializeToBidiValue(e=0,t=!0){return{context:s(this,ds),url:this.url,userContext:this.userContext,children:e>0?this.directChildren.map(r=>r.serializeToBidiValue(e-1,!1)):null,...t?{parent:s(this,ls)}:{}}}onTargetInfoChanged(e){h(this,Te,e.targetInfo.url)}async navigate(e,t){try{new URL(e)}catch{throw new H.InvalidArgumentException(`Invalid URL: ${e}`)}await this.targetUnblockedOrThrow();const r=await s(this,j).cdpClient.sendCommand("Page.navigate",{url:e,frameId:this.id});if(r.errorText)throw new H.UnknownErrorException(r.errorText);switch(f(this,gi,Dd).call(this,r.loaderId),t){case"none":break;case"interactive":r.loaderId===void 0?await s(this,Nt).withinDocument:await s(this,Q).DOMContentLoaded;break;case"complete":r.loaderId===void 0?await s(this,Nt).withinDocument:await s(this,Q).load;break}return{navigation:r.loaderId??null,url:t==="none"?e:s(this,Te)}}async reload(e,t){switch(await this.targetUnblockedOrThrow(),await s(this,j).cdpClient.sendCommand("Page.reload",{ignoreCache:e}),f(this,wi,Od).call(this),t){case"none":break;case"interactive":await s(this,Q).DOMContentLoaded;break;case"complete":await s(this,Q).load;break}return{navigation:t==="none"?null:this.navigableId??null,url:this.url}}async setViewport(e,t){if(e===null&&t===null)await s(this,j).cdpClient.sendCommand("Emulation.clearDeviceMetricsOverride");else try{await s(this,j).cdpClient.sendCommand("Emulation.setDeviceMetricsOverride",{width:e?e.width:0,height:e?e.height:0,deviceScaleFactor:t||0,mobile:!1,dontSetVisibleSize:!0})}catch(r){throw r.message.startsWith("Width and height values must be positive")?new H.UnsupportedOperationException("Provided viewport dimensions are not supported"):r}}async handleUserPrompt(e){await s(this,j).cdpClient.sendCommand("Page.handleJavaScriptDialog",{accept:e.accept??!0,promptText:e.userText})}async activate(){await s(this,j).cdpClient.sendCommand("Page.bringToFront")}async captureScreenshot(e){if(!this.isTopLevelContext())throw new H.UnsupportedOperationException(`Non-top-level 'context' (${e.context}) is currently not supported`);const t=Tm(e);await s(this,j).cdpClient.sendCommand("Page.bringToFront");let r=!1,i;switch(e.origin??(e.origin="viewport"),e.origin){case"document":{i=String(()=>{const p=document.documentElement;return{x:0,y:0,width:p.scrollWidth,height:p.scrollHeight}}),r=!0;break}case"viewport":{i=String(()=>{const p=window.visualViewport;return{x:p.pageLeft,y:p.pageTop,width:p.width,height:p.height}});break}}const a=await(await this.getOrCreateSandbox(void 0)).callFunction(i,{type:"undefined"},[],!1,"none",{},!1);(0,Vs.assert)(a.type==="success");const c=Nl(a.result);(0,Vs.assert)(c);const l=e.clip?Dm(await f(this,qa,bh).call(this,e.clip),c):c;if(l.width===0||l.height===0)throw new H.UnableToCaptureScreenException(`Unable to capture screenshot with zero dimensions: width=${l.width}, height=${l.height}`);return await s(this,j).cdpClient.sendCommand("Page.captureScreenshot",{clip:{...l,scale:1},...t,captureBeyondViewport:r})}async print(e){var r,i,o,a,c,l;const t={};if(e.background!==void 0&&(t.printBackground=e.background),((r=e.margin)==null?void 0:r.bottom)!==void 0&&(t.marginBottom=(0,Xs.inchesFromCm)(e.margin.bottom)),((i=e.margin)==null?void 0:i.left)!==void 0&&(t.marginLeft=(0,Xs.inchesFromCm)(e.margin.left)),((o=e.margin)==null?void 0:o.right)!==void 0&&(t.marginRight=(0,Xs.inchesFromCm)(e.margin.right)),((a=e.margin)==null?void 0:a.top)!==void 0&&(t.marginTop=(0,Xs.inchesFromCm)(e.margin.top)),e.orientation!==void 0&&(t.landscape=e.orientation==="landscape"),((c=e.page)==null?void 0:c.height)!==void 0&&(t.paperHeight=(0,Xs.inchesFromCm)(e.page.height)),((l=e.page)==null?void 0:l.width)!==void 0&&(t.paperWidth=(0,Xs.inchesFromCm)(e.page.width)),e.pageRanges!==void 0){for(const p of e.pageRanges){if(typeof p=="number")continue;const g=p.split("-");if(g.length<1||g.length>2)throw new H.InvalidArgumentException(`Invalid page range: ${p} is not a valid integer range.`);if(g.length===1){sd(g[0]??"");continue}let m,x;const[C="",v=""]=g;if(C===""?m=1:m=sd(C),v===""?x=Number.MAX_SAFE_INTEGER:x=sd(v),m>x)throw new H.InvalidArgumentException(`Invalid page range: ${C} > ${v}`)}t.pageRanges=e.pageRanges.join(",")}e.scale!==void 0&&(t.scale=e.scale),e.shrinkToFit!==void 0&&(t.preferCSSPageSize=!e.shrinkToFit);try{return{data:(await s(this,j).cdpClient.sendCommand("Page.printToPDF",t)).data}}catch(p){throw p.message==="invalid print parameters: content area is empty"?new H.UnsupportedOperationException(p.message):p}}async close(){await s(this,j).cdpClient.sendCommand("Page.close")}async traverseHistory(e){if(e===0)return;const t=await s(this,j).cdpClient.sendCommand("Page.getNavigationHistory"),r=t.entries[t.currentIndex+e];if(!r)throw new H.NoSuchHistoryEntryException(`No history entry at delta ${e}`);await s(this,j).cdpClient.sendCommand("Page.navigateToHistoryEntry",{entryId:r.id})}};ds=new WeakMap,ls=new WeakMap,dr=new WeakMap,Ot=new WeakMap,Q=new WeakMap,Nt=new WeakMap,Te=new WeakMap,we=new WeakMap,Ke=new WeakMap,He=new WeakMap,j=new WeakMap,lr=new WeakMap,hi=new WeakMap,Mt=new WeakMap,pi=new WeakSet,Id=function(){this.directChildren.map(e=>e.dispose())},fi=new WeakSet,Rd=function(){return(0,Vs.assert)(s(this,lr),`No default realm for browsing context ${s(this,ds)}`),s(this,lr)},mi=new WeakSet,Td=function(){s(this,j).cdpClient.on("Page.frameNavigated",e=>{this.id===e.frame.id&&(h(this,Te,e.frame.url+(e.frame.urlFragment??"")),f(this,pi,Id).call(this))}),s(this,j).cdpClient.on("Page.navigatedWithinDocument",e=>{if(this.id!==e.frameId)return;const t=qe.getTimestamp();h(this,Te,e.url),s(this,Nt).withinDocument.resolve(e),s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.FragmentNavigated,params:{context:this.id,navigation:null,timestamp:t,url:s(this,Te)}},this.id)}),s(this,j).cdpClient.on("Page.frameStartedLoading",e=>{this.id===e.frameId&&s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.NavigationStarted,params:{context:this.id,navigation:null,timestamp:qe.getTimestamp(),url:""}},this.id)}),s(this,j).cdpClient.on("Page.lifecycleEvent",e=>{if(this.id!==e.frameId)return;if(e.name==="init"){f(this,gi,Dd).call(this,e.loaderId);return}if(e.name==="commit"){h(this,He,e.loaderId);return}if(e.loaderId!==s(this,He))return;const t=qe.getTimestamp();switch(e.name){case"DOMContentLoaded":s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.DomContentLoaded,params:{context:this.id,navigation:s(this,He)??null,timestamp:t,url:s(this,Te)}},this.id),s(this,Q).DOMContentLoaded.resolve(e);break;case"load":s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.Load,params:{context:this.id,navigation:s(this,He)??null,timestamp:t,url:s(this,Te)}},this.id),s(this,Q).load.resolve(e);break}}),s(this,j).cdpClient.on("Runtime.executionContextCreated",e=>{const{auxData:t,name:r,uniqueId:i,id:o}=e.context;if(!t||t.frameId!==this.id)return;let a,c;switch(t.type){case"isolated":c=r,a=s(this,fi,Rd).origin;break;case"default":a=xh(e.context.origin);break;default:return}const l=new Rm.WindowRealm(this.id,s(this,Ot),s(this,j).cdpClient,s(this,we),o,s(this,Mt),a,i,s(this,Ke),c,s(this,hi));t.isDefault&&(h(this,lr,l),Promise.all(s(this,j).getChannels().map(p=>p.startListenerFromWindow(l,s(this,we)))))}),s(this,j).cdpClient.on("Runtime.executionContextDestroyed",e=>{s(this,Ke).deleteRealms({cdpSessionId:s(this,j).cdpSessionId,executionContextId:e.executionContextId})}),s(this,j).cdpClient.on("Runtime.executionContextsCleared",()=>{s(this,Ke).deleteRealms({cdpSessionId:s(this,j).cdpSessionId})}),s(this,j).cdpClient.on("Page.javascriptDialogClosed",e=>{const t=e.result;s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.UserPromptClosed,params:{context:this.id,accepted:t,userText:t&&e.userInput?e.userInput:void 0}},this.id)}),s(this,j).cdpClient.on("Page.javascriptDialogOpening",e=>{s(this,we).registerEvent({type:"event",method:H.ChromiumBidi.BrowsingContext.EventNames.UserPromptOpened,params:{context:this.id,type:e.type,message:e.message,defaultValue:e.defaultPrompt||void 0}},this.id)})},gi=new WeakSet,Dd=function(e){var t;if(e===void 0||s(this,He)===e){s(this,Nt).withinDocument.isFinished?s(this,Nt).withinDocument=new Gs.Deferred:(t=s(this,Mt))==null||t.call(this,qe.LOGGER_PREFIX,"Document changed (navigatedWithinDocument)");return}f(this,wi,Od).call(this),h(this,He,e)},wi=new WeakSet,Od=function(){var e,t;s(this,Q).DOMContentLoaded.isFinished?s(this,Q).DOMContentLoaded=new Gs.Deferred:(e=s(this,Mt))==null||e.call(this,qe.LOGGER_PREFIX,"Document changed (DOMContentLoaded)"),s(this,Q).load.isFinished?s(this,Q).load=new Gs.Deferred:(t=s(this,Mt))==null||t.call(this,qe.LOGGER_PREFIX,"Document changed (load)")},La=new WeakSet,vh=function(){s(this,Q).DOMContentLoaded.isFinished||s(this,Q).DOMContentLoaded.reject(new H.UnknownErrorException("navigation canceled")),s(this,Q).load.isFinished||s(this,Q).load.reject(new H.UnknownErrorException("navigation canceled"))},qa=new WeakSet,bh=async function(e){switch(e.type){case"box":return{x:e.x,y:e.y,width:e.width,height:e.height};case"element":{const t=await this.getOrCreateSandbox(void 0),r=await t.callFunction(String(i=>i instanceof Element),{type:"undefined"},[e.element],!1,"none",{});if(r.type==="exception")throw new H.NoSuchElementException(`Element '${e.element.sharedId}' was not found`);if((0,Vs.assert)(r.result.type==="boolean"),!r.result.value)throw new H.NoSuchElementException(`Node '${e.element.sharedId}' is not an Element`);{const i=await t.callFunction(String(a=>{const c=a.getBoundingClientRect();return{x:c.x,y:c.y,height:c.height,width:c.width}}),{type:"undefined"},[e.element],!1,"none",{});(0,Vs.assert)(i.type==="success");const o=Nl(i.result);if(!o)throw new H.UnableToCaptureScreenException(`Could not get bounding box for Element '${e.element.sharedId}'`);return o}}}},I(qe,"LOGGER_PREFIX",`${Im.LogType.debug}:browsingContext`);let kd=qe;Pn.BrowsingContextImpl=kd;function xh(n){return["://",""].includes(n)&&(n="null"),n}Pn.serializeOrigin=xh;function Tm(n){const{quality:e,type:t}=n.format??{type:"image/png"};switch(t){case"image/png":return{format:"png"};case"image/jpeg":return{format:"jpeg",...e===void 0?{}:{quality:Math.round(e*100)}};case"image/webp":return{format:"webp",...e===void 0?{}:{quality:Math.round(e*100)}}}throw new H.InvalidArgumentException(`Image format '${t}' is not a supported format`)}function Nl(n){var o,a,c,l;if(n.type!=="object"||n.value===void 0)return;const e=(o=n.value.find(([p])=>p==="x"))==null?void 0:o[1],t=(a=n.value.find(([p])=>p==="y"))==null?void 0:a[1],r=(c=n.value.find(([p])=>p==="height"))==null?void 0:c[1],i=(l=n.value.find(([p])=>p==="width"))==null?void 0:l[1];if(!((e==null?void 0:e.type)!=="number"||(t==null?void 0:t.type)!=="number"||(r==null?void 0:r.type)!=="number"||(i==null?void 0:i.type)!=="number"))return{x:e.value,y:t.value,width:i.value,height:r.value}}function Ml(n){return{...n.width<0?{x:n.x+n.width,width:-n.width}:{x:n.x,width:n.width},...n.height<0?{y:n.y+n.height,height:-n.height}:{y:n.y,height:n.height}}}function Dm(n,e){n=Ml(n),e=Ml(e);const t=Math.max(n.x,e.x),r=Math.max(n.y,e.y);return{x:t,y:r,width:Math.max(Math.min(n.x+n.width,e.x+e.width)-t,0),height:Math.max(Math.min(n.y+n.height,e.y+e.height)-r,0)}}function sd(n){if(n=n.trim(),!/^[0-9]+$/.test(n))throw new H.InvalidArgumentException(`Invalid integer: ${n}`);return parseInt(n)}var Ru={},Tu={},kn={};Object.defineProperty(kn,"__esModule",{value:!0});kn.getRemoteValuesText=kn.logMessageFormatter=void 0;const Om=Ue,Ch=["%s","%d","%i","%f","%o","%O","%c"];function Eh(n){return Ch.some(e=>n.includes(e))}function Sh(n){let e="";const t=n[0].value.toString(),r=n.slice(1,void 0),i=t.split(new RegExp(Ch.map(o=>`(${o})`).join("|"),"g"));for(const o of i)if(!(o===void 0||o===""))if(Eh(o)){const a=r.shift();(0,Om.assert)(a,`Less value is provided: "${Md(n,!1)}"`),o==="%s"?e+=xl(a):o==="%d"||o==="%i"?a.type==="bigint"||a.type==="number"||a.type==="string"?e+=parseInt(a.value.toString(),10):e+="NaN":o==="%f"?a.type==="bigint"||a.type==="number"||a.type==="string"?e+=parseFloat(a.value.toString()):e+="NaN":e+=Nd(a)}else e+=o;if(r.length>0)throw new Error(`More value is provided: "${Md(n,!1)}"`);return e}kn.logMessageFormatter=Sh;function Nd(n){var e;if(n.type!=="array"&&n.type!=="bigint"&&n.type!=="date"&&n.type!=="number"&&n.type!=="object"&&n.type!=="string")return xl(n);if(n.type==="bigint")return`${n.value.toString()}n`;if(n.type==="number")return n.value.toString();if(["date","string"].includes(n.type))return JSON.stringify(n.value);if(n.type==="object")return`{${n.value.map(t=>`${JSON.stringify(t[0])}:${Nd(t[1])}`).join(",")}}`;if(n.type==="array")return`[${((e=n.value)==null?void 0:e.map(t=>Nd(t)).join(","))??""}]`;throw Error(`Invalid value type: ${n}`)}function xl(n){var e,t,r,i;if(!Object.hasOwn(n,"value"))return n.type;switch(n.type){case"string":case"number":case"boolean":case"bigint":return String(n.value);case"regexp":return`/${n.value.pattern}/${n.value.flags??""}`;case"date":return new Date(n.value).toString();case"object":return`Object(${((e=n.value)==null?void 0:e.length)??""})`;case"array":return`Array(${((t=n.value)==null?void 0:t.length)??""})`;case"map":return`Map(${(r=n.value)==null?void 0:r.length})`;case"set":return`Set(${(i=n.value)==null?void 0:i.length})`;default:return n.type}}function Md(n,e){const t=n[0];return t?t.type==="string"&&Eh(t.value.toString())&&e?Sh(n):n.map(r=>xl(r)).join(" "):""}kn.getRemoteValuesText=Md;Object.defineProperty(Tu,"__esModule",{value:!0});Tu.LogManager=void 0;const ha=B,Fl=Re,Nm=kn;function jl(n){const e=n==null?void 0:n.callFrames.map(t=>({columnNumber:t.columnNumber,functionName:t.functionName,lineNumber:t.lineNumber,url:t.url}));return e?{callFrames:e}:void 0}function Mm(n){return["error","assert"].includes(n)?"error":["debug","trace"].includes(n)?"debug":["warn","warning"].includes(n)?"warn":"info"}var hr,pr,Ft,fr,Ka,Ph,Ha,_h;const Wn=class Wn{constructor(e,t,r,i){u(this,Ka);u(this,hr,void 0);u(this,pr,void 0);u(this,Ft,void 0);u(this,fr,void 0);h(this,Ft,e),h(this,pr,t),h(this,hr,r),h(this,fr,i)}static create(e,t,r,i){var a;const o=new Wn(e,t,r,i);return f(a=o,Ka,Ph).call(a),o}};hr=new WeakMap,pr=new WeakMap,Ft=new WeakMap,fr=new WeakMap,Ka=new WeakSet,Ph=function(){s(this,Ft).cdpClient.on("Runtime.consoleAPICalled",e=>{var i;const t=s(this,pr).findRealm({cdpSessionId:s(this,Ft).cdpSessionId,executionContextId:e.executionContextId});if(t===void 0){(i=s(this,fr))==null||i.call(this,Fl.LogType.cdp,e);return}const r=t===void 0?Promise.resolve(e.args):Promise.all(e.args.map(o=>t.serializeCdpObject(o,"none")));for(const o of t.associatedBrowsingContexts)s(this,hr).registerPromiseEvent(r.then(a=>({kind:"success",value:{type:"event",method:ha.ChromiumBidi.Log.EventNames.LogEntryAdded,params:{level:Mm(e.type),source:t.source,text:(0,Nm.getRemoteValuesText)(a,!0),timestamp:Math.round(e.timestamp),stackTrace:jl(e.stackTrace),type:"console",method:e.type==="warning"?"warn":e.type,args:a}}})),o.id,ha.ChromiumBidi.Log.EventNames.LogEntryAdded)}),s(this,Ft).cdpClient.on("Runtime.exceptionThrown",e=>{var r,i;const t=s(this,pr).findRealm({cdpSessionId:s(this,Ft).cdpSessionId,executionContextId:e.exceptionDetails.executionContextId});if(t===void 0){(r=s(this,fr))==null||r.call(this,Fl.LogType.cdp,e);return}for(const o of t.associatedBrowsingContexts)s(this,hr).registerPromiseEvent(f(i=Wn,Ha,_h).call(i,e,t).then(a=>({kind:"success",value:{type:"event",method:ha.ChromiumBidi.Log.EventNames.LogEntryAdded,params:{level:"error",source:t.source,text:a,timestamp:Math.round(e.timestamp),stackTrace:jl(e.exceptionDetails.stackTrace),type:"javascript"}}})),o.id,ha.ChromiumBidi.Log.EventNames.LogEntryAdded)})},Ha=new WeakSet,_h=async function(e,t){return e.exceptionDetails.exception?t===void 0?JSON.stringify(e.exceptionDetails.exception):await t.stringifyObject(e.exceptionDetails.exception):e.exceptionDetails.text},u(Wn,Ha);let Fd=Wn;Tu.LogManager=Fd;var Du={},Ou={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.bidiToCdpCookie=X.cdpToBiDiCookie=X.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction=X.cdpFetchHeadersFromBidiNetworkHeaders=X.bidiNetworkHeadersFromCdpFetchHeaders=X.cdpNetworkHeadersFromBidiNetworkHeaders=X.bidiNetworkHeadersFromCdpNetworkHeaders=X.computeHeadersSize=void 0;const kh=T;function Fm(n){const e=n.reduce((t,r)=>`${t}${r.name}: ${r.value.value}\r
`,"");return new TextEncoder().encode(e).length}X.computeHeadersSize=Fm;function jm(n){return n?Object.entries(n).map(([e,t])=>({name:e,value:{type:"string",value:t}})):[]}X.bidiNetworkHeadersFromCdpNetworkHeaders=jm;function Bm(n){if(n!==void 0)return n.reduce((e,t)=>(e[t.name]=t.value.value,e),{})}X.cdpNetworkHeadersFromBidiNetworkHeaders=Bm;function Am(n){return n?n.map(({name:e,value:t})=>({name:e,value:{type:"string",value:t}})):[]}X.bidiNetworkHeadersFromCdpFetchHeaders=Am;function $m(n){if(n!==void 0)return n.map(({name:e,value:t})=>({name:e,value:t.value}))}X.cdpFetchHeadersFromBidiNetworkHeaders=$m;function Um(n){switch(n){case"default":return"Default";case"cancel":return"CancelAuth";case"provideCredentials":return"ProvideCredentials"}}X.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction=Um;function Lm(n){const e={name:n.name,value:{type:"string",value:n.value},domain:n.domain,path:n.path,size:n.size,httpOnly:n.httpOnly,secure:n.secure,sameSite:n.sameSite===void 0?"none":Km(n.sameSite),...n.expires>=0?{expiry:n.expires}:void 0};return e["goog:session"]=n.session,e["goog:priority"]=n.priority,e["goog:sameParty"]=n.sameParty,e["goog:sourceScheme"]=n.sourceScheme,e["goog:sourcePort"]=n.sourcePort,n.partitionKey!==void 0&&(e["goog:partitionKey"]=n.partitionKey),n.partitionKeyOpaque!==void 0&&(e["goog:partitionKeyOpaque"]=n.partitionKeyOpaque),e}X.cdpToBiDiCookie=Lm;function qm(n,e){if(n.cookie.value.type!=="string")throw new kh.UnsupportedOperationException("Only string cookie values are supported");const t=n.cookie.value.value,r={name:n.cookie.name,value:t,domain:n.cookie.domain,path:n.cookie.path??"/",secure:n.cookie.secure??!1,httpOnly:n.cookie.httpOnly??!1,...e.sourceOrigin!==void 0&&{partitionKey:e.sourceOrigin},...n.cookie.expiry!==void 0&&{expires:n.cookie.expiry},...n.cookie.sameSite!==void 0&&{sameSite:Hm(n.cookie.sameSite)}};return n.cookie["goog:url"]!==void 0&&(r.url=n.cookie["goog:url"]),n.cookie["goog:priority"]!==void 0&&(r.priority=n.cookie["goog:priority"]),n.cookie["goog:sameParty"]!==void 0&&(r.sameParty=n.cookie["goog:sameParty"]),n.cookie["goog:sourceScheme"]!==void 0&&(r.sourceScheme=n.cookie["goog:sourceScheme"]),n.cookie["goog:sourcePort"]!==void 0&&(r.sourcePort=n.cookie["goog:sourcePort"]),r}X.bidiToCdpCookie=qm;function Km(n){switch(n){case"Strict":return"strict";case"None":return"none";case"Lax":return"lax";default:return"lax"}}function Hm(n){switch(n){case"strict":return"Strict";case"lax":return"Lax";case"none":return"None"}throw new kh.InvalidArgumentException(`Unknown 'sameSite' value ${n}`)}Object.defineProperty(Ou,"__esModule",{value:!0});Ou.NetworkRequest=void 0;const rs=B,Tn=Ue,rd=In,at=X;var jt,mr,Pe,Bt,gr,At,wr,A,O,hs,ps,fs,ze,We,bt,$t,Qs,ms,Bn,za,Ih,Wa,Rh,Va,Th,Ga,Dh,Xa,Oh,yi,Bd,Ja,Nh,vi,Ad,Ya,Mh,gs,An,Qa,Fh,Za,jh;const Se=class Se{constructor(e,t,r,i,o=0){u(this,We);u(this,$t);u(this,ms);u(this,za);u(this,Wa);u(this,Va);u(this,Ga);u(this,Xa);u(this,yi);u(this,Ja);u(this,vi);u(this,Ya);u(this,gs);u(this,mr,void 0);u(this,Pe,void 0);u(this,Bt,!1);u(this,gr,void 0);u(this,At,void 0);u(this,wr,void 0);u(this,A,{});u(this,O,{});u(this,hs,new rd.Deferred);u(this,ps,new rd.Deferred);u(this,fs,new rd.Deferred);u(this,ze,void 0);h(this,mr,e),h(this,At,t),h(this,wr,r),h(this,ze,i),h(this,gr,o)}get requestId(){return s(this,mr)}get url(){var e,t;return((e=s(this,O).info)==null?void 0:e.url)??((t=s(this,A).info)==null?void 0:t.request.url)}get redirectCount(){return s(this,gr)}get cdpTarget(){return s(this,ze)}isRedirecting(){return!!s(this,A).info}handleRedirect(e){f(this,yi,Bd).call(this),f(this,vi,Ad).call(this),s(this,O).hasExtraInfo=e.redirectHasExtraInfo,s(this,O).info=e.redirectResponse,f(this,We,bt).call(this,!0)}onRequestWillBeSentEvent(e){s(this,A).info=e,f(this,Ga,Dh).call(this),f(this,We,bt).call(this)}onRequestWillBeSentExtraInfoEvent(e){s(this,A).extraInfo=e,f(this,We,bt).call(this)}onResponseReceivedExtraInfoEvent(e){s(this,O).extraInfo=e,f(this,We,bt).call(this)}onResponseReceivedEvent(e){s(this,O).hasExtraInfo=e.hasExtraInfo,s(this,O).info=e.response,f(this,yi,Bd).call(this),f(this,vi,Ad).call(this),f(this,We,bt).call(this)}onServedFromCache(){h(this,Bt,!0),f(this,We,bt).call(this)}onLoadingFailedEvent(e){s(this,hs).resolve({kind:"success",value:void 0}),s(this,ps).resolve({kind:"error",error:new Error("Network event loading failed")}),s(this,fs).resolve({kind:"error",error:new Error("Network event loading failed")}),s(this,At).registerEvent({type:"event",method:rs.ChromiumBidi.Network.EventNames.FetchError,params:{...f(this,ms,Bn).call(this),errorText:e.errorText}},s(this,$t,Qs))}onRequestPaused(e){if(f(this,gs,An).call(this)){this.continueRequest(e.requestId).catch(()=>{});return}let t;e.responseErrorReason===void 0&&e.responseStatusCode===void 0?t="beforeRequestSent":e.responseStatusCode===401&&e.responseStatusText==="Unauthorized"?t="authRequired":t="responseStarted";const r=(0,at.bidiNetworkHeadersFromCdpFetchHeaders)(e.responseHeaders);s(this,wr).addBlockedRequest(this.requestId,{request:e.requestId,phase:t,response:{url:e.request.url,protocol:"",status:e.responseStatusCode??0,statusText:e.responseStatusText??"",fromCache:!1,headers:r,mimeType:"",bytesReceived:0,headersSize:(0,at.computeHeadersSize)(r),bodySize:0,content:{size:0},authChallenge:void 0}}),h(this,Pe,t),f(this,We,bt).call(this)}async failRequest(e,t){await s(this,ze).cdpClient.sendCommand("Fetch.failRequest",{requestId:e,errorReason:t}),h(this,Pe,void 0)}async continueRequest(e,t,r,i){await s(this,ze).cdpClient.sendCommand("Fetch.continueRequest",{requestId:e,url:t,method:r,headers:i}),h(this,Pe,void 0)}async continueResponse(e,t,r,i){await s(this,ze).cdpClient.sendCommand("Fetch.continueResponse",{requestId:e,responseCode:t,responsePhrase:r,responseHeaders:i}),h(this,Pe,void 0)}async continueWithAuth(e,t,r,i){await s(this,ze).cdpClient.sendCommand("Fetch.continueWithAuth",{requestId:e,authChallengeResponse:{response:t,username:r,password:i}}),h(this,Pe,void 0)}async provideResponse(e,t,r,i,o){await s(this,ze).cdpClient.sendCommand("Fetch.fulfillRequest",{requestId:e,responseCode:t,responsePhrase:r,responseHeaders:i,...o?{body:btoa(o)}:{}}),h(this,Pe,void 0)}dispose(){const e={kind:"error",error:new Error("Network processor detached")};s(this,hs).resolve(e),s(this,ps).resolve(e),s(this,fs).resolve(e)}get statusCode(){var e,t;return((e=s(this,O).info)==null?void 0:e.status)??((t=s(this,O).extraInfo)==null?void 0:t.statusCode)??-1}};jt=new WeakMap,mr=new WeakMap,Pe=new WeakMap,Bt=new WeakMap,gr=new WeakMap,At=new WeakMap,wr=new WeakMap,A=new WeakMap,O=new WeakMap,hs=new WeakMap,ps=new WeakMap,fs=new WeakMap,ze=new WeakMap,We=new WeakSet,bt=function(e=!1){const t=e||!!s(this,A).extraInfo||s(this,Bt)||!!(s(this,O).info&&!s(this,O).hasExtraInfo)||s(this,Pe)==="beforeRequestSent";s(this,A).info&&t&&s(this,hs).resolve({kind:"success",value:void 0});const r=!!s(this,O).extraInfo||s(this,Bt)||!!(s(this,O).info&&!s(this,O).hasExtraInfo)||s(this,Pe)==="responseStarted";s(this,O).info&&r&&(s(this,ps).resolve({kind:"success",value:void 0}),s(this,fs).resolve({kind:"success",value:void 0}))},$t=new WeakSet,Qs=function(){var e;return((e=s(this,A).info)==null?void 0:e.frameId)??null},ms=new WeakSet,Bn=function(e){var i;const t=e!==void 0&&e===s(this,Pe),r=s(this,wr).getNetworkIntercepts(s(this,mr),e);return{isBlocked:t,context:s(this,$t,Qs),navigation:f(this,za,Ih).call(this),redirectCount:s(this,gr),request:f(this,Wa,Rh).call(this),timestamp:Math.round((((i=s(this,A).info)==null?void 0:i.wallTime)??0)*1e3),intercepts:t?r:void 0}},za=new WeakSet,Ih=function(){return!s(this,A).info||!s(this,A).info.loaderId||s(this,A).info.loaderId!==s(this,A).info.requestId?null:s(this,A).info.loaderId},Wa=new WeakSet,Rh=function(){var r,i,o,a,c;const e=s(this,A).extraInfo?f(r=Se,Za,jh).call(r,s(this,A).extraInfo.associatedCookies):[],t=(0,at.bidiNetworkHeadersFromCdpNetworkHeaders)((i=s(this,A).info)==null?void 0:i.request.headers);return{request:((o=s(this,A).info)==null?void 0:o.requestId)??s(Se,jt),url:((a=s(this,A).info)==null?void 0:a.request.url)??s(Se,jt),method:((c=s(this,A).info)==null?void 0:c.request.method)??s(Se,jt),headers:t,cookies:e,headersSize:(0,at.computeHeadersSize)(t),bodySize:0,timings:f(this,Va,Th).call(this)}},Va=new WeakSet,Th=function(){return{timeOrigin:0,requestTime:0,redirectStart:0,redirectEnd:0,fetchStart:0,dnsStart:0,dnsEnd:0,connectStart:0,connectEnd:0,tlsStart:0,requestStart:0,responseStart:0,responseEnd:0}},Ga=new WeakSet,Dh=function(){f(this,gs,An).call(this)||s(this,At).registerPromiseEvent(s(this,hs).then(e=>{if(e.kind==="success")try{return{kind:"success",value:Object.assign(f(this,Xa,Oh).call(this),{type:"event"})}}catch(t){return{kind:"error",error:t instanceof Error?t:new Error("Unknown")}}return e}),s(this,$t,Qs),rs.ChromiumBidi.Network.EventNames.BeforeRequestSent)},Xa=new WeakSet,Oh=function(){var e;return(0,Tn.assert)(s(this,A).info,"RequestWillBeSentEvent is not set"),{method:rs.ChromiumBidi.Network.EventNames.BeforeRequestSent,params:{...f(this,ms,Bn).call(this,"beforeRequestSent"),initiator:{type:f(e=Se,Qa,Fh).call(e,s(this,A).info.initiator.type)}}}},yi=new WeakSet,Bd=function(){f(this,gs,An).call(this)||s(this,At).registerPromiseEvent(s(this,ps).then(e=>{if(e.kind==="success")try{return{kind:"success",value:Object.assign(f(this,Ja,Nh).call(this),{type:"event"})}}catch(t){return{kind:"error",error:t instanceof Error?t:new Error("Unknown")}}return e}),s(this,$t,Qs),rs.ChromiumBidi.Network.EventNames.ResponseStarted)},Ja=new WeakSet,Nh=function(){(0,Tn.assert)(s(this,A).info,"RequestWillBeSentEvent is not set"),(0,Tn.assert)(s(this,O).info,"ResponseReceivedEvent is not set"),s(this,O).info.fromDiskCache&&(s(this,O).extraInfo=void 0);const e=(0,at.bidiNetworkHeadersFromCdpNetworkHeaders)(s(this,O).info.headers);return{method:rs.ChromiumBidi.Network.EventNames.ResponseStarted,params:{...f(this,ms,Bn).call(this),response:{url:s(this,O).info.url??s(Se,jt),protocol:s(this,O).info.protocol??"",status:this.statusCode,statusText:s(this,O).info.statusText,fromCache:s(this,O).info.fromDiskCache||s(this,O).info.fromPrefetchCache||s(this,Bt),headers:e,mimeType:s(this,O).info.mimeType,bytesReceived:s(this,O).info.encodedDataLength,headersSize:(0,at.computeHeadersSize)(e),bodySize:0,content:{size:0}}}}},vi=new WeakSet,Ad=function(){f(this,gs,An).call(this)||s(this,At).registerPromiseEvent(s(this,fs).then(e=>{if(e.kind==="success")try{return{kind:"success",value:Object.assign(f(this,Ya,Mh).call(this),{type:"event"})}}catch(t){return{kind:"error",error:t instanceof Error?t:new Error("Unknown")}}return e}),s(this,$t,Qs),rs.ChromiumBidi.Network.EventNames.ResponseCompleted)},Ya=new WeakSet,Mh=function(){(0,Tn.assert)(s(this,A).info,"RequestWillBeSentEvent is not set"),(0,Tn.assert)(s(this,O).info,"ResponseReceivedEvent is not set"),s(this,O).info.fromDiskCache&&(s(this,O).extraInfo=void 0);const e=(0,at.bidiNetworkHeadersFromCdpNetworkHeaders)(s(this,O).info.headers);return{method:rs.ChromiumBidi.Network.EventNames.ResponseCompleted,params:{...f(this,ms,Bn).call(this),response:{url:s(this,O).info.url??s(Se,jt),protocol:s(this,O).info.protocol??"",status:this.statusCode,statusText:s(this,O).info.statusText,fromCache:s(this,O).info.fromDiskCache||s(this,O).info.fromPrefetchCache||s(this,Bt),headers:e,mimeType:s(this,O).info.mimeType,bytesReceived:s(this,O).info.encodedDataLength,headersSize:(0,at.computeHeadersSize)(e),bodySize:0,content:{size:0}}}}},gs=new WeakSet,An=function(){var e;return((e=s(this,A).info)==null?void 0:e.request.url.endsWith("/favicon.ico"))??!1},Qa=new WeakSet,Fh=function(e){switch(e){case"parser":case"script":case"preflight":return e;default:return"other"}},Za=new WeakSet,jh=function(e){return e.filter(({blockedReasons:t})=>!Array.isArray(t)||t.length===0).map(({cookie:t})=>(0,at.cdpToBiDiCookie)(t))},u(Se,Qa),u(Se,Za),u(Se,jt,"UNKNOWN");let jd=Se;Ou.NetworkRequest=jd;Object.defineProperty(Du,"__esModule",{value:!0});Du.NetworkManager=void 0;const zm=Ou;var yr,bi,Ve,De,ut;const Pl=class Pl{constructor(e,t,r){u(this,De);u(this,yr,void 0);u(this,bi,void 0);u(this,Ve,void 0);h(this,yr,e),h(this,bi,t),h(this,Ve,r)}get cdpTarget(){return s(this,yr)}static create(e,t,r){const i=new Pl(e,t,r);return e.browserCdpClient.on("Target.detachedFromTarget",o=>{e.cdpClient.sessionId===o.sessionId&&s(i,Ve).disposeRequestMap()}),e.cdpClient.on("Network.requestWillBeSent",o=>{var c,l;const a=s(i,Ve).getRequest(o.requestId);a&&a.isRedirecting()?(a.handleRedirect(o),s(i,Ve).deleteRequest(o.requestId),f(c=i,De,ut).call(c,o.requestId,a.redirectCount+1).onRequestWillBeSentEvent(o)):a?a.onRequestWillBeSentEvent(o):f(l=i,De,ut).call(l,o.requestId).onRequestWillBeSentEvent(o)}),e.cdpClient.on("Network.requestWillBeSentExtraInfo",o=>{var a;f(a=i,De,ut).call(a,o.requestId).onRequestWillBeSentExtraInfoEvent(o)}),e.cdpClient.on("Network.responseReceived",o=>{var a;f(a=i,De,ut).call(a,o.requestId).onResponseReceivedEvent(o)}),e.cdpClient.on("Network.responseReceivedExtraInfo",o=>{var a;f(a=i,De,ut).call(a,o.requestId).onResponseReceivedExtraInfoEvent(o)}),e.cdpClient.on("Network.requestServedFromCache",o=>{var a;f(a=i,De,ut).call(a,o.requestId).onServedFromCache()}),e.cdpClient.on("Network.loadingFailed",o=>{var a;f(a=i,De,ut).call(a,o.requestId).onLoadingFailedEvent(o)}),e.cdpClient.on("Fetch.requestPaused",o=>{var a;o.networkId&&f(a=i,De,ut).call(a,o.networkId).onRequestPaused(o)}),i}};yr=new WeakMap,bi=new WeakMap,Ve=new WeakMap,De=new WeakSet,ut=function(e,t){let r=s(this,Ve).getRequest(e);return r||(r=new zm.NetworkRequest(e,s(this,bi),s(this,Ve),s(this,yr),t),s(this,Ve).addRequest(r),r)};let $d=Pl;Du.NetworkManager=$d;Object.defineProperty(Ru,"__esModule",{value:!0});Ru.CdpTarget=void 0;const Wm=In,Vm=Tu,Gm=Du;var xi,te,Ci,Ei,vr,Si,br,Pi,ec,Bh,tc,Ah,sc,$h;const _l=class _l{constructor(e,t,r,i,o,a,c){u(this,ec);u(this,tc);u(this,sc);u(this,xi,void 0);u(this,te,void 0);u(this,Ci,void 0);u(this,Ei,void 0);u(this,vr,void 0);u(this,Si,void 0);u(this,br,new Wm.Deferred);u(this,Pi,void 0);h(this,xi,e),h(this,te,t),h(this,Ei,i),h(this,vr,o),h(this,Si,a),h(this,Ci,r),h(this,Pi,c)}static create(e,t,r,i,o,a,c,l,p){var m,x;const g=new _l(e,t,r,o,a,c,l);return Vm.LogManager.create(g,i,o,p),Gm.NetworkManager.create(g,o,c),f(m=g,tc,Ah).call(m),f(x=g,ec,Bh).call(x),g}get unblocked(){return s(this,br)}get id(){return s(this,xi)}get cdpClient(){return s(this,te)}get browserCdpClient(){return s(this,Ci)}get cdpSessionId(){return s(this,te).sessionId}async fetchEnable(){await s(this,te).sendCommand("Fetch.enable",s(this,Si).getFetchEnableParams())}async fetchDisable(){await s(this,te).sendCommand("Fetch.disable")}getChannels(){return s(this,vr).find().flatMap(e=>e.channels)}};xi=new WeakMap,te=new WeakMap,Ci=new WeakMap,Ei=new WeakMap,vr=new WeakMap,Si=new WeakMap,br=new WeakMap,Pi=new WeakMap,ec=new WeakSet,Bh=async function(){try{await Promise.all([s(this,te).sendCommand("Runtime.enable"),s(this,te).sendCommand("Page.enable"),s(this,te).sendCommand("Page.setLifecycleEventsEnabled",{enabled:!0}),s(this,te).sendCommand("Security.setIgnoreCertificateErrors",{ignore:s(this,Pi)}),s(this,te).sendCommand("Network.enable"),this.fetchEnable(),s(this,te).sendCommand("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),f(this,sc,$h).call(this),s(this,te).sendCommand("Runtime.runIfWaitingForDebugger")])}catch(e){if(!s(this,te).isCloseError(e)){s(this,br).resolve({kind:"error",error:e});return}}s(this,br).resolve({kind:"success",value:void 0})},tc=new WeakSet,Ah=function(){s(this,te).on("*",(e,t)=>{typeof e=="string"&&s(this,Ei).registerEvent({type:"event",method:`cdp.${e}`,params:{event:e,params:t,session:this.cdpSessionId}},null)})},sc=new WeakSet,$h=async function(){for(const e of s(this,vr).find({global:!0}))await e.initInTarget(this,!0)};let Ud=_l;Ru.CdpTarget=Ud;Object.defineProperty(_u,"__esModule",{value:!0});_u.BrowsingContextProcessor=void 0;const Js=B,Bl=Re,Xm=ku,nd=Pn,Jm=Ru;var dt,_i,ki,Ut,$,Ii,Ri,xr,Cr,Ge,Ti,Xe,Di,Ld,rc,Uh,nc,Lh,ic,qh,Oi,qd,Ni,oc,Kh,ac,Hh,cc,zh;class Ym{constructor(e,t,r,i,o,a,c,l,p,g,m,x){u(this,Di);u(this,rc);u(this,nc);u(this,ic);u(this,Oi);u(this,oc);u(this,ac);u(this,cc);u(this,dt,void 0);u(this,_i,void 0);u(this,ki,void 0);u(this,Ut,void 0);u(this,$,void 0);u(this,Ii,void 0);u(this,Ri,void 0);u(this,xr,void 0);u(this,Cr,void 0);u(this,Ge,void 0);u(this,Ti,void 0);u(this,Xe,void 0);u(this,Ni,new Map);h(this,Ri,p),h(this,_i,e),h(this,dt,t),h(this,ki,r),h(this,Ut,i),h(this,$,o),h(this,Cr,l),h(this,Ii,c),h(this,Ge,a),h(this,xr,g),h(this,Ti,m),h(this,Xe,x),f(this,Di,Ld).call(this,t)}getTree(e){return{contexts:(e.root===void 0?s(this,$).getTopLevelContexts():[s(this,$).getContext(e.root)]).map(r=>r.serializeToBidiValue(e.maxDepth??Number.MAX_VALUE))}}async create(e){let t,r=e.userContext??"default";if(e.referenceContext!==void 0){if(t=s(this,$).getContext(e.referenceContext),!t.isTopLevelContext())throw new Js.InvalidArgumentException("referenceContext should be a top-level context");r=t.userContext}let i=!1;switch(e.type){case"tab":i=!1;break;case"window":i=!0;break}r!=="default"&&(s(this,$).getAllContexts().filter(p=>p.userContext===r).length||(i=!0));let o;try{o=await s(this,dt).sendCommand("Target.createTarget",{url:"about:blank",newWindow:i,browserContextId:r==="default"?void 0:r})}catch(l){throw l.message.startsWith("Failed to find browser context with id")||l.message==="browserContextId"?new Js.NoSuchUserContextException(`The context ${r} was not found`):l}const a=o.targetId,c=s(this,$).getContext(a);return await c.lifecycleLoaded(),{context:c.id}}navigate(e){return s(this,$).getContext(e.context).navigate(e.url,e.wait??"none")}reload(e){return s(this,$).getContext(e.context).reload(e.ignoreCache??!1,e.wait??"none")}async activate(e){const t=s(this,$).getContext(e.context);if(!t.isTopLevelContext())throw new Js.InvalidArgumentException("Activation is only supported on the top-level context");return await t.activate(),{}}async captureScreenshot(e){return await s(this,$).getContext(e.context).captureScreenshot(e)}async print(e){return await s(this,$).getContext(e.context).print(e)}async setViewport(e){const t=s(this,$).getContext(e.context);if(!t.isTopLevelContext())throw new Js.InvalidArgumentException("Emulating viewport is only supported on the top-level context");return await t.setViewport(e.viewport,e.devicePixelRatio),{}}async traverseHistory(e){const t=s(this,$).getContext(e.context);if(!t)throw new Js.InvalidArgumentException(`No browsing context with id ${e.context}`);return await t.traverseHistory(e.delta),{}}async handleUserPrompt(e){return await s(this,$).getContext(e.context).handleUserPrompt(e),{}}async close(e){const t=s(this,$).getContext(e.context);if(!t.isTopLevelContext())throw new Js.InvalidArgumentException(`Non top-level browsing context ${t.id} cannot be closed.`);try{const r=new Promise(i=>{const o=a=>{a.targetId===e.context&&(s(this,dt).off("Target.detachedFromTarget",o),i())};s(this,dt).on("Target.detachedFromTarget",o)});e.promptUnload?await t.close():await s(this,dt).sendCommand("Target.closeTarget",{targetId:e.context}),await r}catch(r){if(!(r.code===-32e3&&r.message==="Not attached to an active page"))throw r}return{}}}dt=new WeakMap,_i=new WeakMap,ki=new WeakMap,Ut=new WeakMap,$=new WeakMap,Ii=new WeakMap,Ri=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Ge=new WeakMap,Ti=new WeakMap,Xe=new WeakMap,Di=new WeakSet,Ld=function(e){e.on("Target.attachedToTarget",t=>{f(this,ic,qh).call(this,t,e)}),e.on("Target.detachedFromTarget",t=>{f(this,ac,Hh).call(this,t)}),e.on("Target.targetInfoChanged",t=>{f(this,cc,zh).call(this,t)}),e.on("Page.frameAttached",t=>{f(this,rc,Uh).call(this,t)}),e.on("Page.frameDetached",t=>{f(this,nc,Lh).call(this,t)})},rc=new WeakSet,Uh=function(e){const t=s(this,$).findContext(e.parentFrameId);t!==void 0&&nd.BrowsingContextImpl.create(t.cdpTarget,s(this,Ge),e.frameId,e.parentFrameId,t.userContext,s(this,Ut),s(this,$),s(this,xr),s(this,Xe))},nc=new WeakSet,Lh=function(e){var t;e.reason!=="swap"&&((t=s(this,$).findContext(e.frameId))==null||t.dispose())},ic=new WeakSet,qh=function(e,t){var a;const{sessionId:r,targetInfo:i}=e,o=s(this,_i).getCdpClient(r);switch((a=s(this,Xe))==null||a.call(this,Bl.LogType.debugInfo,"AttachedToTarget event received:",e),i.type){case"page":case"iframe":{if(i.targetId===s(this,ki))break;const c=f(this,Oi,qd).call(this,o,i),l=s(this,$).findContext(i.targetId);l?l.updateCdpTarget(c):nd.BrowsingContextImpl.create(c,s(this,Ge),i.targetId,null,i.browserContextId&&i.browserContextId!==s(this,Ti)?i.browserContextId:"default",s(this,Ut),s(this,$),s(this,xr),s(this,Xe));return}case"worker":{const c=t.sessionId&&s(this,$).findContextBySession(t.sessionId);if(!c)break;const l=f(this,Oi,qd).call(this,o,i);f(this,oc,Kh).call(this,l,s(this,Ge).getRealm({browsingContextId:c.id,type:"window",sandbox:void 0}));return}}o.sendCommand("Runtime.runIfWaitingForDebugger").then(()=>t.sendCommand("Target.detachFromTarget",e)).catch(c=>{var l;return(l=s(this,Xe))==null?void 0:l.call(this,Bl.LogType.debugError,c)})},Oi=new WeakSet,qd=function(e,t){return f(this,Di,Ld).call(this,e),Jm.CdpTarget.create(t.targetId,e,s(this,dt),s(this,Ge),s(this,Ut),s(this,Cr),s(this,Ii),s(this,Ri),s(this,Xe))},Ni=new WeakMap,oc=new WeakSet,Kh=function(e,t){e.cdpClient.on("Runtime.executionContextCreated",r=>{const{uniqueId:i,id:o,origin:a}=r.context,c=new Xm.DedicatedWorkerRealm(e.cdpClient,s(this,Ut),o,s(this,Xe),(0,nd.serializeOrigin)(a),t,i,s(this,Ge));s(this,Ni).set(e.cdpSessionId,c)})},ac=new WeakSet,Hh=function(e){const t=s(this,$).findContextBySession(e.sessionId);if(t){t.dispose(),s(this,Cr).find({targetId:t.id}).map(i=>i.dispose(t.id));return}const r=s(this,Ni).get(e.sessionId);r&&s(this,Ge).deleteRealms({cdpSessionId:r.cdpClient.sessionId})},cc=new WeakSet,zh=function(e){const t=s(this,$).findContext(e.targetInfo.targetId);t&&t.onTargetInfoChanged(e)};_u.BrowsingContextProcessor=Ym;var Nu={},Mu={},$e={};Object.defineProperty($e,"__esModule",{value:!0});$e.WheelSource=$e.PointerSource=$e.KeySource=$e.NoneSource=void 0;class Qm{constructor(){I(this,"type","none")}}$e.NoneSource=Qm;var Je,ws,$n;class Zm{constructor(){u(this,ws);I(this,"type","key");I(this,"pressed",new Set);u(this,Je,0)}get modifiers(){return s(this,Je)}get alt(){return(s(this,Je)&1)===1}set alt(e){f(this,ws,$n).call(this,e,1)}get ctrl(){return(s(this,Je)&2)===2}set ctrl(e){f(this,ws,$n).call(this,e,2)}get meta(){return(s(this,Je)&4)===4}set meta(e){f(this,ws,$n).call(this,e,4)}get shift(){return(s(this,Je)&8)===8}set shift(e){f(this,ws,$n).call(this,e,8)}}Je=new WeakMap,ws=new WeakSet,$n=function(e,t){e?h(this,Je,s(this,Je)|t):h(this,Je,s(this,Je)&~t)};$e.KeySource=Zm;var yt,uc,Mi,Er,Sr,Pr,_r;class Wh{constructor(e,t){I(this,"type","pointer");I(this,"subtype");I(this,"pointerId");I(this,"pressed",new Set);I(this,"x",0);I(this,"y",0);u(this,_r,new Map);this.pointerId=e,this.subtype=t}get buttons(){let e=0;for(const t of this.pressed)switch(t){case 0:e|=1;break;case 1:e|=4;break;case 2:e|=2;break;case 3:e|=8;break;case 4:e|=16;break}return e}setClickCount(e,t){let r=s(this,_r).get(e);return(!r||r.compare(t))&&(r=t),++r.count,s(this,_r).set(e,r),r.count}getClickCount(e){var t;return((t=s(this,_r).get(e))==null?void 0:t.count)??0}}_r=new WeakMap,I(Wh,"ClickContext",(yt=class{constructor(t,r,i){I(this,"count",0);u(this,Er,void 0);u(this,Sr,void 0);u(this,Pr,void 0);h(this,Er,t),h(this,Sr,r),h(this,Pr,i)}compare(t){return s(t,Pr)-s(this,Pr)>s(yt,uc)||Math.abs(s(t,Er)-s(this,Er))>s(yt,Mi)||Math.abs(s(t,Sr)-s(this,Sr))>s(yt,Mi)}},uc=new WeakMap,Mi=new WeakMap,Er=new WeakMap,Sr=new WeakMap,Pr=new WeakMap,u(yt,uc,500),u(yt,Mi,2),yt));$e.PointerSource=Wh;class eg{constructor(){I(this,"type","wheel")}}$e.WheelSource=eg;var es={};Object.defineProperty(es,"__esModule",{value:!0});es.getKeyLocation=es.getKeyCode=es.getNormalizedKey=void 0;function tg(n){switch(n){case"":return"Unidentified";case"":return"Cancel";case"":return"Help";case"":return"Backspace";case"":return"Tab";case"":return"Clear";case"":return"Return";case"":return"Enter";case"":return"Shift";case"":return"Control";case"":return"Alt";case"":return"Pause";case"":return"Escape";case"":return" ";case"":return"PageUp";case"":return"PageDown";case"":return"End";case"":return"Home";case"":return"ArrowLeft";case"":return"ArrowUp";case"":return"ArrowRight";case"":return"ArrowDown";case"":return"Insert";case"":return"Delete";case"":return";";case"":return"=";case"":return"0";case"":return"1";case"":return"2";case"":return"3";case"":return"4";case"":return"5";case"":return"6";case"":return"7";case"":return"8";case"":return"9";case"":return"*";case"":return"+";case"":return",";case"":return"-";case"":return".";case"":return"/";case"":return"F1";case"":return"F2";case"":return"F3";case"":return"F4";case"":return"F5";case"":return"F6";case"":return"F7";case"":return"F8";case"":return"F9";case"":return"F10";case"":return"F11";case"":return"F12";case"":return"Meta";case"":return"ZenkakuHankaku";case"":return"Shift";case"":return"Control";case"":return"Alt";case"":return"Meta";case"":return"PageUp";case"":return"PageDown";case"":return"End";case"":return"Home";case"":return"ArrowLeft";case"":return"ArrowUp";case"":return"ArrowRight";case"":return"ArrowDown";case"":return"Insert";case"":return"Delete";default:return n}}es.getNormalizedKey=tg;function sg(n){switch(n){case"`":case"~":return"Backquote";case"\\":case"|":return"Backslash";case"":return"Backspace";case"[":case"{":return"BracketLeft";case"]":case"}":return"BracketRight";case",":case"<":return"Comma";case"0":case")":return"Digit0";case"1":case"!":return"Digit1";case"2":case"@":return"Digit2";case"3":case"#":return"Digit3";case"4":case"$":return"Digit4";case"5":case"%":return"Digit5";case"6":case"^":return"Digit6";case"7":case"&":return"Digit7";case"8":case"*":return"Digit8";case"9":case"(":return"Digit9";case"=":case"+":return"Equal";case"a":case"A":return"KeyA";case"b":case"B":return"KeyB";case"c":case"C":return"KeyC";case"d":case"D":return"KeyD";case"e":case"E":return"KeyE";case"f":case"F":return"KeyF";case"g":case"G":return"KeyG";case"h":case"H":return"KeyH";case"i":case"I":return"KeyI";case"j":case"J":return"KeyJ";case"k":case"K":return"KeyK";case"l":case"L":return"KeyL";case"m":case"M":return"KeyM";case"n":case"N":return"KeyN";case"o":case"O":return"KeyO";case"p":case"P":return"KeyP";case"q":case"Q":return"KeyQ";case"r":case"R":return"KeyR";case"s":case"S":return"KeyS";case"t":case"T":return"KeyT";case"u":case"U":return"KeyU";case"v":case"V":return"KeyV";case"w":case"W":return"KeyW";case"x":case"X":return"KeyX";case"y":case"Y":return"KeyY";case"z":case"Z":return"KeyZ";case"-":case"_":return"Minus";case".":return"Period";case"'":case'"':return"Quote";case";":case":":return"Semicolon";case"/":case"?":return"Slash";case"":return"AltLeft";case"":return"AltRight";case"":return"ControlLeft";case"":return"ControlRight";case"":return"Enter";case"":return"MetaLeft";case"":return"MetaRight";case"":return"ShiftLeft";case"":return"ShiftRight";case" ":case"":return"Space";case"":return"Tab";case"":return"Delete";case"":return"End";case"":return"Help";case"":return"Home";case"":return"Insert";case"":return"PageDown";case"":return"PageUp";case"":return"ArrowDown";case"":return"ArrowLeft";case"":return"ArrowRight";case"":return"ArrowUp";case"":return"Escape";case"":return"F1";case"":return"F2";case"":return"F3";case"":return"F4";case"":return"F5";case"":return"F6";case"":return"F7";case"":return"F8";case"":return"F9";case"":return"F10";case"":return"F11";case"":return"F12";case"":case"":return"Numpad0";case"":case"":return"Numpad1";case"":case"":return"Numpad2";case"":case"":return"Numpad3";case"":case"":return"Numpad4";case"":return"Numpad5";case"":case"":return"Numpad6";case"":case"":return"Numpad7";case"":case"":return"Numpad8";case"":case"":return"Numpad9";case"":return"NumpadAdd";case"":return"NumpadComma";case"":case"":return"NumpadDecimal";case"":return"NumpadDivide";case"":return"NumpadEnter";case"":return"NumpadMultiply";case"":return"NumpadSubtract";default:return}}es.getKeyCode=sg;function rg(n){switch(n){case"":case"":case"":case"":case"":return 1;case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":return 3;case"":case"":case"":case"":return 2;default:return 0}}es.getKeyLocation=rg;var Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});Fu.KeyToKeyCode=void 0;Fu.KeyToKeyCode={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,Abort:3,Help:6,Backspace:8,Tab:9,Numpad5:12,NumpadEnter:13,Enter:13,"\\r":13,"\\n":13,ShiftLeft:16,ShiftRight:16,ControlLeft:17,ControlRight:17,AltLeft:18,AltRight:18,Pause:19,CapsLock:20,Escape:27,Convert:28,NonConvert:29,Space:32,Numpad9:33,PageUp:33,Numpad3:34,PageDown:34,End:35,Numpad1:35,Home:36,Numpad7:36,ArrowLeft:37,Numpad4:37,Numpad8:38,ArrowUp:38,ArrowRight:39,Numpad6:39,Numpad2:40,ArrowDown:40,Select:41,Open:43,PrintScreen:44,Insert:45,Numpad0:45,Delete:46,NumpadDecimal:46,Digit0:48,Digit1:49,Digit2:50,Digit3:51,Digit4:52,Digit5:53,Digit6:54,Digit7:55,Digit8:56,Digit9:57,KeyA:65,KeyB:66,KeyC:67,KeyD:68,KeyE:69,KeyF:70,KeyG:71,KeyH:72,KeyI:73,KeyJ:74,KeyK:75,KeyL:76,KeyM:77,KeyN:78,KeyO:79,KeyP:80,KeyQ:81,KeyR:82,KeyS:83,KeyT:84,KeyU:85,KeyV:86,KeyW:87,KeyX:88,KeyY:89,KeyZ:90,MetaLeft:91,MetaRight:92,ContextMenu:93,NumpadMultiply:106,NumpadAdd:107,NumpadSubtract:109,NumpadDivide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,F20:131,F21:132,F22:133,F23:134,F24:135,NumLock:144,ScrollLock:145,AudioVolumeMute:173,AudioVolumeDown:174,AudioVolumeUp:175,MediaTrackNext:176,MediaTrackPrevious:177,MediaStop:178,MediaPlayPause:179,Semicolon:186,Equal:187,NumpadEqual:187,Comma:188,Minus:189,Period:190,Slash:191,Backquote:192,BracketLeft:219,Backslash:220,BracketRight:221,Quote:222,AltGraph:225,Props:247,Cancel:3,Clear:12,Shift:16,Control:17,Alt:18,Accept:30,ModeChange:31," ":32,Print:42,Execute:43,"\\u0000":46,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,Meta:91,"*":106,"+":107,"-":109,"/":111,";":186,"=":187,",":188,".":190,"`":192,"[":219,"\\\\":220,"]":221,"'":222,Attn:246,CrSel:247,ExSel:248,EraseEof:249,Play:250,ZoomOut:251,")":48,"!":49,"@":50,"#":51,$:52,"%":53,"^":54,"&":55,"(":57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,":":186,"<":188,_:189,">":190,"?":191,"~":192,"{":219,"|":220,"}":221,'"':222,Camera:44,EndCall:95,VolumeDown:182,VolumeUp:183};Object.defineProperty(Mu,"__esModule",{value:!0});Mu.ActionDispatcher=void 0;const Zs=B,Kn=Ue,ng=$e,Ys=es,Al=Fu,ig=(n=>{const e=n.getClientRects()[0],t=Math.max(0,Math.min(e.x,e.x+e.width)),r=Math.min(window.innerWidth,Math.max(e.x,e.x+e.width)),i=Math.max(0,Math.min(e.y,e.y+e.height)),o=Math.min(window.innerHeight,Math.max(e.y,e.y+e.height));return[t+(r-t>>1),i+(o-i>>1)]}).toString(),og=(()=>navigator.platform.toLowerCase().includes("mac")).toString();async function ag(n,e){var a,c,l,p;const r=await(await n.getOrCreateSandbox(void 0)).callFunction(ig,{type:"undefined"},[e],!1,"none",{});if(r.type==="exception")throw new Zs.NoSuchElementException(`Origin element ${e.sharedId} was not found`);(0,Kn.assert)(r.result.type==="array"),(0,Kn.assert)(((c=(a=r.result.value)==null?void 0:a[0])==null?void 0:c.type)==="number"),(0,Kn.assert)(((p=(l=r.result.value)==null?void 0:l[1])==null?void 0:p.type)==="number");const{result:{value:[{value:i},{value:o}]}}=r;return{x:i,y:o}}var kr,lt,ht,re,ys,dc,Gh,lc,Xh,hc,Jh,pc,Yh,Fi,Kd,fc,Qh,mc,Zh,gc,ep;class Vh{constructor(e,t,r){u(this,dc);u(this,lc);u(this,hc);u(this,pc);u(this,Fi);u(this,fc);u(this,mc);u(this,gc);u(this,kr,0);u(this,lt,0);u(this,ht,void 0);u(this,re,void 0);u(this,ys,void 0);h(this,ht,e),h(this,re,t),h(this,ys,r)}async dispatchActions(e){await s(this,ht).queue.run(async()=>{for(const t of e)await this.dispatchTickActions(t)})}async dispatchTickActions(e){h(this,kr,performance.now()),h(this,lt,0);for(const{action:r}of e)"duration"in r&&r.duration!==void 0&&h(this,lt,Math.max(s(this,lt),r.duration));const t=[new Promise(r=>setTimeout(r,s(this,lt)))];for(const r of e)t.push(f(this,dc,Gh).call(this,r));await Promise.all(t)}}kr=new WeakMap,lt=new WeakMap,ht=new WeakMap,re=new WeakMap,ys=new WeakMap,dc=new WeakSet,Gh=async function({id:e,action:t}){const r=s(this,ht).get(e),i=s(this,ht).getGlobalKeyState();switch(t.type){case"keyDown":{await f(this,mc,Zh).call(this,r,t),s(this,ht).cancelList.push({id:e,action:{...t,type:"keyUp"}});break}case"keyUp":{await f(this,gc,ep).call(this,r,t);break}case"pause":break;case"pointerDown":{await f(this,lc,Xh).call(this,r,i,t),s(this,ht).cancelList.push({id:e,action:{...t,type:"pointerUp"}});break}case"pointerMove":{await f(this,pc,Yh).call(this,r,i,t);break}case"pointerUp":{await f(this,hc,Jh).call(this,r,i,t);break}case"scroll":{await f(this,fc,Qh).call(this,r,i,t);break}}},lc=new WeakSet,Xh=function(e,t,r){const{button:i}=r;if(e.pressed.has(i))return;e.pressed.add(i);const{x:o,y:a,subtype:c}=e,{width:l,height:p,pressure:g,twist:m,tangentialPressure:x}=r,{tiltX:C,tiltY:v}=Ll(r),{modifiers:w}=t;switch(c){case"mouse":case"pen":return s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mousePressed",x:o,y:a,modifiers:w,button:pa(i),buttons:e.buttons,clickCount:e.setClickCount(i,new ng.PointerSource.ClickContext(o,a,performance.now())),pointerType:c,tangentialPressure:x,tiltX:C,tiltY:v,twist:m,force:g});case"touch":return s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchTouchEvent",{type:"touchStart",touchPoints:[{x:o,y:a,...ql(l??1,p??1),tangentialPressure:x,tiltX:C,tiltY:v,twist:m,force:g,id:e.pointerId}],modifiers:w})}},hc=new WeakSet,Jh=function(e,t,r){const{button:i}=r;if(!e.pressed.has(i))return;e.pressed.delete(i);const{x:o,y:a,subtype:c}=e,{modifiers:l}=t;switch(c){case"mouse":case"pen":return s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseReleased",x:o,y:a,modifiers:l,button:pa(i),buttons:e.buttons,clickCount:e.getClickCount(i),pointerType:c});case"touch":return s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchTouchEvent",{type:"touchEnd",touchPoints:[{x:o,y:a,id:e.pointerId}],modifiers:l})}},pc=new WeakSet,Yh=async function(e,t,r){const{x:i,y:o,subtype:a}=e,{width:c,height:l,pressure:p,twist:g,tangentialPressure:m,x,y:C,origin:v="viewport",duration:w=s(this,lt)}=r,{tiltX:y,tiltY:b}=Ll(r),{targetX:E,targetY:R}=await f(this,Fi,Kd).call(this,v,x,C,i,o);if(E<0||R<0)throw new Zs.MoveTargetOutOfBoundsException(`Cannot move beyond viewport (x: ${E}, y: ${R})`);let _;do{const k=w>0?(performance.now()-s(this,kr))/w:1;_=k>=1;let D,F;if(_?(D=E,F=R):(D=Math.round(k*(E-i)+i),F=Math.round(k*(R-o)+o)),e.x!==D||e.y!==F){const{modifiers:U}=t;switch(a){case"mouse":await s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseMoved",x:D,y:F,modifiers:U,clickCount:0,button:pa(e.pressed.values().next().value??5),buttons:e.buttons,pointerType:a,tangentialPressure:m,tiltX:y,tiltY:b,twist:g,force:p});break;case"pen":e.pressed.size!==0&&await s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseMoved",x:D,y:F,modifiers:U,clickCount:0,button:pa(e.pressed.values().next().value??5),buttons:e.buttons,pointerType:a,tangentialPressure:m,tiltX:y,tiltY:b,twist:g,force:p});break;case"touch":e.pressed.size!==0&&await s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchTouchEvent",{type:"touchMove",touchPoints:[{x:D,y:F,...ql(c??1,l??1),tangentialPressure:m,tiltX:y,tiltY:b,twist:g,force:p,id:e.pointerId}],modifiers:U});break}e.x=D,e.y=F}}while(!_)},Fi=new WeakSet,Kd=async function(e,t,r,i,o){let a,c;switch(e){case"viewport":a=t,c=r;break;case"pointer":a=i+t,c=o+r;break;default:{const{x:l,y:p}=await ag(s(this,re),e.element);a=l+t,c=p+r;break}}return{targetX:a,targetY:c}},fc=new WeakSet,Qh=async function(e,t,r){const{deltaX:i,deltaY:o,x:a,y:c,origin:l="viewport",duration:p=s(this,lt)}=r;if(l==="pointer")throw new Zs.InvalidArgumentException('"pointer" origin is invalid for scrolling.');const{targetX:g,targetY:m}=await f(this,Fi,Kd).call(this,l,a,c,0,0);if(g<0||m<0)throw new Zs.MoveTargetOutOfBoundsException(`Cannot move beyond viewport (x: ${g}, y: ${m})`);let x=0,C=0,v;do{const w=p>0?(performance.now()-s(this,kr))/p:1;v=w>=1;let y,b;if(v?(y=i-x,b=o-C):(y=Math.round(w*i-x),b=Math.round(w*o-C)),y!==0||b!==0){const{modifiers:E}=t;await s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchMouseEvent",{type:"mouseWheel",deltaX:y,deltaY:b,x:g,y:m,modifiers:E}),x+=y,C+=b}}while(!v)},mc=new WeakSet,Zh=async function(e,t){if([...t.value].length>1)throw new Zs.InvalidArgumentException(`Invalid key value: ${t.value}`);const r=t.value,i=(0,Ys.getNormalizedKey)(r),o=e.pressed.has(i),a=(0,Ys.getKeyCode)(r),c=(0,Ys.getKeyLocation)(r);switch(i){case"Alt":e.alt=!0;break;case"Shift":e.shift=!0;break;case"Control":e.ctrl=!0;break;case"Meta":e.meta=!0;break}e.pressed.add(i);const{modifiers:l}=e,p=$l(i,e),g=Ul(a??"",e)??p;let m;if(s(this,ys)&&e.meta)switch(a){case"KeyA":m="SelectAll";break;case"KeyC":m="Copy";break;case"KeyV":m=e.shift?"PasteAndMatchStyle":"Paste";break;case"KeyX":m="Cut";break;case"KeyZ":m=e.shift?"Redo":"Undo";break}const x=[s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchKeyEvent",{type:g?"keyDown":"rawKeyDown",windowsVirtualKeyCode:Al.KeyToKeyCode[i],key:i,code:a,text:g,unmodifiedText:p,autoRepeat:o,isSystemKey:e.alt||void 0,location:c<3?c:void 0,isKeypad:c===3,modifiers:l,commands:m?[m]:void 0})];i==="Escape"&&!e.alt&&(s(this,ys)&&!e.ctrl&&!e.meta||!s(this,ys))&&x.push(s(this,re).cdpTarget.cdpClient.sendCommand("Input.cancelDragging")),await Promise.all(x)},gc=new WeakSet,ep=function(e,t){if([...t.value].length>1)throw new Zs.InvalidArgumentException(`Invalid key value: ${t.value}`);const r=t.value,i=(0,Ys.getNormalizedKey)(r);if(!e.pressed.has(i))return;const o=(0,Ys.getKeyCode)(r),a=(0,Ys.getKeyLocation)(r);switch(i){case"Alt":e.alt=!1;break;case"Shift":e.shift=!1;break;case"Control":e.ctrl=!1;break;case"Meta":e.meta=!1;break}e.pressed.delete(i);const{modifiers:c}=e,l=$l(i,e),p=Ul(o??"",e)??l;return s(this,re).cdpTarget.cdpClient.sendCommand("Input.dispatchKeyEvent",{type:"keyUp",windowsVirtualKeyCode:Al.KeyToKeyCode[i],key:i,code:o,text:p,unmodifiedText:l,location:a<3?a:void 0,isSystemKey:e.alt||void 0,isKeypad:a===3,modifiers:c})},I(Vh,"isMacOS",async e=>{const t=await(await e.getOrCreateSandbox(void 0)).callFunction(og,{type:"undefined"},[],!1,"none",{});return(0,Kn.assert)(t.type!=="exception"),(0,Kn.assert)(t.result.type==="boolean"),t.result.value});Mu.ActionDispatcher=Vh;const $l=(n,e)=>n==="Enter"?"\r":[...n].length===1?e.shift?n.toLocaleUpperCase("en-US"):n:void 0,Ul=(n,e)=>{if(e.ctrl){switch(n){case"Digit2":if(e.shift)return"\0";break;case"KeyA":return"";case"KeyB":return"";case"KeyC":return"";case"KeyD":return"";case"KeyE":return"";case"KeyF":return"";case"KeyG":return"\x07";case"KeyH":return"\b";case"KeyI":return"	";case"KeyJ":return`
`;case"KeyK":return"\v";case"KeyL":return"\f";case"KeyM":return"\r";case"KeyN":return"";case"KeyO":return"";case"KeyP":return"";case"KeyQ":return"";case"KeyR":return"";case"KeyS":return"";case"KeyT":return"";case"KeyU":return"";case"KeyV":return"";case"KeyW":return"";case"KeyX":return"";case"KeyY":return"";case"KeyZ":return"";case"BracketLeft":return"\x1B";case"Backslash":return"";case"BracketRight":return"";case"Digit6":if(e.shift)return"";break;case"Minus":return""}return""}if(e.alt)return""};function pa(n){switch(n){case 0:return"left";case 1:return"middle";case 2:return"right";case 3:return"back";case 4:return"forward";default:return"none"}}function Ll(n){const e=n.altitudeAngle??0,t=n.azimuthAngle??0;let r=0,i=0;if(e===0&&((t===0||t===2*Math.PI)&&(r=Math.PI/2),t===Math.PI/2&&(i=Math.PI/2),t===Math.PI&&(r=-Math.PI/2),t===3*Math.PI/2&&(i=-Math.PI/2),t>0&&t<Math.PI/2&&(r=Math.PI/2,i=Math.PI/2),t>Math.PI/2&&t<Math.PI&&(r=-Math.PI/2,i=Math.PI/2),t>Math.PI&&t<3*Math.PI/2&&(r=-Math.PI/2,i=-Math.PI/2),t>3*Math.PI/2&&t<2*Math.PI&&(r=Math.PI/2,i=-Math.PI/2)),e!==0){const a=Math.tan(e);r=Math.atan(Math.cos(t)/a),i=Math.atan(Math.sin(t)/a)}const o=180/Math.PI;return{tiltX:Math.round(r*o),tiltY:Math.round(i*o)}}function ql(n,e){return{radiusX:n?n/2:.5,radiusY:e?e/2:.5}}var ju={},Bu={},Au={};Object.defineProperty(Au,"__esModule",{value:!0});Au.Mutex=void 0;var Ir,ji,Bi,Hd;class cg{constructor(){u(this,Bi);u(this,Ir,!1);u(this,ji,[])}acquire(){const e={resolved:!1};return s(this,Ir)?new Promise(t=>{s(this,ji).push(()=>t(f(this,Bi,Hd).bind(this,e)))}):(h(this,Ir,!0),Promise.resolve(f(this,Bi,Hd).bind(this,e)))}async run(e){const t=await this.acquire();try{return await e()}finally{t()}}}Ir=new WeakMap,ji=new WeakMap,Bi=new WeakSet,Hd=function(e){if(e.resolved)throw new Error("Cannot release more than once.");e.resolved=!0;const t=s(this,ji).shift();if(!t){h(this,Ir,!1);return}t()};Au.Mutex=cg;Object.defineProperty(Bu,"__esModule",{value:!0});Bu.InputState=void 0;const id=B,ug=Au,Dn=$e;var Lt,wc;class dg{constructor(){I(this,"cancelList",[]);u(this,Lt,new Map);u(this,wc,new ug.Mutex)}getOrCreate(e,t,r){let i=s(this,Lt).get(e);if(!i){switch(t){case"none":i=new Dn.NoneSource;break;case"key":i=new Dn.KeySource;break;case"pointer":{let o=r==="mouse"?0:2;const a=new Set;for(const[,c]of s(this,Lt))c.type==="pointer"&&a.add(c.pointerId);for(;a.has(o);)++o;i=new Dn.PointerSource(o,r);break}case"wheel":i=new Dn.WheelSource;break;default:throw new id.InvalidArgumentException(`Expected "none", "key", "pointer", or "wheel". Found unknown source type ${t}.`)}return s(this,Lt).set(e,i),i}if(i.type!==t)throw new id.InvalidArgumentException(`Input source type of ${e} is ${i.type}, but received ${t}.`);return i}get(e){const t=s(this,Lt).get(e);if(!t)throw new id.UnknownErrorException("Internal error.");return t}getGlobalKeyState(){const e=new Dn.KeySource;for(const[,t]of s(this,Lt))if(t.type==="key"){for(const r of t.pressed)e.pressed.add(r);e.alt||(e.alt=t.alt),e.ctrl||(e.ctrl=t.ctrl),e.meta||(e.meta=t.meta),e.shift||(e.shift=t.shift)}return e}get queue(){return s(this,wc)}}Lt=new WeakMap,wc=new WeakMap;Bu.InputState=dg;Object.defineProperty(ju,"__esModule",{value:!0});ju.InputStateManager=void 0;const lg=Ue,hg=Bu;class pg extends WeakMap{get(e){return(0,lg.assert)(e.isTopLevelContext()),this.has(e)||this.set(e,new hg.InputState),super.get(e)}}ju.InputStateManager=pg;Object.defineProperty(Nu,"__esModule",{value:!0});Nu.InputProcessor=void 0;const fa=B,On=Ue,ma=Mu,fg=ju;var Rr,Ai,Tr,yc,tp;class mg{constructor(e,t){u(this,yc);u(this,Rr,void 0);u(this,Ai,void 0);u(this,Tr,new fg.InputStateManager);h(this,Rr,e),h(this,Ai,t)}async performActions(e){const t=s(this,Rr).getContext(e.context),r=s(this,Tr).get(t.top),i=f(this,yc,tp).call(this,e,r);return await new ma.ActionDispatcher(r,t,await ma.ActionDispatcher.isMacOS(t).catch(()=>!1)).dispatchActions(i),{}}async releaseActions(e){const t=s(this,Rr).getContext(e.context),r=t.top,i=s(this,Tr).get(r);return await new ma.ActionDispatcher(i,t,await ma.ActionDispatcher.isMacOS(t).catch(()=>!1)).dispatchTickActions(i.cancelList.reverse()),s(this,Tr).delete(r),{}}async setFiles(e){const t=s(this,Ai).findRealm({browsingContextId:e.context});if(t===void 0)throw new fa.NoSuchFrameException(`Could not find browsingContext ${e.context}`);let r;try{const a=await t.callFunction(String(function(){return this instanceof HTMLInputElement&&this.type==="file"&&!this.disabled}),e.element,[],!1,"none",{},!1);(0,On.assert)(a.type==="success"),(0,On.assert)(a.result.type==="boolean"),r=a.result.value}catch{throw new fa.NoSuchElementException(`Could not find element ${e.element.sharedId}`)}if(!r)throw new fa.UnableToSetFileInputException(`Element ${e.element.sharedId} is not a mutable file input.`);const i=[];for(let a=0;a<e.files.length;++a){const c=await t.callFunction(String(function(m){return this.files?this.files.item(m):null}),e.element,[{type:"number",value:0}],!1,"root",{},!1);if((0,On.assert)(c.type==="success"),c.result.type!=="object")break;const{handle:l}=c.result;(0,On.assert)(l!==void 0);const{path:p}=await t.cdpClient.sendCommand("DOM.getFileInfo",{objectId:l});i.push(p),t.disown(l).catch(void 0)}i.sort();const o=[...e.files].sort();if(i.length!==e.files.length||o.some((a,c)=>i[c]!==a)){const{objectId:a}=await t.deserializeForCdp(e.element);(0,On.assert)(a!==void 0),await t.cdpClient.sendCommand("DOM.setFileInputFiles",{files:e.files,objectId:a})}else await t.callFunction(String(function(){this.dispatchEvent(new Event("cancel",{bubbles:!0}))}),e.element,[],!1,"none",{},!1);return{}}}Rr=new WeakMap,Ai=new WeakMap,Tr=new WeakMap,yc=new WeakSet,tp=function(e,t){var i;const r=[];for(const o of e.actions){switch(o.type){case"pointer":{o.parameters??(o.parameters={pointerType:"mouse"}),(i=o.parameters).pointerType??(i.pointerType="mouse");const c=t.getOrCreate(o.id,"pointer",o.parameters.pointerType);if(c.subtype!==o.parameters.pointerType)throw new fa.InvalidArgumentException(`Expected input source ${o.id} to be ${c.subtype}; got ${o.parameters.pointerType}.`);break}default:t.getOrCreate(o.id,o.type)}const a=o.actions.map(c=>({id:o.id,action:c}));for(let c=0;c<a.length;c++)r.length===c&&r.push([]),r[c].push(a[c])}return r};Nu.InputProcessor=mg;var oa={},aa={},sp={},Cl=Object.defineProperty,gg=Object.getOwnPropertyDescriptor,wg=Object.getOwnPropertyNames,yg=Object.prototype.hasOwnProperty,vg=(n,e)=>{for(var t in e)Cl(n,t,{get:e[t],enumerable:!0})},bg=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of wg(e))!yg.call(n,i)&&i!==t&&Cl(n,i,{get:()=>e[i],enumerable:!(r=gg(e,i))||r.enumerable});return n},xg=n=>bg(Cl({},"__esModule",{value:!0}),n),rp={};vg(rp,{URLPattern:()=>Gg});var Cg=xg(rp),Hn=class{constructor(n,e,t,r,i,o){I(this,"type",3);I(this,"name","");I(this,"prefix","");I(this,"value","");I(this,"suffix","");I(this,"modifier",3);this.type=n,this.name=e,this.prefix=t,this.value=r,this.suffix=i,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}},Eg=/[$_\p{ID_Start}]/u,Sg=/[$_\u200C\u200D\p{ID_Continue}]/u,zd=".*";function Pg(n,e){return(e?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(n)}function np(n,e=!1){let t=[],r=0;for(;r<n.length;){let i=n[r],o=function(a){if(!e)throw new TypeError(a);t.push({type:"INVALID_CHAR",index:r,value:n[r++]})};if(i==="*"){t.push({type:"ASTERISK",index:r,value:n[r++]});continue}if(i==="+"||i==="?"){t.push({type:"OTHER_MODIFIER",index:r,value:n[r++]});continue}if(i==="\\"){t.push({type:"ESCAPED_CHAR",index:r++,value:n[r++]});continue}if(i==="{"){t.push({type:"OPEN",index:r,value:n[r++]});continue}if(i==="}"){t.push({type:"CLOSE",index:r,value:n[r++]});continue}if(i===":"){let a="",c=r+1;for(;c<n.length;){let l=n.substr(c,1);if(c===r+1&&Eg.test(l)||c!==r+1&&Sg.test(l)){a+=n[c++];continue}break}if(!a){o(`Missing parameter name at ${r}`);continue}t.push({type:"NAME",index:r,value:a}),r=c;continue}if(i==="("){let a=1,c="",l=r+1,p=!1;if(n[l]==="?"){o(`Pattern cannot start with "?" at ${l}`);continue}for(;l<n.length;){if(!Pg(n[l],!1)){o(`Invalid character '${n[l]}' at ${l}.`),p=!0;break}if(n[l]==="\\"){c+=n[l++]+n[l++];continue}if(n[l]===")"){if(a--,a===0){l++;break}}else if(n[l]==="("&&(a++,n[l+1]!=="?")){o(`Capturing groups are not allowed at ${l}`),p=!0;break}c+=n[l++]}if(p)continue;if(a){o(`Unbalanced pattern at ${r}`);continue}if(!c){o(`Missing pattern at ${r}`);continue}t.push({type:"REGEX",index:r,value:c}),r=l;continue}t.push({type:"CHAR",index:r,value:n[r++]})}return t.push({type:"END",index:r,value:""}),t}function ip(n,e={}){let t=np(n);e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./");let r=`[^${Ce(e.delimiter)}]+?`,i=[],o=0,a=0,c=new Set,l=E=>{if(a<t.length&&t[a].type===E)return t[a++].value},p=()=>l("OTHER_MODIFIER")??l("ASTERISK"),g=E=>{let R=l(E);if(R!==void 0)return R;let{type:_,index:k}=t[a];throw new TypeError(`Unexpected ${_} at ${k}, expected ${E}`)},m=()=>{let E="",R;for(;R=l("CHAR")??l("ESCAPED_CHAR");)E+=R;return E},x=E=>E,C=e.encodePart||x,v="",w=E=>{v+=E},y=()=>{v.length&&(i.push(new Hn(3,"","",C(v),"",3)),v="")},b=(E,R,_,k,D)=>{let F=3;switch(D){case"?":F=1;break;case"*":F=0;break;case"+":F=2;break}if(!R&&!_&&F===3){w(E);return}if(y(),!R&&!_){if(!E)return;i.push(new Hn(3,"","",C(E),"",F));return}let U;_?_==="*"?U=zd:U=_:U=r;let ot=2;U===r?(ot=1,U=""):U===zd&&(ot=0,U="");let K;if(R?K=R:_&&(K=o++),c.has(K))throw new TypeError(`Duplicate name '${K}'.`);c.add(K),i.push(new Hn(ot,K,C(E),U,C(k),F))};for(;a<t.length;){let E=l("CHAR"),R=l("NAME"),_=l("REGEX");if(!R&&!_&&(_=l("ASTERISK")),R||_){let D=E??"";e.prefixes.indexOf(D)===-1&&(w(D),D=""),y();let F=p();b(D,R,_,"",F);continue}let k=E??l("ESCAPED_CHAR");if(k){w(k);continue}if(l("OPEN")){let D=m(),F=l("NAME"),U=l("REGEX");!F&&!U&&(U=l("ASTERISK"));let ot=m();g("CLOSE");let K=p();b(D,F,U,ot,K);continue}y(),g("END")}return i}function Ce(n){return n.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function Kl(n){return n&&n.ignoreCase?"ui":"u"}function _g(n,e,t){return op(ip(n,t),e,t)}function rr(n){switch(n){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}function op(n,e,t={}){t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./"),t.sensitive??(t.sensitive=!1),t.strict??(t.strict=!1),t.end??(t.end=!0),t.start??(t.start=!0),t.endsWith="";let r=t.start?"^":"";for(let c of n){if(c.type===3){c.modifier===3?r+=Ce(c.value):r+=`(?:${Ce(c.value)})${rr(c.modifier)}`;continue}e&&e.push(c.name);let l=`[^${Ce(t.delimiter)}]+?`,p=c.value;if(c.type===1?p=l:c.type===0&&(p=zd),!c.prefix.length&&!c.suffix.length){c.modifier===3||c.modifier===1?r+=`(${p})${rr(c.modifier)}`:r+=`((?:${p})${rr(c.modifier)})`;continue}if(c.modifier===3||c.modifier===1){r+=`(?:${Ce(c.prefix)}(${p})${Ce(c.suffix)})`,r+=rr(c.modifier);continue}r+=`(?:${Ce(c.prefix)}`,r+=`((?:${p})(?:`,r+=Ce(c.suffix),r+=Ce(c.prefix),r+=`(?:${p}))*)${Ce(c.suffix)})`,c.modifier===0&&(r+="?")}let i=`[${Ce(t.endsWith)}]|$`,o=`[${Ce(t.delimiter)}]`;if(t.end)return t.strict||(r+=`${o}?`),t.endsWith.length?r+=`(?=${i})`:r+="$",new RegExp(r,Kl(t));t.strict||(r+=`(?:${o}(?=${i}))?`);let a=!1;if(n.length){let c=n[n.length-1];c.type===3&&c.modifier===3&&(a=t.delimiter.indexOf(c)>-1)}return a||(r+=`(?=${o}|${i})`),new RegExp(r,Kl(t))}var xt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},kg={delimiter:".",prefixes:"",sensitive:!0,strict:!0},Ig={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function Rg(n,e){return n.length?n[0]==="/"?!0:!e||n.length<2?!1:(n[0]=="\\"||n[0]=="{")&&n[1]=="/":!1}function ap(n,e){return n.startsWith(e)?n.substring(e.length,n.length):n}function Tg(n,e){return n.endsWith(e)?n.substr(0,n.length-e.length):n}function cp(n){return!n||n.length<2?!1:n[0]==="["||(n[0]==="\\"||n[0]==="{")&&n[1]==="["}var up=["ftp","file","http","https","ws","wss"];function dp(n){if(!n)return!0;for(let e of up)if(n.test(e))return!0;return!1}function Dg(n,e){if(n=ap(n,"#"),e||n==="")return n;let t=new URL("https://example.com");return t.hash=n,t.hash?t.hash.substring(1,t.hash.length):""}function Og(n,e){if(n=ap(n,"?"),e||n==="")return n;let t=new URL("https://example.com");return t.search=n,t.search?t.search.substring(1,t.search.length):""}function Ng(n,e){return e||n===""?n:cp(n)?pp(n):hp(n)}function Mg(n,e){if(e||n==="")return n;let t=new URL("https://example.com");return t.password=n,t.password}function Fg(n,e){if(e||n==="")return n;let t=new URL("https://example.com");return t.username=n,t.username}function jg(n,e,t){if(t||n==="")return n;if(e&&!up.includes(e))return new URL(`${e}:${n}`).pathname;let r=n[0]=="/";return n=new URL(r?n:"/-"+n,"https://example.com").pathname,r||(n=n.substring(2,n.length)),n}function Bg(n,e,t){return lp(e)===n&&(n=""),t||n===""?n:fp(n)}function Ag(n,e){return n=Tg(n,":"),e||n===""?n:El(n)}function lp(n){switch(n){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function El(n){if(n==="")return n;if(/^[-+.A-Za-z0-9]*$/.test(n))return n.toLowerCase();throw new TypeError(`Invalid protocol '${n}'.`)}function $g(n){if(n==="")return n;let e=new URL("https://example.com");return e.username=n,e.username}function Ug(n){if(n==="")return n;let e=new URL("https://example.com");return e.password=n,e.password}function hp(n){if(n==="")return n;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(n))throw new TypeError(`Invalid hostname '${n}'`);let e=new URL("https://example.com");return e.hostname=n,e.hostname}function pp(n){if(n==="")return n;if(/[^0-9a-fA-F[\]:]/g.test(n))throw new TypeError(`Invalid IPv6 hostname '${n}'`);return n.toLowerCase()}function fp(n){if(n===""||/^[0-9]*$/.test(n)&&parseInt(n)<=65535)return n;throw new TypeError(`Invalid port '${n}'.`)}function Lg(n){if(n==="")return n;let e=new URL("https://example.com");return e.pathname=n[0]!=="/"?"/-"+n:n,n[0]!=="/"?e.pathname.substring(2,e.pathname.length):e.pathname}function qg(n){return n===""?n:new URL(`data:${n}`).pathname}function Kg(n){if(n==="")return n;let e=new URL("https://example.com");return e.search=n,e.search.substring(1,e.search.length)}function Hg(n){if(n==="")return n;let e=new URL("https://example.com");return e.hash=n,e.hash.substring(1,e.hash.length)}var Dr,ae,Z,L,vs,Or,ye,Nr,Mr,Fr,V,Y,vc,mp,$i,Wd,bs,Un,jr,va,de,Ee,Ui,Vd,bc,gp,Br,ba,xc,wp,Cc,yp,Ar,xa,qt,er,pt,ns,Ec,vp,Sc,bp,Pc,xp,_c,Cp,_e,Le,kc,Ep,sh,zg=(sh=class{constructor(n){u(this,V);u(this,vc);u(this,$i);u(this,bs);u(this,jr);u(this,de);u(this,Ui);u(this,bc);u(this,Br);u(this,xc);u(this,Cc);u(this,Ar);u(this,qt);u(this,pt);u(this,Ec);u(this,Sc);u(this,Pc);u(this,_c);u(this,_e);u(this,kc);u(this,Dr,void 0);u(this,ae,[]);u(this,Z,{});u(this,L,0);u(this,vs,1);u(this,Or,0);u(this,ye,0);u(this,Nr,0);u(this,Mr,0);u(this,Fr,!1);h(this,Dr,n)}get result(){return s(this,Z)}parse(){for(h(this,ae,np(s(this,Dr),!0));s(this,L)<s(this,ae).length;h(this,L,s(this,L)+s(this,vs))){if(h(this,vs,1),s(this,ae)[s(this,L)].type==="END"){if(s(this,ye)===0){f(this,$i,Wd).call(this),f(this,pt,ns).call(this)?f(this,V,Y).call(this,9,1):f(this,qt,er).call(this)?f(this,V,Y).call(this,8,1):f(this,V,Y).call(this,7,0);continue}else if(s(this,ye)===2){f(this,bs,Un).call(this,5);continue}f(this,V,Y).call(this,10,0);break}if(s(this,Nr)>0)if(f(this,Sc,bp).call(this))h(this,Nr,s(this,Nr)-1);else continue;if(f(this,Ec,vp).call(this)){h(this,Nr,s(this,Nr)+1);continue}switch(s(this,ye)){case 0:f(this,Ui,Vd).call(this)&&f(this,bs,Un).call(this,1);break;case 1:if(f(this,Ui,Vd).call(this)){f(this,kc,Ep).call(this);let n=7,e=1;f(this,bc,gp).call(this)?(n=2,e=3):s(this,Fr)&&(n=2),f(this,V,Y).call(this,n,e)}break;case 2:f(this,Br,ba).call(this)?f(this,bs,Un).call(this,3):(f(this,Ar,xa).call(this)||f(this,qt,er).call(this)||f(this,pt,ns).call(this))&&f(this,bs,Un).call(this,5);break;case 3:f(this,xc,wp).call(this)?f(this,V,Y).call(this,4,1):f(this,Br,ba).call(this)&&f(this,V,Y).call(this,5,1);break;case 4:f(this,Br,ba).call(this)&&f(this,V,Y).call(this,5,1);break;case 5:f(this,Pc,xp).call(this)?h(this,Mr,s(this,Mr)+1):f(this,_c,Cp).call(this)&&h(this,Mr,s(this,Mr)-1),f(this,Cc,yp).call(this)&&!s(this,Mr)?f(this,V,Y).call(this,6,1):f(this,Ar,xa).call(this)?f(this,V,Y).call(this,7,0):f(this,qt,er).call(this)?f(this,V,Y).call(this,8,1):f(this,pt,ns).call(this)&&f(this,V,Y).call(this,9,1);break;case 6:f(this,Ar,xa).call(this)?f(this,V,Y).call(this,7,0):f(this,qt,er).call(this)?f(this,V,Y).call(this,8,1):f(this,pt,ns).call(this)&&f(this,V,Y).call(this,9,1);break;case 7:f(this,qt,er).call(this)?f(this,V,Y).call(this,8,1):f(this,pt,ns).call(this)&&f(this,V,Y).call(this,9,1);break;case 8:f(this,pt,ns).call(this)&&f(this,V,Y).call(this,9,1);break}}s(this,Z).hostname!==void 0&&s(this,Z).port===void 0&&(s(this,Z).port="")}},Dr=new WeakMap,ae=new WeakMap,Z=new WeakMap,L=new WeakMap,vs=new WeakMap,Or=new WeakMap,ye=new WeakMap,Nr=new WeakMap,Mr=new WeakMap,Fr=new WeakMap,V=new WeakSet,Y=function(n,e){var t,r,i;switch(s(this,ye)){case 0:break;case 1:s(this,Z).protocol=f(this,_e,Le).call(this);break;case 2:break;case 3:s(this,Z).username=f(this,_e,Le).call(this);break;case 4:s(this,Z).password=f(this,_e,Le).call(this);break;case 5:s(this,Z).hostname=f(this,_e,Le).call(this);break;case 6:s(this,Z).port=f(this,_e,Le).call(this);break;case 7:s(this,Z).pathname=f(this,_e,Le).call(this);break;case 8:s(this,Z).search=f(this,_e,Le).call(this);break;case 9:s(this,Z).hash=f(this,_e,Le).call(this);break}s(this,ye)!==0&&n!==10&&([1,2,3,4].includes(s(this,ye))&&[6,7,8,9].includes(n)&&((t=s(this,Z)).hostname??(t.hostname="")),[1,2,3,4,5,6].includes(s(this,ye))&&[8,9].includes(n)&&((r=s(this,Z)).pathname??(r.pathname=s(this,Fr)?"/":"")),[1,2,3,4,5,6,7].includes(s(this,ye))&&n===9&&((i=s(this,Z)).search??(i.search=""))),f(this,vc,mp).call(this,n,e)},vc=new WeakSet,mp=function(n,e){h(this,ye,n),h(this,Or,s(this,L)+e),h(this,L,s(this,L)+e),h(this,vs,0)},$i=new WeakSet,Wd=function(){h(this,L,s(this,Or)),h(this,vs,0)},bs=new WeakSet,Un=function(n){f(this,$i,Wd).call(this),h(this,ye,n)},jr=new WeakSet,va=function(n){return n<0&&(n=s(this,ae).length-n),n<s(this,ae).length?s(this,ae)[n]:s(this,ae)[s(this,ae).length-1]},de=new WeakSet,Ee=function(n,e){let t=f(this,jr,va).call(this,n);return t.value===e&&(t.type==="CHAR"||t.type==="ESCAPED_CHAR"||t.type==="INVALID_CHAR")},Ui=new WeakSet,Vd=function(){return f(this,de,Ee).call(this,s(this,L),":")},bc=new WeakSet,gp=function(){return f(this,de,Ee).call(this,s(this,L)+1,"/")&&f(this,de,Ee).call(this,s(this,L)+2,"/")},Br=new WeakSet,ba=function(){return f(this,de,Ee).call(this,s(this,L),"@")},xc=new WeakSet,wp=function(){return f(this,de,Ee).call(this,s(this,L),":")},Cc=new WeakSet,yp=function(){return f(this,de,Ee).call(this,s(this,L),":")},Ar=new WeakSet,xa=function(){return f(this,de,Ee).call(this,s(this,L),"/")},qt=new WeakSet,er=function(){if(f(this,de,Ee).call(this,s(this,L),"?"))return!0;if(s(this,ae)[s(this,L)].value!=="?")return!1;let n=f(this,jr,va).call(this,s(this,L)-1);return n.type!=="NAME"&&n.type!=="REGEX"&&n.type!=="CLOSE"&&n.type!=="ASTERISK"},pt=new WeakSet,ns=function(){return f(this,de,Ee).call(this,s(this,L),"#")},Ec=new WeakSet,vp=function(){return s(this,ae)[s(this,L)].type=="OPEN"},Sc=new WeakSet,bp=function(){return s(this,ae)[s(this,L)].type=="CLOSE"},Pc=new WeakSet,xp=function(){return f(this,de,Ee).call(this,s(this,L),"[")},_c=new WeakSet,Cp=function(){return f(this,de,Ee).call(this,s(this,L),"]")},_e=new WeakSet,Le=function(){let n=s(this,ae)[s(this,L)],e=f(this,jr,va).call(this,s(this,Or)).index;return s(this,Dr).substring(e,n.index)},kc=new WeakSet,Ep=function(){let n={};Object.assign(n,xt),n.encodePart=El;let e=_g(f(this,_e,Le).call(this),void 0,n);h(this,Fr,dp(e))},sh),od=["protocol","username","password","hostname","port","pathname","search","hash"],vt="*";function Hl(n,e){if(typeof n!="string")throw new TypeError("parameter 1 is not of type 'string'.");let t=new URL(n,e);return{protocol:t.protocol.substring(0,t.protocol.length-1),username:t.username,password:t.password,hostname:t.hostname,port:t.port,pathname:t.pathname,search:t.search!==""?t.search.substring(1,t.search.length):void 0,hash:t.hash!==""?t.hash.substring(1,t.hash.length):void 0}}function ct(n,e){return e?Ln(n):n}function Nn(n,e,t){let r;if(typeof e.baseURL=="string")try{r=new URL(e.baseURL),e.protocol===void 0&&(n.protocol=ct(r.protocol.substring(0,r.protocol.length-1),t)),!t&&e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.username===void 0&&(n.username=ct(r.username,t)),!t&&e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.username===void 0&&e.password===void 0&&(n.password=ct(r.password,t)),e.protocol===void 0&&e.hostname===void 0&&(n.hostname=ct(r.hostname,t)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&(n.port=ct(r.port,t)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&(n.pathname=ct(r.pathname,t)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0&&(n.search=ct(r.search.substring(1,r.search.length),t)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0&&e.hash===void 0&&(n.hash=ct(r.hash.substring(1,r.hash.length),t))}catch{throw new TypeError(`invalid baseURL '${e.baseURL}'.`)}if(typeof e.protocol=="string"&&(n.protocol=Ag(e.protocol,t)),typeof e.username=="string"&&(n.username=Fg(e.username,t)),typeof e.password=="string"&&(n.password=Mg(e.password,t)),typeof e.hostname=="string"&&(n.hostname=Ng(e.hostname,t)),typeof e.port=="string"&&(n.port=Bg(e.port,n.protocol,t)),typeof e.pathname=="string"){if(n.pathname=e.pathname,r&&!Rg(n.pathname,t)){let i=r.pathname.lastIndexOf("/");i>=0&&(n.pathname=ct(r.pathname.substring(0,i+1),t)+n.pathname)}n.pathname=jg(n.pathname,n.protocol,t)}return typeof e.search=="string"&&(n.search=Og(e.search,t)),typeof e.hash=="string"&&(n.hash=Dg(e.hash,t)),n}function Ln(n){return n.replace(/([+*?:{}()\\])/g,"\\$1")}function Wg(n){return n.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function Vg(n,e){e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./"),e.sensitive??(e.sensitive=!1),e.strict??(e.strict=!1),e.end??(e.end=!0),e.start??(e.start=!0),e.endsWith="";let t=".*",r=`[^${Wg(e.delimiter)}]+?`,i=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let a=0;a<n.length;++a){let c=n[a];if(c.type===3){if(c.modifier===3){o+=Ln(c.value);continue}o+=`{${Ln(c.value)}}${rr(c.modifier)}`;continue}let l=c.hasCustomName(),p=!!c.suffix.length||!!c.prefix.length&&(c.prefix.length!==1||!e.prefixes.includes(c.prefix)),g=a>0?n[a-1]:null,m=a<n.length-1?n[a+1]:null;if(!p&&l&&c.type===1&&c.modifier===3&&m&&!m.prefix.length&&!m.suffix.length)if(m.type===3){let x=m.value.length>0?m.value[0]:"";p=i.test(x)}else p=!m.hasCustomName();if(!p&&!c.prefix.length&&g&&g.type===3){let x=g.value[g.value.length-1];p=e.prefixes.includes(x)}p&&(o+="{"),o+=Ln(c.prefix),l&&(o+=`:${c.name}`),c.type===2?o+=`(${c.value})`:c.type===1?l||(o+=`(${r})`):c.type===0&&(!l&&(!g||g.type===3||g.modifier!==3||p||c.prefix!=="")?o+="*":o+=`(${t})`),c.type===1&&l&&c.suffix.length&&i.test(c.suffix[0])&&(o+="\\"),o+=Ln(c.suffix),p&&(o+="}"),c.modifier!==3&&(o+=rr(c.modifier))}return o}var Ye,xs,$r,ee,Oe,Ur,rh,Gg=(rh=class{constructor(n={},e,t){u(this,Ye,void 0);u(this,xs,{});u(this,$r,{});u(this,ee,{});u(this,Oe,{});u(this,Ur,!1);try{let r;if(typeof e=="string"?r=e:t=e,typeof n=="string"){let c=new zg(n);if(c.parse(),n=c.result,r===void 0&&typeof n.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");n.baseURL=r}else{if(!n||typeof n!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(r)throw new TypeError("parameter 1 is not of type 'string'.")}typeof t>"u"&&(t={ignoreCase:!1});let i={ignoreCase:t.ignoreCase===!0};h(this,Ye,Nn({pathname:vt,protocol:vt,username:vt,password:vt,hostname:vt,port:vt,search:vt,hash:vt},n,!0)),lp(s(this,Ye).protocol)===s(this,Ye).port&&(s(this,Ye).port="");let a;for(a of od){if(!(a in s(this,Ye)))continue;let c={},l=s(this,Ye)[a];switch(s(this,$r)[a]=[],a){case"protocol":Object.assign(c,xt),c.encodePart=El;break;case"username":Object.assign(c,xt),c.encodePart=$g;break;case"password":Object.assign(c,xt),c.encodePart=Ug;break;case"hostname":Object.assign(c,kg),cp(l)?c.encodePart=pp:c.encodePart=hp;break;case"port":Object.assign(c,xt),c.encodePart=fp;break;case"pathname":dp(s(this,xs).protocol)?(Object.assign(c,Ig,i),c.encodePart=Lg):(Object.assign(c,xt,i),c.encodePart=qg);break;case"search":Object.assign(c,xt,i),c.encodePart=Kg;break;case"hash":Object.assign(c,xt,i),c.encodePart=Hg;break}try{s(this,Oe)[a]=ip(l,c),s(this,xs)[a]=op(s(this,Oe)[a],s(this,$r)[a],c),s(this,ee)[a]=Vg(s(this,Oe)[a],c),h(this,Ur,s(this,Ur)||s(this,Oe)[a].some(p=>p.type===2))}catch{throw new TypeError(`invalid ${a} pattern '${s(this,Ye)[a]}'.`)}}}catch(r){throw new TypeError(`Failed to construct 'URLPattern': ${r.message}`)}}test(n={},e){let t={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof n!="string"&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof n>"u")return!1;try{typeof n=="object"?t=Nn(t,n,!1):t=Nn(t,Hl(n,e),!1)}catch{return!1}let r;for(r of od)if(!s(this,xs)[r].exec(t[r]))return!1;return!0}exec(n={},e){let t={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof n!="string"&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof n>"u")return;try{typeof n=="object"?t=Nn(t,n,!1):t=Nn(t,Hl(n,e),!1)}catch{return null}let r={};e?r.inputs=[n,e]:r.inputs=[n];let i;for(i of od){let o=s(this,xs)[i].exec(t[i]);if(!o)return null;let a={};for(let[c,l]of s(this,$r)[i].entries())if(typeof l=="string"||typeof l=="number"){let p=o[c+1];a[l]=p}r[i]={input:t[i]??"",groups:a}}return r}static compareComponent(n,e,t){let r=(c,l)=>{for(let p of["type","modifier","prefix","value","suffix"]){if(c[p]<l[p])return-1;if(c[p]!==l[p])return 1}return 0},i=new Hn(3,"","","","",3),o=new Hn(0,"","","","",3),a=(c,l)=>{let p=0;for(;p<Math.min(c.length,l.length);++p){let g=r(c[p],l[p]);if(g)return g}return c.length===l.length?0:r(c[p]??i,l[p]??i)};return!s(e,ee)[n]&&!s(t,ee)[n]?0:s(e,ee)[n]&&!s(t,ee)[n]?a(s(e,Oe)[n],[o]):!s(e,ee)[n]&&s(t,ee)[n]?a([o],s(t,Oe)[n]):a(s(e,Oe)[n],s(t,Oe)[n])}get protocol(){return s(this,ee).protocol}get username(){return s(this,ee).username}get password(){return s(this,ee).password}get hostname(){return s(this,ee).hostname}get port(){return s(this,ee).port}get pathname(){return s(this,ee).pathname}get search(){return s(this,ee).search}get hash(){return s(this,ee).hash}get hasRegExpGroups(){return s(this,Ur)}},Ye=new WeakMap,xs=new WeakMap,$r=new WeakMap,ee=new WeakMap,Oe=new WeakMap,Ur=new WeakMap,rh);const{URLPattern:Sp}=Cg;var Xg={URLPattern:Sp};globalThis.URLPattern||(globalThis.URLPattern=Sp);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.URLPattern=void 0;const e=Xg;Object.defineProperty(n,"URLPattern",{enumerable:!0,get:function(){return e.URLPattern}}),"URLPattern"in globalThis&&(e.URLPattern=globalThis.URLPattern)})(sp);Object.defineProperty(aa,"__esModule",{value:!0});aa.NetworkStorage=void 0;const Jg=B,Yg=sp,Qg=Ws;var Ne,Qe,Cs;const is=class is{constructor(){u(this,Ne,new Map);u(this,Qe,new Map);u(this,Cs,new Map)}disposeRequestMap(){for(const e of s(this,Ne).values())e.dispose();s(this,Ne).clear()}addIntercept(e){const t=(0,Qg.uuidv4)();return s(this,Qe).set(t,e),t}removeIntercept(e){if(!s(this,Qe).has(e))throw new Jg.NoSuchInterceptException(`Intercept '${e}' does not exist.`);s(this,Qe).delete(e)}hasIntercepts(){return s(this,Qe).size>0}getFetchEnableParams(){const e=[];for(const t of s(this,Qe).values())for(const r of t.phases){const i=is.requestStageFromPhase(r);if(t.urlPatterns.length===0){e.push({urlPattern:"*",requestStage:i});continue}for(const o of t.urlPatterns){const a=is.cdpFromSpecUrlPattern(o);e.push({urlPattern:a,requestStage:i})}}return{patterns:e,handleAuthRequests:[...s(this,Qe).values()].some(t=>t.phases.includes("authRequired"))}}getRequest(e){return s(this,Ne).get(e)}addRequest(e){s(this,Ne).set(e.requestId,e)}deleteRequest(e){const t=s(this,Ne).get(e);t&&(t.dispose(),s(this,Ne).delete(e))}hasNetworkRequests(){return s(this,Ne).size>0}hasBlockedRequests(){return s(this,Cs).size>0}static cdpFromSpecUrlPattern(e){switch(e.type){case"string":return e.pattern;case"pattern":return is.buildUrlPatternString(e)}}static buildUrlPatternString({protocol:e,hostname:t,port:r,pathname:i,search:o}){if(!e&&!t&&!r&&!i&&!o)return"*";let a="";return e&&(a+=e,e.endsWith(":")||(a+=":"),is.isSpecialScheme(e)&&(a+="//")),t&&(a+=t),r&&(a+=`:${r}`),i&&(i.startsWith("/")||(a+="/"),a+=i),o&&(o.startsWith("?")||(a+="?"),a+=o),a}static requestStageFromPhase(e){switch(e){case"beforeRequestSent":return"Request";case"responseStarted":case"authRequired":return"Response"}}static isSpecialScheme(e){return["ftp","file","http","https","ws","wss"].includes(e.replace(/:$/,""))}addBlockedRequest(e,t){s(this,Cs).set(e,t)}removeBlockedRequest(e){s(this,Cs).delete(e)}getBlockedRequest(e){return s(this,Cs).get(e)}getNetworkIntercepts(e,t){const r=s(this,Ne).get(e);if(!r)return[];const i=[];for(const[o,{phases:a,urlPatterns:c}]of s(this,Qe).entries())t&&a.includes(t)&&(c.length===0||c.some(l=>is.matchUrlPattern(l,r.url)))&&i.push(o);return i}static matchUrlPattern(e,t){switch(e.type){case"string":return e.pattern===t;case"pattern":return new Yg.URLPattern({protocol:e.protocol,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search}).exec(t)!==null}}};Ne=new WeakMap,Qe=new WeakMap,Cs=new WeakMap;let Gd=is;aa.NetworkStorage=Gd;Object.defineProperty(oa,"__esModule",{value:!0});oa.NetworkProcessor=void 0;const me=B,Zg=Ue,ew=aa,ga=X;var Lr,ce,Ic,Pp,Rc,_p,Li,Jd,Kt,tr,Ht,sr;const Vn=class Vn{constructor(e,t){u(this,Ic);u(this,Rc);u(this,Li);u(this,Kt);u(this,Ht);u(this,Lr,void 0);u(this,ce,void 0);h(this,Lr,e),h(this,ce,t)}async addIntercept(e){e.phases.includes("authRequired")&&!e.phases.includes("beforeRequestSent")&&e.phases.unshift("beforeRequestSent");const t=e.urlPatterns??[],r=Vn.parseUrlPatterns(t),i=s(this,ce).addIntercept({urlPatterns:r,phases:e.phases});return await f(this,Li,Jd).call(this),{intercept:i}}async continueRequest(e){const t=e.request,{request:r,phase:i}=f(this,Kt,tr).call(this,t);if(i!=="beforeRequestSent")throw new me.InvalidArgumentException(`Blocked request for network id '${t}' is not in 'BeforeRequestSent' phase`);e.url!==void 0&&Vn.parseUrlString(e.url);const{url:o,method:a,headers:c}=e,l=(0,ga.cdpFetchHeadersFromBidiNetworkHeaders)(c);return await f(this,Ht,sr).call(this,t).continueRequest(r,o,a,l),s(this,ce).removeBlockedRequest(t),{}}async continueResponse(e){const t=e.request,{request:r,phase:i}=f(this,Kt,tr).call(this,t);if(i==="beforeRequestSent")throw new me.InvalidArgumentException(`Blocked request for network id '${t}' is in 'BeforeRequestSent' phase`);const{statusCode:o,reasonPhrase:a,headers:c}=e,l=(0,ga.cdpFetchHeadersFromBidiNetworkHeaders)(c);return await f(this,Ht,sr).call(this,t).continueResponse(r,o,a,l),s(this,ce).removeBlockedRequest(t),{}}async continueWithAuth(e){const t=e.request,{request:r,phase:i}=f(this,Kt,tr).call(this,t);if(i!=="authRequired")throw new me.InvalidArgumentException(`Blocked request for network id '${t}' is not in 'AuthRequired' phase`);const o=f(this,Ht,sr).call(this,t);let a,c;if(e.action==="provideCredentials"){const{credentials:p}=e;a=p.username,c=p.password,(0,Zg.assert)(p.type==="password",`Credentials type ${p.type} must be 'password'`)}const l=(0,ga.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction)(e.action);return await o.continueWithAuth(r,l,a,c),{}}async failRequest({request:e}){const{request:t,phase:r}=f(this,Kt,tr).call(this,e);if(r==="authRequired")throw new me.InvalidArgumentException(`Blocked request for network id '${e}' is in 'AuthRequired' phase`);return await f(this,Ht,sr).call(this,e).failRequest(t,"Failed"),s(this,ce).removeBlockedRequest(e),{}}async provideResponse(e){const{statusCode:t,reasonPhrase:r,headers:i,body:o,request:a}=e,{request:c}=f(this,Kt,tr).call(this,a),l=(0,ga.cdpFetchHeadersFromBidiNetworkHeaders)(i),p=f(this,Ht,sr).call(this,a);return await p.provideResponse(c,t??p.statusCode,r,l,o==null?void 0:o.value),s(this,ce).removeBlockedRequest(a),{}}async removeIntercept(e){return s(this,ce).removeIntercept(e.intercept),await f(this,Li,Jd).call(this),{}}static parseUrlString(e){try{return new URL(e)}catch(t){throw new me.InvalidArgumentException(`Invalid URL '${e}': ${t}`)}}static parseUrlPatterns(e){return e.map(t=>{var r,i,o;switch(t.type){case"string":return Vn.parseUrlString(t.pattern),t;case"pattern":if(t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&t.search===void 0)return t;if(t.protocol==="")throw new me.InvalidArgumentException("URL pattern must specify a protocol");if(t.hostname==="")throw new me.InvalidArgumentException("URL pattern must specify a hostname");if((((r=t.hostname)==null?void 0:r.length)??0)>0){if((i=t.protocol)!=null&&i.match(/^file/i))throw new me.InvalidArgumentException("URL pattern protocol cannot be 'file'");if((o=t.hostname)!=null&&o.includes(":"))throw new me.InvalidArgumentException("URL pattern hostname must not contain a colon")}if(t.port==="")throw new me.InvalidArgumentException("URL pattern must specify a port");try{new URL(ew.NetworkStorage.buildUrlPatternString(t))}catch(a){throw new me.InvalidArgumentException(`${a}`)}return t}})}};Lr=new WeakMap,ce=new WeakMap,Ic=new WeakSet,Pp=async function(){await Promise.all(s(this,Lr).getAllContexts().map(async e=>{await e.cdpTarget.fetchEnable()}))},Rc=new WeakSet,_p=async function(){await Promise.all(s(this,Lr).getAllContexts().map(async e=>{await e.cdpTarget.fetchDisable()}))},Li=new WeakSet,Jd=async function(){s(this,ce).hasIntercepts()||s(this,ce).hasBlockedRequests()||s(this,ce).hasNetworkRequests()?await f(this,Ic,Pp).call(this):await f(this,Rc,_p).call(this)},Kt=new WeakSet,tr=function(e){const t=s(this,ce).getBlockedRequest(e);if(!t)throw new me.NoSuchRequestException(`No blocked request found for network id '${e}'`);return t},Ht=new WeakSet,sr=function(e){const t=s(this,ce).getRequest(e);if(!t)throw new me.NoSuchRequestException(`Network request with ID ${e} doesn't exist`);return t};let Xd=Vn;oa.NetworkProcessor=Xd;var $u={};Object.defineProperty($u,"__esModule",{value:!0});$u.PermissionsProcessor=void 0;const tw=B;var qi;class sw{constructor(e){u(this,qi,void 0);h(this,qi,e)}async setPermissions(e){try{await s(this,qi).sendCommand("Browser.setPermission",{origin:e.origin,permission:{name:e.descriptor.name},setting:e.state})}catch(t){if(t.message==="Permission can't be granted to opaque origins.")return{};throw new tw.InvalidArgumentException(t.message)}return{}}}qi=new WeakMap;$u.PermissionsProcessor=sw;var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0});Uu.PreloadScriptStorage=void 0;var Es;class rw{constructor(){u(this,Es,new Set)}find(e){return e?[...s(this,Es)].filter(t=>!(e.id!==void 0&&e.id!==t.id||e.targetId!==void 0&&!t.targetIds.has(e.targetId)||e.global!==void 0&&(e.global&&t.contexts!==void 0||!e.global&&t.contexts===void 0))):[...s(this,Es)]}add(e){s(this,Es).add(e)}remove(e){for(const t of this.find(e))s(this,Es).delete(t)}}Es=new WeakMap;Uu.PreloadScriptStorage=rw;var Lu={},qu={};Object.defineProperty(qu,"__esModule",{value:!0});qu.PreloadScript=void 0;const nw=Ws,iw=na;var Tc,Ss,Ki,qr,Hi,zi,Wi,Dc,kp;class ow{constructor(e,t){u(this,Dc);u(this,Tc,(0,nw.uuidv4)());u(this,Ss,[]);u(this,Ki,void 0);u(this,qr,new Set);u(this,Hi,void 0);u(this,zi,void 0);u(this,Wi,void 0);var r;h(this,Hi,((r=e.arguments)==null?void 0:r.map(i=>new iw.ChannelProxy(i.value,t)))??[]),h(this,Ki,e.functionDeclaration),h(this,zi,e.sandbox),h(this,Wi,e.contexts)}get id(){return s(this,Tc)}get targetIds(){return s(this,qr)}get channels(){return s(this,Hi)}get contexts(){return s(this,Wi)}async initInTargets(e,t){await Promise.all(Array.from(e).map(r=>this.initInTarget(r,t)))}async initInTarget(e,t){const r=await e.cdpClient.sendCommand("Page.addScriptToEvaluateOnNewDocument",{source:f(this,Dc,kp).call(this),worldName:s(this,zi),runImmediately:t});s(this,Ss).push({target:e,preloadScriptId:r.identifier}),s(this,qr).add(e.id)}async remove(){for(const e of s(this,Ss)){const t=e.target,r=e.preloadScriptId;await t.cdpClient.sendCommand("Page.removeScriptToEvaluateOnNewDocument",{identifier:r})}}dispose(e){h(this,Ss,s(this,Ss).filter(t=>{var r;return((r=t.target)==null?void 0:r.id)!==e})),s(this,qr).delete(e)}}Tc=new WeakMap,Ss=new WeakMap,Ki=new WeakMap,qr=new WeakMap,Hi=new WeakMap,zi=new WeakMap,Wi=new WeakMap,Dc=new WeakSet,kp=function(){const e=`[${this.channels.map(t=>t.getEvalInWindowStr()).join(", ")}]`;return`(()=>{(${s(this,Ki)})(...${e})})()`};qu.PreloadScript=ow;Object.defineProperty(Lu,"__esModule",{value:!0});Lu.ScriptProcessor=void 0;const ad=B,aw=qu;var zt,Kr,Ps,Vi,Hr,Ca;class cw{constructor(e,t,r,i){u(this,Hr);u(this,zt,void 0);u(this,Kr,void 0);u(this,Ps,void 0);u(this,Vi,void 0);h(this,zt,e),h(this,Kr,t),h(this,Ps,r),h(this,Vi,i)}async addPreloadScript(e){const t=new Set;if(e.contexts){if(e.contexts.length===0)throw new ad.InvalidArgumentException("Contexts list is empty.");for(const o of e.contexts){const a=s(this,zt).getContext(o);if(a.isTopLevelContext())t.add(a);else throw new ad.InvalidArgumentException(`Non top-level context '${o}' given.`)}}const r=new aw.PreloadScript(e,s(this,Vi));s(this,Ps).add(r);const i=t.size===0?new Set(s(this,zt).getTopLevelContexts().map(o=>o.cdpTarget)):new Set([...t.values()].map(o=>o.cdpTarget));return await r.initInTargets(i,!1),{script:r.id}}async removePreloadScript(e){const t=e.script,r=s(this,Ps).find({id:t});if(r.length===0)throw new ad.NoSuchScriptException(`No preload script with BiDi ID '${t}'`);return await Promise.all(r.map(i=>i.remove())),s(this,Ps).remove({id:t}),{}}async callFunction(e){return await(await f(this,Hr,Ca).call(this,e.target)).callFunction(e.functionDeclaration,e.this??{type:"undefined"},e.arguments??[],e.awaitPromise,e.resultOwnership??"none",e.serializationOptions??{},e.userActivation??!1)}async evaluate(e){return await(await f(this,Hr,Ca).call(this,e.target)).evaluate(e.expression,e.awaitPromise,e.resultOwnership??"none",e.serializationOptions??{},e.userActivation??!1)}async disown(e){const t=await f(this,Hr,Ca).call(this,e.target);return await Promise.all(e.handles.map(async r=>await t.disown(r))),{}}getRealms(e){return e.context!==void 0&&s(this,zt).getContext(e.context),{realms:s(this,Kr).findRealms({browsingContextId:e.context,type:e.type}).map(r=>r.realmInfo)}}}zt=new WeakMap,Kr=new WeakMap,Ps=new WeakMap,Vi=new WeakMap,Hr=new WeakSet,Ca=async function(e){return"realm"in e?s(this,Kr).getRealm({realmId:e.realm}):await s(this,zt).getContext(e.context).getOrCreateSandbox(e.sandbox)};Lu.ScriptProcessor=cw;var Ku={};Object.defineProperty(Ku,"__esModule",{value:!0});Ku.SessionProcessor=void 0;var zr;class uw{constructor(e){u(this,zr,void 0);h(this,zr,e)}status(){return{ready:!1,message:"already connected"}}subscribe(e,t=null){return s(this,zr).subscribe(e.events,e.contexts??[null],t),{}}unsubscribe(e,t=null){return s(this,zr).unsubscribe(e.events,e.contexts??[null],t),{}}}zr=new WeakMap;Ku.SessionProcessor=uw;var Hu={};Object.defineProperty(Hu,"__esModule",{value:!0});Hu.StorageProcessor=void 0;const dw=B,lw=Ue,zl=Re,hw=oa,Wl=X;var Wr,Gi,Vr,Oc,Ip,Nc,Rp,Xi,Yd,Mc,Tp;class pw{constructor(e,t,r){u(this,Oc);u(this,Nc);u(this,Xi);u(this,Mc);u(this,Wr,void 0);u(this,Gi,void 0);u(this,Vr,void 0);h(this,Gi,t),h(this,Wr,e),h(this,Vr,r)}async getCookies(e){const t=f(this,Xi,Yd).call(this,e.partition);return{cookies:(await s(this,Wr).sendCommand("Storage.getCookies",{browserContextId:t.userContext})).cookies.filter(o=>t.sourceOrigin===void 0||o.partitionKey===t.sourceOrigin).map(o=>(0,Wl.cdpToBiDiCookie)(o)).filter(o=>f(this,Mc,Tp).call(this,o,e.filter)),partitionKey:t}}async setCookie(e){var i;const t=f(this,Xi,Yd).call(this,e.partition),r=(0,Wl.bidiToCdpCookie)(e,t);try{await s(this,Wr).sendCommand("Storage.setCookies",{cookies:[r],browserContextId:t.userContext})}catch(o){throw(i=s(this,Vr))==null||i.call(this,zl.LogType.debugError,o),new dw.UnableToSetCookieException(o.toString())}return{partitionKey:t}}}Wr=new WeakMap,Gi=new WeakMap,Vr=new WeakMap,Oc=new WeakSet,Ip=function(e){const t=e.context,r=s(this,Gi).getContext(t);return{userContext:r.userContext==="default"?void 0:r.userContext}},Nc=new WeakSet,Rp=function(e){var o;const t=new Map;let r=e.sourceOrigin;if(r!==void 0){const a=hw.NetworkProcessor.parseUrlString(r);a.origin==="null"?r=a.origin:r=`${a.protocol}//${a.hostname}`}const i=e.userContext==="default"?void 0:e.userContext;for(const[a,c]of Object.entries(e))a!==void 0&&c!==void 0&&!["type","sourceOrigin","userContext"].includes(a)&&t.set(a,c);return t.size>0&&((o=s(this,Vr))==null||o.call(this,zl.LogType.debugInfo,`Unsupported partition keys: ${JSON.stringify(Object.fromEntries(t))}`)),{...r===void 0?{}:{sourceOrigin:r},...i===void 0?{}:{userContext:i}}},Xi=new WeakSet,Yd=function(e){return e===void 0?{}:e.type==="context"?f(this,Oc,Ip).call(this,e):((0,lw.assert)(e.type==="storageKey","Unknown partition type"),f(this,Nc,Rp).call(this,e))},Mc=new WeakSet,Tp=function(e,t){return t===void 0?!0:(t.domain===void 0||t.domain===e.domain)&&(t.name===void 0||t.name===e.name)&&(t.value===void 0||t.value.type===e.value.type&&t.value.value===e.value.value)&&(t.path===void 0||t.path===e.path)&&(t.size===void 0||t.size===e.size)&&(t.httpOnly===void 0||t.httpOnly===e.httpOnly)&&(t.secure===void 0||t.secure===e.secure)&&(t.sameSite===void 0||t.sameSite===e.sameSite)&&(t.expiry===void 0||t.expiry===e.expiry)};Hu.StorageProcessor=pw;var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.OutgoingMessage=void 0;var Ji,Yi;const Fc=class Fc{constructor(e,t=null){u(this,Ji,void 0);u(this,Yi,void 0);h(this,Ji,e),h(this,Yi,t)}static createFromPromise(e,t){return e.then(r=>r.kind==="success"?{kind:"success",value:new Fc(r.value,t)}:r)}static createResolved(e,t){return Promise.resolve({kind:"success",value:new Fc(e,t)})}get message(){return s(this,Ji)}get channel(){return s(this,Yi)}};Ji=new WeakMap,Yi=new WeakMap;let Qd=Fc;Rn.OutgoingMessage=Qd;Object.defineProperty(Cu,"__esModule",{value:!0});Cu.CommandProcessor=void 0;const Mn=B,fw=zs,mw=Re,gw=Eu,ww=Su,yw=Pu,vw=_u,bw=Nu,xw=oa,Cw=aa,Ew=$u,Sw=Uu,Pw=Lu,_w=Ku,kw=Hu,cd=Rn;var Wt,ue,Gr,_s,Me,Qi,Ze,ks,Xr,N,Zi,jc,Dp;class Iw extends fw.EventEmitter{constructor(t,r,i,o,a,c,l,p,g,m=new gw.BidiNoOpParser,x){super();u(this,jc);u(this,Wt,void 0);u(this,ue,void 0);u(this,Gr,void 0);u(this,_s,void 0);u(this,Me,void 0);u(this,Qi,void 0);u(this,Ze,void 0);u(this,ks,void 0);u(this,Xr,void 0);u(this,N,void 0);u(this,Zi,void 0);h(this,N,m),h(this,Zi,x);const C=new Cw.NetworkStorage,v=new Sw.PreloadScriptStorage;h(this,Wt,new ww.BrowserProcessor(r)),h(this,ue,new vw.BrowsingContextProcessor(t,r,o,i,c,l,C,v,p,g,a,x)),h(this,Gr,new yw.CdpProcessor(c,t,r)),h(this,_s,new bw.InputProcessor(c,l)),h(this,Me,new xw.NetworkProcessor(c,C)),h(this,Qi,new Ew.PermissionsProcessor(r)),h(this,Ze,new Pw.ScriptProcessor(c,l,v,x)),h(this,ks,new _w.SessionProcessor(i)),h(this,Xr,new kw.StorageProcessor(r,c,x))}async processCommand(t){var r;try{const i=await f(this,jc,Dp).call(this,t),o={type:"success",id:t.id,result:i};this.emit("response",{message:cd.OutgoingMessage.createResolved(o,t.channel),event:t.method})}catch(i){if(i instanceof Mn.Exception)this.emit("response",{message:cd.OutgoingMessage.createResolved(i.toErrorResponse(t.id),t.channel),event:t.method});else{const o=i;(r=s(this,Zi))==null||r.call(this,mw.LogType.bidi,o),this.emit("response",{message:cd.OutgoingMessage.createResolved(new Mn.UnknownErrorException(o.message,o.stack).toErrorResponse(t.id),t.channel),event:t.method})}}}}Wt=new WeakMap,ue=new WeakMap,Gr=new WeakMap,_s=new WeakMap,Me=new WeakMap,Qi=new WeakMap,Ze=new WeakMap,ks=new WeakMap,Xr=new WeakMap,N=new WeakMap,Zi=new WeakMap,jc=new WeakSet,Dp=async function(t){switch(t.method){case"session.end":case"session.new":break;case"browser.close":return s(this,Wt).close();case"browser.createUserContext":return await s(this,Wt).createUserContext();case"browser.getUserContexts":return await s(this,Wt).getUserContexts();case"browser.removeUserContext":return await s(this,Wt).removeUserContext(t.params.userContext);case"browsingContext.activate":return await s(this,ue).activate(s(this,N).parseActivateParams(t.params));case"browsingContext.captureScreenshot":return await s(this,ue).captureScreenshot(s(this,N).parseCaptureScreenshotParams(t.params));case"browsingContext.close":return await s(this,ue).close(s(this,N).parseCloseParams(t.params));case"browsingContext.create":return await s(this,ue).create(s(this,N).parseCreateParams(t.params));case"browsingContext.getTree":return s(this,ue).getTree(s(this,N).parseGetTreeParams(t.params));case"browsingContext.handleUserPrompt":return await s(this,ue).handleUserPrompt(s(this,N).parseHandleUserPromptParams(t.params));case"browsingContext.locateNodes":throw new Mn.UnsupportedOperationException(`Command '${t.method}' not yet implemented.`);case"browsingContext.navigate":return await s(this,ue).navigate(s(this,N).parseNavigateParams(t.params));case"browsingContext.print":return await s(this,ue).print(s(this,N).parsePrintParams(t.params));case"browsingContext.reload":return await s(this,ue).reload(s(this,N).parseReloadParams(t.params));case"browsingContext.setViewport":return await s(this,ue).setViewport(s(this,N).parseSetViewportParams(t.params));case"browsingContext.traverseHistory":return await s(this,ue).traverseHistory(s(this,N).parseTraverseHistoryParams(t.params));case"cdp.getSession":return s(this,Gr).getSession(s(this,N).parseGetSessionParams(t.params));case"cdp.sendCommand":return await s(this,Gr).sendCommand(s(this,N).parseSendCommandParams(t.params));case"input.performActions":return await s(this,_s).performActions(s(this,N).parsePerformActionsParams(t.params));case"input.releaseActions":return await s(this,_s).releaseActions(s(this,N).parseReleaseActionsParams(t.params));case"input.setFiles":return await s(this,_s).setFiles(s(this,N).parseSetFilesParams(t.params));case"network.addIntercept":return await s(this,Me).addIntercept(s(this,N).parseAddInterceptParams(t.params));case"network.continueRequest":return await s(this,Me).continueRequest(s(this,N).parseContinueRequestParams(t.params));case"network.continueResponse":return await s(this,Me).continueResponse(s(this,N).parseContinueResponseParams(t.params));case"network.continueWithAuth":return await s(this,Me).continueWithAuth(s(this,N).parseContinueWithAuthParams(t.params));case"network.failRequest":return await s(this,Me).failRequest(s(this,N).parseFailRequestParams(t.params));case"network.provideResponse":return await s(this,Me).provideResponse(s(this,N).parseProvideResponseParams(t.params));case"network.removeIntercept":return await s(this,Me).removeIntercept(s(this,N).parseRemoveInterceptParams(t.params));case"permissions.setPermission":return await s(this,Qi).setPermissions(s(this,N).parseSetPermissionsParams(t.params));case"script.addPreloadScript":return await s(this,Ze).addPreloadScript(s(this,N).parseAddPreloadScriptParams(t.params));case"script.callFunction":return await s(this,Ze).callFunction(s(this,N).parseCallFunctionParams(t.params));case"script.disown":return await s(this,Ze).disown(s(this,N).parseDisownParams(t.params));case"script.evaluate":return await s(this,Ze).evaluate(s(this,N).parseEvaluateParams(t.params));case"script.getRealms":return s(this,Ze).getRealms(s(this,N).parseGetRealmsParams(t.params));case"script.removePreloadScript":return await s(this,Ze).removePreloadScript(s(this,N).parseRemovePreloadScriptParams(t.params));case"session.status":return s(this,ks).status();case"session.subscribe":return s(this,ks).subscribe(s(this,N).parseSubscribeParams(t.params),t.channel);case"session.unsubscribe":return s(this,ks).unsubscribe(s(this,N).parseSubscribeParams(t.params),t.channel);case"storage.deleteCookies":throw new Mn.UnsupportedOperationException(`${t.method} is not supported yet`);case"storage.getCookies":return await s(this,Xr).getCookies(s(this,N).parseGetCookiesParams(t.params));case"storage.setCookie":return await s(this,Xr).setCookie(s(this,N).parseSetCookieParams(t.params))}throw new Mn.UnknownCommandException(`Unknown command '${t.method}'.`)};Cu.CommandProcessor=Iw;var zu={};Object.defineProperty(zu,"__esModule",{value:!0});zu.BrowsingContextStorage=void 0;const Rw=B;var et;class Tw{constructor(){u(this,et,new Map)}getTopLevelContexts(){return this.getAllContexts().filter(e=>e.isTopLevelContext())}getAllContexts(){return Array.from(s(this,et).values())}deleteContextById(e){s(this,et).delete(e)}deleteContext(e){s(this,et).delete(e.id)}addContext(e){s(this,et).set(e.id,e)}hasContext(e){return s(this,et).has(e)}findContext(e){return s(this,et).get(e)}findTopLevelContextId(e){if(e===null)return null;const t=this.findContext(e),r=(t==null?void 0:t.parentId)??null;return r===null?e:this.findTopLevelContextId(r)}findContextBySession(e){for(const t of s(this,et).values())if(t.cdpTarget.cdpSessionId===e)return t}getContext(e){const t=this.findContext(e);if(t===void 0)throw new Rw.NoSuchFrameException(`Context ${e} not found`);return t}}et=new WeakMap;zu.BrowsingContextStorage=Tw;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.RealmStorage=void 0;const Dw=B,Ow=ia;var Bc,Jr;class Nw{constructor(){u(this,Bc,new Map);u(this,Jr,new Map)}get knownHandlesToRealmMap(){return s(this,Bc)}addRealm(e){s(this,Jr).set(e.realmId,e)}findRealms(e){return Array.from(s(this,Jr).values()).filter(t=>!(e.realmId!==void 0&&e.realmId!==t.realmId||e.browsingContextId!==void 0&&!t.associatedBrowsingContexts.map(r=>r.id).includes(e.browsingContextId)||e.sandbox!==void 0&&(!(t instanceof Ow.WindowRealm)||e.sandbox!==t.sandbox)||e.executionContextId!==void 0&&e.executionContextId!==t.executionContextId||e.origin!==void 0&&e.origin!==t.origin||e.type!==void 0&&e.type!==t.realmType||e.cdpSessionId!==void 0&&e.cdpSessionId!==t.cdpClient.sessionId))}findRealm(e){const t=this.findRealms(e);if(t.length===1)return t[0]}getRealm(e){const t=this.findRealm(e);if(t===void 0)throw new Dw.NoSuchFrameException(`Realm ${JSON.stringify(e)} not found`);return t}deleteRealms(e){this.findRealms(e).map(t=>{t.dispose(),s(this,Jr).delete(t.realmId),Array.from(this.knownHandlesToRealmMap.entries()).filter(([,r])=>r===t.realmId).map(([r])=>this.knownHandlesToRealmMap.delete(r))})}}Bc=new WeakMap,Jr=new WeakMap;Wu.RealmStorage=Nw;var Vu={},Gu={};Object.defineProperty(Gu,"__esModule",{value:!0});Gu.Buffer=void 0;var eo,Is,to,nh;let Mw=(nh=class{constructor(e,t){u(this,eo,void 0);u(this,Is,[]);u(this,to,void 0);h(this,eo,e),h(this,to,t)}get(){return s(this,Is)}add(e){var t;for(s(this,Is).push(e);s(this,Is).length>s(this,eo);){const r=s(this,Is).shift();r!==void 0&&((t=s(this,to))==null||t.call(this,r))}}},eo=new WeakMap,Is=new WeakMap,to=new WeakMap,nh);Gu.Buffer=Mw;var Xu={};Object.defineProperty(Xu,"__esModule",{value:!0});Xu.DefaultMap=void 0;var so;class Fw extends Map{constructor(t,r){super(r);u(this,so,void 0);h(this,so,t)}get(t){return this.has(t)||this.set(t,s(this,so).call(this,t)),super.get(t)}}so=new WeakMap;Xu.DefaultMap=Fw;var Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.IdWrapper=void 0;var Ac,ro;const $c=class $c{constructor(){u(this,ro,void 0);h(this,ro,++ed($c,Ac)._)}get id(){return s(this,ro)}};Ac=new WeakMap,ro=new WeakMap,u($c,Ac,0);let Zd=$c;Ju.IdWrapper=Zd;var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.assertSupportedEvent=Hs.isCdpEvent=void 0;const el=B;function Op(n){var e;return((e=n.split(".").at(0))==null?void 0:e.startsWith(el.ChromiumBidi.BiDiModule.Cdp))??!1}Hs.isCdpEvent=Op;function jw(n){if(!el.ChromiumBidi.EVENT_NAMES.has(n)&&!Op(n))throw new el.InvalidArgumentException(`Unknown event: ${n}`)}Hs.assertSupportedEvent=jw;var ts={};Object.defineProperty(ts,"__esModule",{value:!0});ts.SubscriptionManager=ts.unrollEvents=ts.cartesianProduct=void 0;const G=B,Bw=Hs;function Np(...n){return n.reduce((e,t)=>e.flatMap(r=>t.map(i=>[r,i].flat())))}ts.cartesianProduct=Np;function Mp(n){const e=new Set;function t(r){for(const i of r)e.add(i)}for(const r of n)switch(r){case G.ChromiumBidi.BiDiModule.BrowsingContext:t(Object.values(G.ChromiumBidi.BrowsingContext.EventNames));break;case G.ChromiumBidi.BiDiModule.Log:t(Object.values(G.ChromiumBidi.Log.EventNames));break;case G.ChromiumBidi.BiDiModule.Network:t(Object.values(G.ChromiumBidi.Network.EventNames));break;case G.ChromiumBidi.BiDiModule.Script:t(Object.values(G.ChromiumBidi.Script.EventNames));break;default:e.add(r)}return[...e.values()]}ts.unrollEvents=Mp;var Uc,Fe,Vt,Lc,Fp,qc,jp;class Aw{constructor(e){u(this,Lc);u(this,qc);u(this,Uc,0);u(this,Fe,new Map);u(this,Vt,void 0);h(this,Vt,e)}getChannelsSubscribedToEvent(e,t){return Array.from(s(this,Fe).keys()).map(i=>({priority:f(this,Lc,Fp).call(this,e,t,i),channel:i})).filter(({priority:i})=>i!==null).sort((i,o)=>i.priority-o.priority).map(({channel:i})=>i)}subscribe(e,t,r){switch(t=s(this,Vt).findTopLevelContextId(t),e){case G.ChromiumBidi.BiDiModule.BrowsingContext:Object.values(G.ChromiumBidi.BrowsingContext.EventNames).map(a=>this.subscribe(a,t,r));return;case G.ChromiumBidi.BiDiModule.Log:Object.values(G.ChromiumBidi.Log.EventNames).map(a=>this.subscribe(a,t,r));return;case G.ChromiumBidi.BiDiModule.Network:Object.values(G.ChromiumBidi.Network.EventNames).map(a=>this.subscribe(a,t,r));return;case G.ChromiumBidi.BiDiModule.Script:Object.values(G.ChromiumBidi.Script.EventNames).map(a=>this.subscribe(a,t,r));return}s(this,Fe).has(r)||s(this,Fe).set(r,new Map);const i=s(this,Fe).get(r);i.has(t)||i.set(t,new Map);const o=i.get(t);o.has(e)||o.set(e,ed(this,Uc)._++)}unsubscribeAll(e,t,r){for(const o of t)o!==null&&s(this,Vt).getContext(o);Np(Mp(e),t).map(([o,a])=>f(this,qc,jp).call(this,o,a,r)).forEach(o=>o())}unsubscribe(e,t,r){this.unsubscribeAll([e],[t],r)}}Uc=new WeakMap,Fe=new WeakMap,Vt=new WeakMap,Lc=new WeakSet,Fp=function(e,t,r){const i=s(this,Fe).get(r);if(i===void 0)return null;const o=s(this,Vt).findTopLevelContextId(t),c=[...new Set([null,o])].map(l=>{var g,m;const p=(g=i.get(l))==null?void 0:g.get(e);if((0,Bw.isCdpEvent)(e)){const x=(m=i.get(l))==null?void 0:m.get(G.ChromiumBidi.BiDiModule.Cdp);return p&&x?Math.min(p,x):p??x}return p}).filter(l=>l!==void 0);return c.length===0?null:Math.min(...c)},qc=new WeakSet,jp=function(e,t,r){if(t=s(this,Vt).findTopLevelContextId(t),!s(this,Fe).has(r))throw new G.InvalidArgumentException(`Cannot unsubscribe from ${e}, ${t===null?"null":t}. No subscription found.`);const i=s(this,Fe).get(r);if(!i.has(t))throw new G.InvalidArgumentException(`Cannot unsubscribe from ${e}, ${t===null?"null":t}. No subscription found.`);const o=i.get(t);if(!o.has(e))throw new G.InvalidArgumentException(`Cannot unsubscribe from ${e}, ${t===null?"null":t}. No subscription found.`);return()=>{o.delete(e),o.size===0&&i.delete(e),i.size===0&&s(this,Fe).delete(r)}};ts.SubscriptionManager=Aw;Object.defineProperty(Vu,"__esModule",{value:!0});Vu.EventManager=void 0;const $w=B,Uw=Gu,Lw=Xu,qw=zs,Kw=Ju,Vl=Rn,Gl=Hs,Hw=ts;var Kc,no,io;class zw{constructor(e,t){u(this,Kc,new Kw.IdWrapper);u(this,no,void 0);u(this,io,void 0);h(this,io,e),h(this,no,t)}get id(){return s(this,Kc).id}get contextId(){return s(this,no)}get event(){return s(this,io)}}Kc=new WeakMap,no=new WeakMap,io=new WeakMap;const ud=new Map([[$w.ChromiumBidi.Log.EventNames.LogEntryAdded,100]]);var oo,Rs,Yr,Ts,Qr,Ds,qn,Hc,Bp,ao,sl,co,rl;const os=class os extends qw.EventEmitter{constructor(t){super();u(this,Hc);u(this,ao);u(this,co);u(this,oo,new Lw.DefaultMap(()=>new Set));u(this,Rs,new Map);u(this,Yr,new Map);u(this,Ts,void 0);u(this,Qr,void 0);h(this,Qr,t),h(this,Ts,new Hw.SubscriptionManager(t))}registerEvent(t,r){this.registerPromiseEvent(Promise.resolve({kind:"success",value:t}),r,t.method)}registerPromiseEvent(t,r,i){const o=new zw(t,r),a=s(this,Ts).getChannelsSubscribedToEvent(i,r);f(this,Hc,Bp).call(this,o,i);for(const c of a)this.emit("event",{message:Vl.OutgoingMessage.createFromPromise(t,c),event:i}),f(this,ao,sl).call(this,o,c,i)}subscribe(t,r,i){for(const o of t)(0,Gl.assertSupportedEvent)(o);for(const o of r)o!==null&&s(this,Qr).getContext(o);for(const o of t)for(const a of r){s(this,Ts).subscribe(o,a,i);for(const c of f(this,co,rl).call(this,o,a,i))this.emit("event",{message:Vl.OutgoingMessage.createFromPromise(c.event,i),event:o}),f(this,ao,sl).call(this,c,i,o)}}unsubscribe(t,r,i){for(const o of t)(0,Gl.assertSupportedEvent)(o);s(this,Ts).unsubscribeAll(t,r,i)}};oo=new WeakMap,Rs=new WeakMap,Yr=new WeakMap,Ts=new WeakMap,Qr=new WeakMap,Ds=new WeakSet,qn=function(t,r,i){return JSON.stringify({eventName:t,browsingContext:r,channel:i})},Hc=new WeakSet,Bp=function(t,r){var o;if(!ud.has(r))return;const i=f(o=os,Ds,qn).call(o,r,t.contextId);s(this,Rs).has(i)||s(this,Rs).set(i,new Uw.Buffer(ud.get(r))),s(this,Rs).get(i).add(t),s(this,oo).get(r).add(t.contextId)},ao=new WeakSet,sl=function(t,r,i){var a;if(!ud.has(i))return;const o=f(a=os,Ds,qn).call(a,i,t.contextId,r);s(this,Yr).set(o,Math.max(s(this,Yr).get(o)??0,t.id))},co=new WeakSet,rl=function(t,r,i){var p,g,m;const o=f(p=os,Ds,qn).call(p,t,r),a=f(g=os,Ds,qn).call(g,t,r,i),c=s(this,Yr).get(a)??-1/0,l=((m=s(this,Rs).get(o))==null?void 0:m.get().filter(x=>x.id>c))??[];return r===null&&Array.from(s(this,oo).get(t).keys()).filter(x=>x!==null&&s(this,Qr).hasContext(x)).map(x=>f(this,co,rl).call(this,t,x,i)).forEach(x=>l.push(...x)),l.sort((x,C)=>x.id-C.id)},u(os,Ds);let tl=os;Vu.EventManager=tl;Object.defineProperty(bu,"__esModule",{value:!0});bu.BidiServer=void 0;const Ww=zs,Vw=Re,Gw=xu,Xw=Cu,Jw=zu,Yw=Wu,Qw=Vu;var uo,Os,Zr,en,tn,Ns,zc,Wc,Vc,Ap;const kl=class kl extends Ww.EventEmitter{constructor(t,r,i,o,a,c,l,p){super();u(this,Vc);u(this,uo,void 0);u(this,Os,void 0);u(this,Zr,void 0);u(this,en,void 0);u(this,tn,new Jw.BrowsingContextStorage);u(this,Ns,void 0);u(this,zc,t=>{s(this,Zr).processCommand(t).catch(r=>{var i;(i=s(this,Ns))==null||i.call(this,Vw.LogType.debugError,r)})});u(this,Wc,async t=>{const r=t.message;t.channel!==null&&(r.channel=t.channel),await s(this,Os).sendMessage(r)});h(this,Ns,p),h(this,uo,new Gw.ProcessingQueue(s(this,Wc),s(this,Ns))),h(this,Os,t),s(this,Os).setOnMessage(s(this,zc)),h(this,en,new Qw.EventManager(s(this,tn))),h(this,Zr,new Xw.CommandProcessor(r,i,s(this,en),o,a,s(this,tn),new Yw.RealmStorage,(c==null?void 0:c.acceptInsecureCerts)??!1,(c==null?void 0:c.sharedIdWithFrame)??!1,l,s(this,Ns))),s(this,en).on("event",({message:g,event:m})=>{this.emitOutgoingMessage(g,m)}),s(this,Zr).on("response",({message:g,event:m})=>{this.emitOutgoingMessage(g,m)})}static async createAndStart(t,r,i,o,a,c,l){var C;const[{browserContextIds:p},{targetInfos:g}]=await Promise.all([i.sendCommand("Target.getBrowserContexts"),i.sendCommand("Target.getTargets")]);let m="default";for(const v of g)if(v.browserContextId&&!p.includes(v.browserContextId)){m=v.browserContextId;break}const x=new kl(t,r,i,o,m,a,c,l);return await i.sendCommand("Target.setDiscoverTargets",{discover:!0}),await i.sendCommand("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),await f(C=x,Vc,Ap).call(C),x}emitOutgoingMessage(t,r){s(this,uo).add(t,r)}close(){s(this,Os).close()}};uo=new WeakMap,Os=new WeakMap,Zr=new WeakMap,en=new WeakMap,tn=new WeakMap,Ns=new WeakMap,zc=new WeakMap,Wc=new WeakMap,Vc=new WeakSet,Ap=async function(){await Promise.all(s(this,tn).getTopLevelContexts().map(t=>t.lifecycleLoaded()))};let nl=kl;bu.BidiServer=nl;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OutgoingMessage=n.EventEmitter=n.BidiServer=void 0;var e=bu;Object.defineProperty(n,"BidiServer",{enumerable:!0,get:function(){return e.BidiServer}});var t=zs;Object.defineProperty(n,"EventEmitter",{enumerable:!0,get:function(){return t.EventEmitter}});var r=Rn;Object.defineProperty(n,"OutgoingMessage",{enumerable:!0,get:function(){return r.OutgoingMessage}})})(vu);/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class he{static deserializeNumber(e){switch(e){case"-0":return-0;case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:return e}}static deserializeLocalValue(e){var t,r,i,o;switch(e.type){case"array":return(t=e.value)==null?void 0:t.map(a=>he.deserializeLocalValue(a));case"set":return(r=e.value)==null?void 0:r.reduce((a,c)=>a.add(he.deserializeLocalValue(c)),new Set);case"object":return(i=e.value)==null?void 0:i.reduce((a,c)=>{const{key:l,value:p}=he.deserializeTuple(c);return a[l]=p,a},{});case"map":return(o=e.value)==null?void 0:o.reduce((a,c)=>{const{key:l,value:p}=he.deserializeTuple(c);return a.set(l,p)},new Map);case"promise":return{};case"regexp":return new RegExp(e.value.pattern,e.value.flags);case"date":return new Date(e.value);case"undefined":return;case"null":return null;case"number":return he.deserializeNumber(e.value);case"bigint":return BigInt(e.value);case"boolean":return!!e.value;case"string":return e.value}d.debugError(`Deserialization of type ${e.type} not supported.`)}static deserializeTuple([e,t]){const r=typeof e=="string"?e:he.deserializeLocalValue(e),i=he.deserializeLocalValue(t);return{key:r,value:i}}static deserialize(e){if(!e){d.debugError("Service did not produce a result.");return}return he.deserializeLocalValue(e)}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */async function Zw(n,e){e.handle&&await n.connection.send("script.disown",{target:n.target,handles:[e.handle]}).catch(t=>{d.debugError(t)})}function ey(n){if(n.exception.type!=="error")return he.deserialize(n.exception);const[e="",...t]=n.text.split(": "),r=t.join(": "),i=new Error(r);i.name=e;const o=[];if(n.stackTrace&&o.length<Error.stackTraceLimit)for(const a of n.stackTrace.callFrames.reverse()){if(d.PuppeteerURL.isPuppeteerURL(a.url)&&a.url!==d.PuppeteerURL.INTERNAL_URL){const c=d.PuppeteerURL.parse(a.url);o.unshift(`    at ${a.functionName||c.functionName} (${c.functionName} at ${c.siteString}, <anonymous>:${a.lineNumber}:${a.columnNumber})`)}else o.push(`    at ${a.functionName||"<anonymous>"} (${a.url}:${a.lineNumber}:${a.columnNumber})`);if(o.length>=Error.stackTraceLimit)break}return i.stack=[n.text,...o].join(`
`),i}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var sn,lo,ke;class Yu extends d.JSHandle{constructor(t,r){super();u(this,sn,!1);u(this,lo,void 0);u(this,ke,void 0);h(this,lo,t),h(this,ke,r)}context(){return this.realm.environment.context()}get realm(){return s(this,lo)}get disposed(){return s(this,sn)}async jsonValue(){return await this.evaluate(t=>t)}asElement(){return null}async dispose(){s(this,sn)||(h(this,sn,!0),"handle"in s(this,ke)&&await Zw(this.context(),s(this,ke)))}get isPrimitiveValue(){switch(s(this,ke).type){case"string":case"number":case"bigint":case"boolean":case"undefined":case"null":return!0;default:return!1}}toString(){return this.isPrimitiveValue?"JSHandle:"+he.deserialize(s(this,ke)):"JSHandle@"+s(this,ke).type}get id(){return"handle"in s(this,ke)?s(this,ke).handle:void 0}remoteValue(){return s(this,ke)}remoteObject(){throw new d.UnsupportedOperation("Not available in WebDriver BiDi")}}sn=new WeakMap,lo=new WeakMap,ke=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var ty=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},Xl=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0},sy=globalThis&&globalThis.__addDisposableResource||function(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose]}if(typeof r!="function")throw new TypeError("Object not disposable.");n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e},ry=globalThis&&globalThis.__disposeResources||function(n){return function(e){function t(i){e.error=e.hasError?new n(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}function r(){for(;e.stack.length;){var i=e.stack.pop();try{var o=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(o).then(r,function(a){return t(a),r()})}catch(a){t(a)}}if(e.hasError)throw e.error}return r()}}(typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r});let ca=(()=>{var o;var n;let e=d.ElementHandle,t=[],r,i;return o=class extends e{constructor(c,l){super(new Yu(c,l)),ty(this,t)}get realm(){return this.handle.realm}get frame(){return this.realm.environment}context(){return this.handle.context()}get isPrimitiveValue(){return this.handle.isPrimitiveValue}remoteValue(){return this.handle.remoteValue()}async autofill(c){const l=this.frame.client,g=(await l.send("DOM.describeNode",{objectId:this.handle.id})).node.backendNodeId,m=this.frame._id;await l.send("Autofill.trigger",{fieldId:g,frameId:m,card:c.creditCard})}async contentFrame(){const c={stack:[],error:void 0,hasError:!1};try{const p=sy(c,await this.evaluateHandle(g=>{if(g instanceof HTMLIFrameElement)return g.contentWindow}),!1).remoteValue();return p.type==="window"?this.frame.page().frame(p.value.context):null}catch(l){c.error=l,c.hasError=!0}finally{ry(c)}}uploadFile(){throw new d.UnsupportedOperation}},(()=>{const c=typeof Symbol=="function"&&Symbol.metadata?Object.create(e[Symbol.metadata]??null):void 0;r=[d.throwIfDisposed()],i=[d.throwIfDisposed(),(n=d.ElementHandle).bindIsolatedHandle.bind(n)],Xl(o,null,r,{kind:"method",name:"autofill",static:!1,private:!1,access:{has:l=>"autofill"in l,get:l=>l.autofill},metadata:c},null,t),Xl(o,null,i,{kind:"method",name:"contentFrame",static:!1,private:!1,access:{has:l=>"contentFrame"in l,get:l=>l.contentFrame},metadata:c},null,t),c&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:c})})(),o})();/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Jl extends Error{}class be{static serializeNumber(e){let t;return Object.is(e,-0)?t="-0":Object.is(e,1/0)?t="Infinity":Object.is(e,-1/0)?t="-Infinity":Object.is(e,NaN)?t="NaN":t=e,{type:"number",value:t}}static serializeObject(e){if(e===null)return{type:"null"};if(Array.isArray(e))return{type:"array",value:e.map(r=>be.serializeRemoteValue(r))};if(d.isPlainObject(e)){try{JSON.stringify(e)}catch(r){throw r instanceof TypeError&&r.message.startsWith("Converting circular structure to JSON")&&(r.message+=" Recursive objects are not allowed."),r}const t=[];for(const r in e)t.push([be.serializeRemoteValue(r),be.serializeRemoteValue(e[r])]);return{type:"object",value:t}}else{if(d.isRegExp(e))return{type:"regexp",value:{pattern:e.source,flags:e.flags}};if(d.isDate(e))return{type:"date",value:e.toISOString()}}throw new Jl("Custom object sterilization not possible. Use plain objects instead.")}static serializeRemoteValue(e){switch(typeof e){case"symbol":case"function":throw new Jl(`Unable to serializable ${typeof e}`);case"object":return be.serializeObject(e);case"undefined":return{type:"undefined"};case"number":return be.serializeNumber(e);case"bigint":return{type:"bigint",value:e.toString()};case"string":return{type:"string",value:e};case"boolean":return{type:"boolean",value:e}}}static async serialize(e,t){t instanceof d.LazyArg&&(t=await t.get(e.realm));const r=t&&(t instanceof Yu||t instanceof ca)?t:null;if(r){if(r.realm.environment.context()!==e.environment.context())throw new Error("JSHandles can be evaluated only in the context they were created!");if(r.disposed)throw new Error("JSHandle is disposed!");return r.remoteValue()}return be.serializeRemoteValue(t)}}/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var ho,je,po,ol;class il extends d.EventEmitter{constructor(t){super();u(this,po);I(this,"connection");u(this,ho,void 0);u(this,je,void 0);I(this,"handleRealmDestroyed",async t=>{t.realm===s(this,ho)&&(this.internalPuppeteerUtil=void 0,s(this,je).environment.clearDocumentHandle())});I(this,"handleRealmCreated",t=>{t.type==="window"&&t.context===s(this,je).environment._id&&t.sandbox===s(this,je).name&&(h(this,ho,t.realm),s(this,je).taskManager.rerunAll())});I(this,"internalPuppeteerUtil");this.connection=t}get target(){return{context:s(this,je).environment._id,sandbox:s(this,je).name}}setSandbox(t){h(this,je,t),this.connection.on(B.ChromiumBidi.Script.EventNames.RealmCreated,this.handleRealmCreated),this.connection.on(B.ChromiumBidi.Script.EventNames.RealmDestroyed,this.handleRealmDestroyed)}get puppeteerUtil(){const t=Promise.resolve();return d.scriptInjector.inject(r=>{this.internalPuppeteerUtil&&this.internalPuppeteerUtil.then(i=>{i.dispose()}),this.internalPuppeteerUtil=t.then(()=>this.evaluateHandle(r))},!this.internalPuppeteerUtil),this.internalPuppeteerUtil}async evaluateHandle(t,...r){return await f(this,po,ol).call(this,!1,t,...r)}async evaluate(t,...r){return await f(this,po,ol).call(this,!0,t,...r)}[d.disposeSymbol](){this.connection.off(B.ChromiumBidi.Script.EventNames.RealmCreated,this.handleRealmCreated),this.connection.off(B.ChromiumBidi.Script.EventNames.RealmDestroyed,this.handleRealmDestroyed)}}ho=new WeakMap,je=new WeakMap,po=new WeakSet,ol=async function(t,r,...i){var m;const o=d.getSourceUrlComment(((m=d.getSourcePuppeteerURLIfAvailable(r))==null?void 0:m.toString())??d.PuppeteerURL.INTERNAL_URL),a=s(this,je);let c;const l=t?"none":"root",p=t?{}:{maxObjectDepth:0,maxDomDepth:0};if(d.isString(r)){const x=d.SOURCE_URL_REGEX.test(r)?r:`${r}
${o}
`;c=this.connection.send("script.evaluate",{expression:x,target:this.target,resultOwnership:l,awaitPromise:!0,userActivation:!0,serializationOptions:p})}else{let x=d.stringifyFunction(r);x=d.SOURCE_URL_REGEX.test(x)?x:`${x}
${o}
`,c=this.connection.send("script.callFunction",{functionDeclaration:x,arguments:i.length?await Promise.all(i.map(C=>be.serialize(a,C))):[],target:this.target,resultOwnership:l,awaitPromise:!0,userActivation:!0,serializationOptions:p})}const{result:g}=await c;if("type"in g&&g.type==="exception")throw ey(g.exceptionDetails);return t?he.deserialize(g.result):Ra(a,g.result)};function Ra(n,e){return e.type==="node"||e.type==="window"?new ca(n,e):new Yu(n,e)}const zn=new Map;var ft,Gt,rn;class Qu extends d.CDPSession{constructor(t,r){super();u(this,ft,void 0);u(this,Gt,d.Deferred.create());u(this,rn,!1);h(this,ft,t),s(this,ft).supportsCdp()&&(r?(s(this,Gt).resolve(r),zn.set(r,this)):t.connection.send("cdp.getSession",{context:t.id}).then(i=>{s(this,Gt).resolve(i.result.session),zn.set(i.result.session,this)}).catch(i=>{s(this,Gt).reject(i)}))}connection(){}async send(t,...r){if(!s(this,ft).supportsCdp())throw new d.UnsupportedOperation("CDP support is required for this feature. The current browser does not support CDP.");if(s(this,rn))throw new d.TargetCloseError(`Protocol error (${t}): Session closed. Most likely the page has been closed.`);const i=await s(this,Gt).valueOrThrow(),{result:o}=await s(this,ft).connection.send("cdp.sendCommand",{method:t,params:r[0],session:i});return o.result}async detach(){zn.delete(this.id()),!s(this,rn)&&s(this,ft).supportsCdp()&&await s(this,ft).cdpSession.send("Target.detachFromTarget",{sessionId:this.id()}),h(this,rn,!0)}id(){const t=s(this,Gt).value();return t instanceof Error||t===void 0?"":t}}ft=new WeakMap,Gt=new WeakMap,rn=new WeakMap;exports.BrowsingContextEvent=void 0;(function(n){n.Created=Symbol("BrowsingContext.created"),n.Destroyed=Symbol("BrowsingContext.destroyed")})(exports.BrowsingContextEvent||(exports.BrowsingContextEvent={}));var nn,on,Ms,fo,mo,an,Ea,ih;let $p=(ih=class extends il{constructor(t,r,i){super(t);u(this,an);u(this,nn,void 0);u(this,on,void 0);u(this,Ms,void 0);u(this,fo,void 0);u(this,mo,"");h(this,nn,r.context),h(this,on,r.url),h(this,fo,r.parent),h(this,mo,i),h(this,Ms,new Qu(this,void 0)),this.on("browsingContext.domContentLoaded",f(this,an,Ea).bind(this)),this.on("browsingContext.fragmentNavigated",f(this,an,Ea).bind(this)),this.on("browsingContext.load",f(this,an,Ea).bind(this))}supportsCdp(){return!s(this,mo).toLowerCase().includes("firefox")}createRealmForSandbox(){return new il(this.connection)}get url(){return s(this,on)}get id(){return s(this,nn)}get parent(){return s(this,fo)}get cdpSession(){return s(this,Ms)}async sendCdpCommand(t,...r){return await s(this,Ms).send(t,...r)}dispose(){this.removeAllListeners(),this.connection.unregisterBrowsingContexts(s(this,nn)),s(this,Ms).detach().catch(d.debugError)}},nn=new WeakMap,on=new WeakMap,Ms=new WeakMap,fo=new WeakMap,mo=new WeakMap,an=new WeakSet,Ea=function(t){h(this,on,t.url)},ih);/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const ny=d.debug("puppeteer:webDriverBiDi:SEND ►"),iy=d.debug("puppeteer:webDriverBiDi:RECV ◀");var go,tt,cn,wo,Fs,mt,Be,yo,Gc,Lp;class Up extends d.EventEmitter{constructor(t,r,i=0,o){super();u(this,Gc);u(this,go,void 0);u(this,tt,void 0);u(this,cn,void 0);u(this,wo,0);u(this,Fs,!1);u(this,mt,new d.CallbackRegistry);u(this,Be,new Map);u(this,yo,[]);h(this,go,t),h(this,cn,i),h(this,wo,o??18e4),h(this,tt,r),s(this,tt).onmessage=this.onMessage.bind(this),s(this,tt).onclose=this.unbind.bind(this)}get closed(){return s(this,Fs)}get url(){return s(this,go)}pipeTo(t){s(this,yo).push(t)}emit(t,r){for(const i of s(this,yo))i.emit(t,r);return super.emit(t,r)}send(t,r){return d.assert(!s(this,Fs),"Protocol error: Connection closed."),s(this,mt).create(t,s(this,wo),i=>{const o=JSON.stringify({id:i,method:t,params:r});ny(o),s(this,tt).send(o)})}async onMessage(t){var i;s(this,cn)&&await new Promise(o=>setTimeout(o,s(this,cn))),iy(t);const r=JSON.parse(t);if("type"in r)switch(r.type){case"success":s(this,mt).resolve(r.id,r);return;case"error":if(r.id===null)break;s(this,mt).reject(r.id,oy(r),r.message);return;case"event":if(ay(r)){(i=zn.get(r.params.session))==null||i.emit(r.params.event,r.params.params);return}f(this,Gc,Lp).call(this,r),this.emit(r.method,r.params);return}"id"in r&&s(this,mt).reject(r.id,`Protocol Error. Message is not in BiDi protocol format: '${t}'`,r.message),d.debugError(r)}registerBrowsingContexts(t){s(this,Be).set(t.id,t)}getBrowsingContext(t){const r=s(this,Be).get(t);if(!r)throw new Error(`BrowsingContext ${t} does not exist.`);return r}getTopLevelContext(t){let r=s(this,Be).get(t);if(!r)throw new Error(`BrowsingContext ${t} does not exist.`);for(;r.parent;)if(t=r.parent,r=s(this,Be).get(t),!r)throw new Error(`BrowsingContext ${t} does not exist.`);return r}unregisterBrowsingContexts(t){s(this,Be).delete(t)}unbind(){s(this,Fs)||(h(this,Fs,!0),s(this,tt).onmessage=()=>{},s(this,tt).onclose=()=>{},s(this,Be).clear(),s(this,mt).clear())}dispose(){this.unbind(),s(this,tt).close()}getPendingProtocolErrors(){return s(this,mt).getPendingProtocolErrors()}}go=new WeakMap,tt=new WeakMap,cn=new WeakMap,wo=new WeakMap,Fs=new WeakMap,mt=new WeakMap,Be=new WeakMap,yo=new WeakMap,Gc=new WeakSet,Lp=function(t){let r;"context"in t.params&&t.params.context!==null?r=s(this,Be).get(t.params.context):"source"in t.params&&t.params.source.context!==void 0&&(r=s(this,Be).get(t.params.source.context)),r==null||r.emit(t.method,t.params)};function oy(n){let e=`${n.error} ${n.message}`;return n.stacktrace&&(e+=` ${n.stacktrace}`),e}function ay(n){return n.method.startsWith("cdp.")}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const cy=(n,...e)=>{d.debug(`bidi:${n}`)(e)};async function uy(n,e){const t=new ly,r=new dy(n),i={send(c){t.emitMessage(JSON.parse(c))},close(){a.close(),r.close(),n.dispose()},onmessage(c){}};t.on("bidiResponse",c=>{i.onmessage(JSON.stringify(c))});const o=new Up(n.url(),i),a=await vu.BidiServer.createAndStart(t,r,r.browserClient(),"",e,void 0,cy);return o}var vo,js,Bs;class dy{constructor(e){u(this,vo,void 0);u(this,js,new Map);u(this,Bs,void 0);h(this,vo,e),h(this,Bs,new Yl(e))}browserClient(){return s(this,Bs)}getCdpClient(e){const t=s(this,vo).session(e);if(!t)throw new Error(`Unknown CDP session with id ${e}`);if(!s(this,js).has(t)){const r=new Yl(t,e,s(this,Bs));return s(this,js).set(t,r),r}return s(this,js).get(t)}close(){s(this,Bs).close();for(const e of s(this,js).values())e.close()}}vo=new WeakMap,js=new WeakMap,Bs=new WeakMap;var un,As,bo,xo;class Yl extends vu.EventEmitter{constructor(t,r,i){super();u(this,un,!1);u(this,As,void 0);I(this,"sessionId");u(this,bo,void 0);u(this,xo,(t,r)=>{this.emit(t,r)});h(this,As,t),this.sessionId=r,h(this,bo,i),s(this,As).on("*",s(this,xo))}browserClient(){return s(this,bo)}async sendCommand(t,...r){if(!s(this,un))try{return await s(this,As).send(t,...r)}catch(i){if(s(this,un))return;throw i}}close(){s(this,As).off("*",s(this,xo)),h(this,un,!0)}isCloseError(t){return t instanceof d.TargetCloseError}}un=new WeakMap,As=new WeakMap,bo=new WeakMap,xo=new WeakMap;var dn;class ly extends vu.EventEmitter{constructor(){super(...arguments);u(this,dn,async t=>{})}emitMessage(t){s(this,dn).call(this,t)}setOnMessage(t){h(this,dn,t)}async sendMessage(t){this.emit("bidiResponse",t)}close(){h(this,dn,async t=>{})}}dn=new WeakMap;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var hy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},py=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let fy=(()=>{var r,i,o,a,c,qp,p,Kp,m;let n=d.EventEmitter,e=[],t;return m=class extends n{constructor(v){super();u(this,c);u(this,p);u(this,r,(hy(this,e),void 0));u(this,i,void 0);u(this,o,new d.DisposableStack);u(this,a,new d.Deferred);h(this,i,v)}static from(v){var y;const w=new m(v);return f(y=w,c,qp).call(y),w}get disposed(){return s(this,o).disposed}get request(){return s(this,r)}dispose(){this[d.disposeSymbol]()}[(t=[d.inertIfDisposed],d.disposeSymbol)](){s(this,o).dispose(),super[d.disposeSymbol]()}},r=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakSet,qp=function(){s(this,o).use(new d.EventEmitter(s(this,i))).once("closed",()=>{this.emit("failed",{url:s(this,i).url,timestamp:new Date}),this.dispose()}),s(this,i).on("request",({request:y})=>{y.navigation===s(this,a).value()&&(h(this,r,y),this.emit("request",y))});const w=s(this,o).use(new d.EventEmitter(s(this,p,Kp)));for(const y of["browsingContext.domContentLoaded","browsingContext.load"])w.on(y,b=>{b.context===s(this,i).id&&b.navigation&&(s(this,a).resolved()||s(this,a).resolve(b.navigation))});for(const[y,b]of[["browsingContext.fragmentNavigated","fragment"],["browsingContext.navigationFailed","failed"],["browsingContext.navigationAborted","aborted"]])w.on(y,E=>{E.context===s(this,i).id&&E.navigation&&(s(this,a).resolved()||s(this,a).resolve(E.navigation),s(this,a).value()===E.navigation&&(this.emit(b,{url:E.url,timestamp:new Date(E.timestamp)}),this.dispose()))})},p=new WeakSet,Kp=function(){return s(this,i).userContext.browser.session},(()=>{const v=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;py(m,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:w=>"dispose"in w,get:w=>w.dispose},metadata:v},null,e),v&&Object.defineProperty(m,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:v})})(),m})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var my=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},wa=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let Hp=(()=>{var a,c;let n=d.EventEmitter,e=[],t,r,i,o;return c=class extends n{constructor(g,m){super();u(this,a,(my(this,e),void 0));I(this,"disposables",new d.DisposableStack);I(this,"id");I(this,"origin");this.id=g,this.origin=m}initialize(){this.disposables.use(new d.EventEmitter(this.session)).on("script.realmDestroyed",m=>{m.realm===this.id&&this.dispose("Realm already destroyed.")})}get disposed(){return s(this,a)!==void 0}get target(){return{realm:this.id}}dispose(g){h(this,a,g),this[d.disposeSymbol]()}async disown(g){await this.session.send("script.disown",{target:this.target,handles:g})}async callFunction(g,m,x={}){const{result:C}=await this.session.send("script.callFunction",{functionDeclaration:g,awaitPromise:m,target:this.target,...x});return C}async evaluate(g,m,x={}){const{result:C}=await this.session.send("script.evaluate",{expression:g,awaitPromise:m,target:this.target,...x});return C}[(t=[d.inertIfDisposed],r=[d.throwIfDisposed(g=>s(g,a))],i=[d.throwIfDisposed(g=>s(g,a))],o=[d.throwIfDisposed(g=>s(g,a))],d.disposeSymbol)](){s(this,a)??h(this,a,"Realm already destroyed, probably because all associated browsing contexts closed."),this.emit("destroyed",{reason:s(this,a)}),this.disposables.dispose(),super[d.disposeSymbol]()}},a=new WeakMap,(()=>{const g=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;wa(c,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:m=>"dispose"in m,get:m=>m.dispose},metadata:g},null,e),wa(c,null,r,{kind:"method",name:"disown",static:!1,private:!1,access:{has:m=>"disown"in m,get:m=>m.disown},metadata:g},null,e),wa(c,null,i,{kind:"method",name:"callFunction",static:!1,private:!1,access:{has:m=>"callFunction"in m,get:m=>m.callFunction},metadata:g},null,e),wa(c,null,o,{kind:"method",name:"evaluate",static:!1,private:!1,access:{has:m=>"evaluate"in m,get:m=>m.evaluate},metadata:g},null,e),g&&Object.defineProperty(c,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:g})})(),c})();var $s;const Il=class Il extends Hp{constructor(t,r){super("","");I(this,"browsingContext");I(this,"sandbox");u(this,$s,{dedicated:new Map,shared:new Map});this.browsingContext=t,this.sandbox=r}static from(t,r){const i=new Il(t,r);return i.initialize(),i}initialize(){super.initialize();const t=this.disposables.use(new d.EventEmitter(this.session));t.on("script.realmCreated",r=>{r.type==="window"&&(this.id=r.realm,this.origin=r.origin)}),t.on("script.realmCreated",r=>{if(r.type!=="dedicated-worker"||!r.owners.includes(this.id))return;const i=al.from(this,r.realm,r.origin);s(this,$s).dedicated.set(i.id,i);const o=this.disposables.use(new d.EventEmitter(i));o.once("destroyed",()=>{o.removeAllListeners(),s(this,$s).dedicated.delete(i.id)}),this.emit("worker",i)}),this.browsingContext.userContext.browser.on("sharedworker",({realm:r})=>{if(!r.owners.has(this))return;s(this,$s).shared.set(r.id,r);const i=this.disposables.use(new d.EventEmitter(r));i.once("destroyed",()=>{i.removeAllListeners(),s(this,$s).shared.delete(r.id)}),this.emit("sharedworker",r)})}get session(){return this.browsingContext.userContext.browser.session}get target(){return{context:this.browsingContext.id,sandbox:this.sandbox}}};$s=new WeakMap;let Ta=Il;var Co;const Xc=class Xc extends Hp{constructor(t,r,i){super(r,i);u(this,Co,new Map);I(this,"owners");this.owners=new Set([t])}static from(t,r,i){const o=new Xc(t,r,i);return o.initialize(),o}initialize(){super.initialize(),this.disposables.use(new d.EventEmitter(this.session)).on("script.realmCreated",r=>{if(r.type!=="dedicated-worker"||!r.owners.includes(this.id))return;const i=Xc.from(this,r.realm,r.origin);s(this,Co).set(i.id,i),this.disposables.use(new d.EventEmitter(i)).once("destroyed",()=>{s(this,Co).delete(i.id)}),this.emit("worker",i)})}get session(){return this.owners.values().next().value.session}};Co=new WeakMap;let al=Xc;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var gy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},wy=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let yy=(()=>{var r,i,o,a,c,l,p,zp,m,Wp,C;let n=d.EventEmitter,e=[],t;return C=class extends n{constructor(y,b){super();u(this,p);u(this,m);u(this,r,(gy(this,e),void 0));u(this,i,void 0);u(this,o,void 0);u(this,a,void 0);u(this,c,new d.DisposableStack);u(this,l,void 0);h(this,a,y),h(this,l,b)}static from(y,b){var R;const E=new C(y,b);return f(R=E,p,zp).call(R),E}get disposed(){return s(this,c).disposed}get error(){return s(this,r)}get headers(){return s(this,l).request.headers}get id(){return s(this,l).request.request}get initiator(){return s(this,l).initiator}get method(){return s(this,l).request.method}get navigation(){return s(this,l).navigation??void 0}get redirect(){return this.redirect}get response(){return s(this,o)}get url(){return s(this,l).request.url}dispose(){this[d.disposeSymbol]()}[(t=[d.inertIfDisposed],d.disposeSymbol)](){s(this,c).dispose(),super[d.disposeSymbol]()}},r=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakSet,zp=function(){s(this,c).use(new d.EventEmitter(s(this,a))).once("closed",({reason:E})=>{h(this,r,E),this.emit("error",s(this,r)),this.dispose()});const b=s(this,c).use(new d.EventEmitter(s(this,m,Wp)));b.on("network.beforeRequestSent",E=>{E.context===s(this,a).id&&E.request.request===this.id&&(h(this,i,C.from(s(this,a),E)),this.emit("redirect",s(this,i)),this.dispose())}),b.on("network.fetchError",E=>{E.context===s(this,a).id&&E.request.request===this.id&&(h(this,r,E.errorText),this.emit("error",s(this,r)),this.dispose())}),b.on("network.responseCompleted",E=>{E.context===s(this,a).id&&E.request.request===this.id&&(h(this,o,E.response),this.emit("success",s(this,o)),this.dispose())})},m=new WeakSet,Wp=function(){return s(this,a).userContext.browser.session},(()=>{const y=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;wy(C,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:b=>"dispose"in b,get:b=>b.dispose},metadata:y},null,e),y&&Object.defineProperty(C,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:y})})(),C})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var vy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},Ql=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let by=(()=>{var i,o,a,c,Vp,p,cl,m;let n=d.EventEmitter,e=[],t,r;return m=class extends n{constructor(v,w){super();u(this,c);u(this,p);u(this,i,(vy(this,e),void 0));u(this,o,void 0);u(this,a,new d.DisposableStack);I(this,"browsingContext");I(this,"info");this.browsingContext=v,this.info=w}static from(v,w){var b;const y=new m(v,w);return f(b=y,c,Vp).call(b),y}get closed(){return s(this,i)!==void 0}get disposed(){return this.closed}get handled(){return s(this,o)!==void 0}get result(){return s(this,o)}dispose(v){h(this,i,v),this[d.disposeSymbol]()}async handle(v={}){return await s(this,p,cl).send("browsingContext.handleUserPrompt",{...v,context:this.info.context}),s(this,o)}[(t=[d.inertIfDisposed],r=[d.throwIfDisposed(v=>s(v,i))],d.disposeSymbol)](){s(this,i)??h(this,i,"User prompt already closed, probably because the associated browsing context was destroyed."),this.emit("closed",{reason:s(this,i)}),s(this,a).dispose(),super[d.disposeSymbol]()}},i=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakSet,Vp=function(){s(this,a).use(new d.EventEmitter(this.browsingContext)).once("closed",({reason:y})=>{this.dispose(`User prompt already closed: ${y}`)}),s(this,a).use(new d.EventEmitter(s(this,p,cl))).on("browsingContext.userPromptClosed",y=>{y.context===this.browsingContext.id&&(h(this,o,y),this.emit("handled",y),this.dispose("User prompt already handled."))})},p=new WeakSet,cl=function(){return this.browsingContext.userContext.browser.session},(()=>{const v=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;Ql(m,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:w=>"dispose"in w,get:w=>w.dispose},metadata:v},null,e),Ql(m,null,r,{kind:"method",name:"handle",static:!1,private:!1,access:{has:w=>"handle"in w,get:w=>w.handle},metadata:v},null,e),v&&Object.defineProperty(m,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:v})})(),m})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var xy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},oe=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let Cy=(()=>{var b,E,R,_,k,D,F,U,Gp,K,ge,W;let n=d.EventEmitter,e=[],t,r,i,o,a,c,l,p,g,m,x,C,v,w,y;return W=class extends n{constructor(P,S,M,J){super();u(this,U);u(this,K);u(this,b,(xy(this,e),void 0));u(this,E,void 0);u(this,R,void 0);u(this,_,new Map);u(this,k,new d.DisposableStack);u(this,D,new Map);u(this,F,new Map);I(this,"defaultRealm");I(this,"id");I(this,"parent");I(this,"userContext");h(this,R,J),this.id=M,this.parent=S,this.userContext=P,this.defaultRealm=Ta.from(this)}static from(P,S,M,J){var ua;const ss=new W(P,S,M,J);return f(ua=ss,U,Gp).call(ua),ss}get children(){return s(this,_).values()}get closed(){return s(this,E)!==void 0}get disposed(){return this.closed}get realms(){return s(this,D).values()}get top(){let P=this;for(let{parent:S}=P;S;{parent:S}=P)P=S;return P}get url(){return s(this,R)}dispose(P){h(this,E,P),this[d.disposeSymbol]()}async activate(){await s(this,K,ge).send("browsingContext.activate",{context:this.id})}async captureScreenshot(P={}){const{result:{data:S}}=await s(this,K,ge).send("browsingContext.captureScreenshot",{context:this.id,...P});return S}async close(P){await Promise.all([...s(this,_).values()].map(async S=>{await S.close(P)})),await s(this,K,ge).send("browsingContext.close",{context:this.id,promptUnload:P})}async traverseHistory(P){await s(this,K,ge).send("browsingContext.traverseHistory",{context:this.id,delta:P})}async navigate(P,S){return await s(this,K,ge).send("browsingContext.navigate",{context:this.id,url:P,wait:S}),await new Promise(M=>{this.once("navigation",({navigation:J})=>{M(J)})})}async reload(P={}){return await s(this,K,ge).send("browsingContext.reload",{context:this.id,...P}),await new Promise(S=>{this.once("navigation",({navigation:M})=>{S(M)})})}async print(P={}){const{result:{data:S}}=await s(this,K,ge).send("browsingContext.print",{context:this.id,...P});return S}async handleUserPrompt(P={}){await s(this,K,ge).send("browsingContext.handleUserPrompt",{context:this.id,...P})}async setViewport(P={}){await s(this,K,ge).send("browsingContext.setViewport",{context:this.id,...P})}async performActions(P){await s(this,K,ge).send("input.performActions",{context:this.id,actions:P})}async releaseActions(){await s(this,K,ge).send("input.releaseActions",{context:this.id})}createWindowRealm(P){return Ta.from(this,P)}async addPreloadScript(P,S={}){return await this.userContext.browser.addPreloadScript(P,{...S,contexts:[this,...S.contexts??[]]})}async removePreloadScript(P){await this.userContext.browser.removePreloadScript(P)}[(t=[d.inertIfDisposed],r=[d.throwIfDisposed(P=>s(P,E))],i=[d.throwIfDisposed(P=>s(P,E))],o=[d.throwIfDisposed(P=>s(P,E))],a=[d.throwIfDisposed(P=>s(P,E))],c=[d.throwIfDisposed(P=>s(P,E))],l=[d.throwIfDisposed(P=>s(P,E))],p=[d.throwIfDisposed(P=>s(P,E))],g=[d.throwIfDisposed(P=>s(P,E))],m=[d.throwIfDisposed(P=>s(P,E))],x=[d.throwIfDisposed(P=>s(P,E))],C=[d.throwIfDisposed(P=>s(P,E))],v=[d.throwIfDisposed(P=>s(P,E))],w=[d.throwIfDisposed(P=>s(P,E))],y=[d.throwIfDisposed(P=>s(P,E))],d.disposeSymbol)](){s(this,E)??h(this,E,"Browsing context already closed, probably because the user context closed."),this.emit("closed",{reason:s(this,E)}),s(this,k).dispose(),super[d.disposeSymbol]()}},b=new WeakMap,E=new WeakMap,R=new WeakMap,_=new WeakMap,k=new WeakMap,D=new WeakMap,F=new WeakMap,U=new WeakSet,Gp=function(){s(this,k).use(new d.EventEmitter(this.userContext)).once("closed",({reason:M})=>{this.dispose(`Browsing context already closed: ${M}`)});const S=s(this,k).use(new d.EventEmitter(s(this,K,ge)));S.on("browsingContext.contextCreated",M=>{if(M.parent!==this.id)return;const J=W.from(this.userContext,this,M.context,M.url);s(this,_).set(M.context,J);const ss=s(this,k).use(new d.EventEmitter(J));ss.once("closed",()=>{ss.removeAllListeners(),s(this,_).delete(J.id)}),this.emit("browsingcontext",{browsingContext:J})}),S.on("browsingContext.contextDestroyed",M=>{M.context===this.id&&this.dispose("Browsing context already closed.")}),S.on("browsingContext.domContentLoaded",M=>{M.context===this.id&&(h(this,R,M.url),this.emit("DOMContentLoaded",void 0))}),S.on("browsingContext.load",M=>{M.context===this.id&&(h(this,R,M.url),this.emit("load",void 0))}),S.on("browsingContext.navigationStarted",M=>{if(M.context!==this.id)return;h(this,R,M.url),s(this,F).clear(),h(this,b,fy.from(this));const J=s(this,k).use(new d.EventEmitter(s(this,b)));for(const ss of["fragment","failed","aborted"])J.once(ss,({url:ua})=>{J[d.disposeSymbol](),h(this,R,ua)});this.emit("navigation",{navigation:s(this,b)})}),S.on("network.beforeRequestSent",M=>{if(M.context!==this.id||s(this,F).has(M.request.request))return;const J=yy.from(this,M);s(this,F).set(J.id,J),this.emit("request",{request:J})}),S.on("log.entryAdded",M=>{M.source.context===this.id&&this.emit("log",{entry:M})}),S.on("browsingContext.userPromptOpened",M=>{if(M.context!==this.id)return;const J=by.from(this,M);this.emit("userprompt",{userPrompt:J})})},K=new WeakSet,ge=function(){return this.userContext.browser.session},(()=>{const P=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;oe(W,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:S=>"dispose"in S,get:S=>S.dispose},metadata:P},null,e),oe(W,null,r,{kind:"method",name:"activate",static:!1,private:!1,access:{has:S=>"activate"in S,get:S=>S.activate},metadata:P},null,e),oe(W,null,i,{kind:"method",name:"captureScreenshot",static:!1,private:!1,access:{has:S=>"captureScreenshot"in S,get:S=>S.captureScreenshot},metadata:P},null,e),oe(W,null,o,{kind:"method",name:"close",static:!1,private:!1,access:{has:S=>"close"in S,get:S=>S.close},metadata:P},null,e),oe(W,null,a,{kind:"method",name:"traverseHistory",static:!1,private:!1,access:{has:S=>"traverseHistory"in S,get:S=>S.traverseHistory},metadata:P},null,e),oe(W,null,c,{kind:"method",name:"navigate",static:!1,private:!1,access:{has:S=>"navigate"in S,get:S=>S.navigate},metadata:P},null,e),oe(W,null,l,{kind:"method",name:"reload",static:!1,private:!1,access:{has:S=>"reload"in S,get:S=>S.reload},metadata:P},null,e),oe(W,null,p,{kind:"method",name:"print",static:!1,private:!1,access:{has:S=>"print"in S,get:S=>S.print},metadata:P},null,e),oe(W,null,g,{kind:"method",name:"handleUserPrompt",static:!1,private:!1,access:{has:S=>"handleUserPrompt"in S,get:S=>S.handleUserPrompt},metadata:P},null,e),oe(W,null,m,{kind:"method",name:"setViewport",static:!1,private:!1,access:{has:S=>"setViewport"in S,get:S=>S.setViewport},metadata:P},null,e),oe(W,null,x,{kind:"method",name:"performActions",static:!1,private:!1,access:{has:S=>"performActions"in S,get:S=>S.performActions},metadata:P},null,e),oe(W,null,C,{kind:"method",name:"releaseActions",static:!1,private:!1,access:{has:S=>"releaseActions"in S,get:S=>S.releaseActions},metadata:P},null,e),oe(W,null,v,{kind:"method",name:"createWindowRealm",static:!1,private:!1,access:{has:S=>"createWindowRealm"in S,get:S=>S.createWindowRealm},metadata:P},null,e),oe(W,null,w,{kind:"method",name:"addPreloadScript",static:!1,private:!1,access:{has:S=>"addPreloadScript"in S,get:S=>S.addPreloadScript},metadata:P},null,e),oe(W,null,y,{kind:"method",name:"removePreloadScript",static:!1,private:!1,access:{has:S=>"removePreloadScript"in S,get:S=>S.removePreloadScript},metadata:P},null,e),P&&Object.defineProperty(W,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:P})})(),W})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ey=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},dd=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let Ct=(()=>{var o,a,c,l,p,g,Xp,x,Sa;let n=d.EventEmitter,e=[],t,r,i;return o=class extends n{constructor(y,b){super();u(this,g);u(this,x);u(this,a,(Ey(this,e),void 0));u(this,c,new Map);u(this,l,new d.DisposableStack);u(this,p,void 0);I(this,"browser");h(this,p,b),this.browser=y}static create(y,b){var R;const E=new o(y,b);return f(R=E,g,Xp).call(R),E}get browsingContexts(){return s(this,c).values()}get closed(){return s(this,a)!==void 0}get disposed(){return this.closed}get id(){return s(this,p)}dispose(y){h(this,a,y),this[d.disposeSymbol]()}async createBrowsingContext(y,b={}){var _;const{result:{context:E}}=await s(this,x,Sa).send("browsingContext.create",{type:y,...b,referenceContext:(_=b.referenceContext)==null?void 0:_.id,userContext:s(this,p)}),R=s(this,c).get(E);return d.assert(R,"The WebDriver BiDi implementation is failing to create a browsing context correctly."),R}async remove(){try{await s(this,x,Sa).send("browser.removeUserContext",{userContext:s(this,p)})}finally{this.dispose("User context already closed.")}}[(t=[d.inertIfDisposed],r=[d.throwIfDisposed(y=>s(y,a))],i=[d.throwIfDisposed(y=>s(y,a))],d.disposeSymbol)](){s(this,a)??h(this,a,"User context already closed, probably because the browser disconnected/closed."),this.emit("closed",{reason:s(this,a)}),s(this,l).dispose(),super[d.disposeSymbol]()}},a=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakMap,g=new WeakSet,Xp=function(){s(this,l).use(new d.EventEmitter(this.browser)).once("closed",({reason:E})=>{this.dispose(`User context already closed: ${E}`)}),s(this,l).use(new d.EventEmitter(s(this,x,Sa))).on("browsingContext.contextCreated",E=>{if(E.parent||E.userContext!==s(this,p))return;const R=Cy.from(this,void 0,E.context,E.url);s(this,c).set(R.id,R);const _=s(this,l).use(new d.EventEmitter(R));_.on("closed",()=>{_.removeAllListeners(),s(this,c).delete(R.id)}),this.emit("browsingcontext",{browsingContext:R})})},x=new WeakSet,Sa=function(){return this.browser.session},(()=>{const y=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;dd(o,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:b=>"dispose"in b,get:b=>b.dispose},metadata:y},null,e),dd(o,null,r,{kind:"method",name:"createBrowsingContext",static:!1,private:!1,access:{has:b=>"createBrowsingContext"in b,get:b=>b.createBrowsingContext},metadata:y},null,e),dd(o,null,i,{kind:"method",name:"remove",static:!1,private:!1,access:{has:b=>"remove"in b,get:b=>b.remove},metadata:y},null,e),y&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:y})})(),I(o,"DEFAULT","default"),o})();/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var gt,ln,hn,wt;class Jp extends d.BrowserContext{constructor(t,r,i){super();u(this,gt,void 0);u(this,ln,void 0);u(this,hn,void 0);u(this,wt,void 0);h(this,gt,t),h(this,wt,r),h(this,ln,s(this,gt).connection),h(this,hn,i.defaultViewport)}targets(){return s(this,gt).targets().filter(t=>t.browserContext()===this)}waitForTarget(t,r={}){return s(this,gt).waitForTarget(i=>i.browserContext()===this&&t(i),r)}get connection(){return s(this,ln)}async newPage(){const{result:t}=await s(this,ln).send("browsingContext.create",{type:"tab",userContext:s(this,wt).id}),r=s(this,gt)._getTargetById(t.context);r._setBrowserContext(this);const i=await r.page();if(!i)throw new Error("Page is not found");if(s(this,hn))try{await i.setViewport(s(this,hn))}catch{}return i}async close(){if(!this.isIncognito())throw new Error("Default context cannot be closed!");try{await s(this,wt).remove()}catch(t){d.debugError(t)}}browser(){return s(this,gt)}async pages(){return(await Promise.all([...this.targets()].map(r=>r.page()))).filter(r=>r!==null)}isIncognito(){return s(this,wt).id!==Ct.DEFAULT}overridePermissions(){throw new d.UnsupportedOperation}clearPermissionOverrides(){throw new d.UnsupportedOperation}get id(){if(s(this,wt).id!=="default")return s(this,wt).id}}gt=new WeakMap,ln=new WeakMap,hn=new WeakMap,wt=new WeakMap;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Sy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},Fn=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0},Py=globalThis&&globalThis.__addDisposableResource||function(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose]}if(typeof r!="function")throw new TypeError("Object not disposable.");n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e},_y=globalThis&&globalThis.__disposeResources||function(n){return function(e){function t(i){e.error=e.hasError?new n(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}function r(){for(;e.stack.length;){var i=e.stack.pop();try{var o=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(o).then(r,function(a){return t(a),r()})}catch(a){t(a)}}if(e.hasError)throw e.error}return r()}}(typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r});let ky=(()=>{var c,l,p,g,m,Yp,C,Qp,w,Zp,b;let n=d.EventEmitter,e=[],t,r,i,o,a;return b=class extends n{constructor(_){super();u(this,m);u(this,C);u(this,w);u(this,c,(Sy(this,e),!1));u(this,l,void 0);u(this,p,new d.DisposableStack);u(this,g,new Map);I(this,"session");this.session=_,s(this,g).set(Ct.DEFAULT,Ct.create(this,Ct.DEFAULT))}static async from(_){var D;const k=new b(_);return await f(D=k,m,Yp).call(D),k}get closed(){return s(this,c)}get defaultUserContext(){return s(this,g).get(Ct.DEFAULT)}get disconnected(){return s(this,l)!==void 0}get disposed(){return this.disconnected}get userContexts(){return s(this,g).values()}dispose(_,k=!1){h(this,c,k),h(this,l,_),this[d.disposeSymbol]()}async close(){try{await this.session.send("browser.close",{})}finally{this.dispose("Browser already closed.",!0)}}async addPreloadScript(_,k={}){var F;const{result:{script:D}}=await this.session.send("script.addPreloadScript",{functionDeclaration:_,...k,contexts:(F=k.contexts)==null?void 0:F.map(U=>U.id)});return D}async removePreloadScript(_){await this.session.send("script.removePreloadScript",{script:_})}async createUserContext(){const{result:{userContext:_}}=await this.session.send("browser.createUserContext",{}),k=Ct.create(this,_);s(this,g).set(k.id,k);const D=s(this,p).use(new d.EventEmitter(k));return D.once("closed",()=>{D.removeAllListeners(),s(this,g).delete(_)}),k}[(t=[d.inertIfDisposed],r=[d.throwIfDisposed(_=>s(_,l))],i=[d.throwIfDisposed(_=>s(_,l))],o=[d.throwIfDisposed(_=>s(_,l))],a=[d.throwIfDisposed(_=>s(_,l))],d.disposeSymbol)](){s(this,l)??h(this,l,"Browser was disconnected, probably because the session ended."),this.closed&&this.emit("closed",{reason:s(this,l)}),this.emit("disconnected",{reason:s(this,l)}),s(this,p).dispose(),super[d.disposeSymbol]()}},c=new WeakMap,l=new WeakMap,p=new WeakMap,g=new WeakMap,m=new WeakSet,Yp=async function(){const _=s(this,p).use(new d.EventEmitter(this.session));_.once("ended",({reason:k})=>{this.dispose(k)}),_.on("script.realmCreated",k=>{k.type}),await f(this,C,Qp).call(this),await f(this,w,Zp).call(this)},C=new WeakSet,Qp=async function(){const{result:{userContexts:_}}=await this.session.send("browser.getUserContexts",{});for(const k of _)k.userContext!==Ct.DEFAULT&&s(this,g).set(k.userContext,Ct.create(this,k.userContext))},w=new WeakSet,Zp=async function(){const _=new Set;let k;{const D={stack:[],error:void 0,hasError:!1};try{const F=Py(D,new d.EventEmitter(this.session),!1);F.on("browsingContext.contextCreated",ot=>{_.add(ot.context)}),F.on("browsingContext.contextDestroyed",ot=>{_.delete(ot.context)});const{result:U}=await this.session.send("browsingContext.getTree",{});k=U.contexts}catch(F){D.error=F,D.hasError=!0}finally{_y(D)}}for(const D of k)_.has(D.context)&&this.session.emit("browsingContext.contextCreated",D),D.children&&k.push(...D.children)},(()=>{const _=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;Fn(b,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:k=>"dispose"in k,get:k=>k.dispose},metadata:_},null,e),Fn(b,null,r,{kind:"method",name:"close",static:!1,private:!1,access:{has:k=>"close"in k,get:k=>k.close},metadata:_},null,e),Fn(b,null,i,{kind:"method",name:"addPreloadScript",static:!1,private:!1,access:{has:k=>"addPreloadScript"in k,get:k=>k.addPreloadScript},metadata:_},null,e),Fn(b,null,o,{kind:"method",name:"removePreloadScript",static:!1,private:!1,access:{has:k=>"removePreloadScript"in k,get:k=>k.removePreloadScript},metadata:_},null,e),Fn(b,null,a,{kind:"method",name:"createUserContext",static:!1,private:!1,access:{has:k=>"createUserContext"in k,get:k=>k.createUserContext},metadata:_},null,e),_&&Object.defineProperty(b,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_})})(),b})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Iy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},ya=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let Ry=(()=>{var a,c,l,p,ef,m;let n=d.EventEmitter,e=[],t,r,i,o;return m=class extends n{constructor(v,w){super();u(this,p);u(this,a,(Iy(this,e),void 0));u(this,c,new d.DisposableStack);u(this,l,void 0);I(this,"browser");I(this,"connection");h(this,l,w),this.connection=v}static async from(v,w){var E;let y;try{y=(await v.send("session.new",{capabilities:w})).result}catch(R){d.debugError(R),y={sessionId:"",capabilities:{acceptInsecureCerts:!1,browserName:"",browserVersion:"",platformName:"",setWindowRect:!1,webSocketUrl:""}}}const b=new m(v,y);return await f(E=b,p,ef).call(E),b}get capabilities(){return s(this,l).capabilities}get disposed(){return this.ended}get ended(){return s(this,a)!==void 0}get id(){return s(this,l).sessionId}dispose(v){h(this,a,v),this[d.disposeSymbol]()}pipeTo(v){this.connection.pipeTo(v)}async send(v,w){return await this.connection.send(v,w)}async subscribe(v){await this.send("session.subscribe",{events:v})}async end(){try{await this.send("session.end",{})}finally{this.dispose("Session already ended.")}}[(t=[d.inertIfDisposed],r=[d.throwIfDisposed(v=>s(v,a))],i=[d.throwIfDisposed(v=>s(v,a))],o=[d.throwIfDisposed(v=>s(v,a))],d.disposeSymbol)](){s(this,a)??h(this,a,"Session already destroyed, probably because the connection broke."),this.emit("ended",{reason:s(this,a)}),s(this,c).dispose(),super[d.disposeSymbol]()}},a=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakSet,ef=async function(){this.connection.pipeTo(this),this.browser=await ky.from(this),s(this,c).use(this.browser).once("closed",({reason:w})=>{this.dispose(w)})},(()=>{const v=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;ya(m,null,t,{kind:"method",name:"dispose",static:!1,private:!1,access:{has:w=>"dispose"in w,get:w=>w.dispose},metadata:v},null,e),ya(m,null,r,{kind:"method",name:"send",static:!1,private:!1,access:{has:w=>"send"in w,get:w=>w.send},metadata:v},null,e),ya(m,null,i,{kind:"method",name:"subscribe",static:!1,private:!1,access:{has:w=>"subscribe"in w,get:w=>w.subscribe},metadata:v},null,e),ya(m,null,o,{kind:"method",name:"end",static:!1,private:!1,access:{has:w=>"end"in w,get:w=>w.end},metadata:v},null,e),v&&Object.defineProperty(m,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:v})})(),m})();/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var pn;class Ty extends d.Dialog{constructor(t,r,i,o){super(r,i,o);u(this,pn,void 0);h(this,pn,t)}async handle(t){await s(this,pn).connection.send("browsingContext.handleUserPrompt",{context:s(this,pn).id,accept:t.accept,userText:t.text})}}pn=new WeakMap;var fn;class Dy{constructor(e){u(this,fn,void 0);h(this,fn,e)}async emulateViewport(e){await s(this,fn).connection.send("browsingContext.setViewport",{context:s(this,fn).id,viewport:e.width&&e.height?{width:e.width,height:e.height}:null,devicePixelRatio:e.deviceScaleFactor?e.deviceScaleFactor:null})}}fn=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var st,Eo,rt,So,mn,Jc,gn,Pa,Yc,tf,Qc,Zc,wn,_a;class Oy{constructor(e,t,r){u(this,gn);u(this,Yc);u(this,wn);u(this,st,void 0);I(this,"name");u(this,Eo,void 0);u(this,rt,void 0);u(this,So,new Map);u(this,mn,void 0);u(this,Jc,async e=>{var a;if(e.channel!==s(this,rt).args)return;const t=s(this,gn,Pa),{callbacks:r,remoteValue:i}=f(this,wn,_a).call(this,e),o=(a=i.value)==null?void 0:a[1];d.assert(o);try{const c=await s(this,Eo).call(this,...he.deserialize(o));await t.send("script.callFunction",{functionDeclaration:d.stringifyFunction(([l,p],g)=>{p(g)}),arguments:[await r.resolve.valueOrThrow(),be.serializeRemoteValue(c)],awaitPromise:!1,target:{realm:e.source.realm}})}catch(c){try{c instanceof Error?await t.send("script.callFunction",{functionDeclaration:d.stringifyFunction(([l,p],g,m,x)=>{const C=new Error(m);C.name=g,x&&(C.stack=x),p(C)}),arguments:[await r.reject.valueOrThrow(),be.serializeRemoteValue(c.name),be.serializeRemoteValue(c.message),be.serializeRemoteValue(c.stack)],awaitPromise:!1,target:{realm:e.source.realm}}):await t.send("script.callFunction",{functionDeclaration:d.stringifyFunction(([l,p],g)=>{p(g)}),arguments:[await r.reject.valueOrThrow(),be.serializeRemoteValue(c)],awaitPromise:!1,target:{realm:e.source.realm}})}catch(l){d.debugError(l)}}});u(this,Qc,e=>{if(e.channel!==s(this,rt).resolve)return;const{callbacks:t,remoteValue:r}=f(this,wn,_a).call(this,e);t.resolve.resolve(r)});u(this,Zc,e=>{if(e.channel!==s(this,rt).reject)return;const{callbacks:t,remoteValue:r}=f(this,wn,_a).call(this,e);t.reject.resolve(r)});h(this,st,e),this.name=t,h(this,Eo,r),h(this,rt,{args:`__puppeteer__${s(this,st)._id}_page_exposeFunction_${this.name}_args`,resolve:`__puppeteer__${s(this,st)._id}_page_exposeFunction_${this.name}_resolve`,reject:`__puppeteer__${s(this,st)._id}_page_exposeFunction_${this.name}_reject`})}async expose(){const e=s(this,gn,Pa),t=s(this,Yc,tf);e.on(B.ChromiumBidi.Script.EventNames.Message,s(this,Jc)),e.on(B.ChromiumBidi.Script.EventNames.Message,s(this,Qc)),e.on(B.ChromiumBidi.Script.EventNames.Message,s(this,Zc));const r=d.stringifyFunction(d.interpolateFunction((o,a,c)=>{let l=0;Object.assign(globalThis,{[PLACEHOLDER("name")]:function(...p){return new Promise((g,m)=>{o([l,p]),a([l,g]),c([l,m]),++l})}})},{name:JSON.stringify(this.name)})),{result:i}=await e.send("script.addPreloadScript",{functionDeclaration:r,arguments:t,contexts:[s(this,st).page().mainFrame()._id]});h(this,mn,i.script),await Promise.all(s(this,st).page().frames().map(async o=>await e.send("script.callFunction",{functionDeclaration:r,arguments:t,awaitPromise:!1,target:o.mainRealm().realm.target})))}[Symbol.dispose](){this[Symbol.asyncDispose]().catch(d.debugError)}async[Symbol.asyncDispose](){s(this,mn)&&await s(this,gn,Pa).send("script.removePreloadScript",{script:s(this,mn)})}}st=new WeakMap,Eo=new WeakMap,rt=new WeakMap,So=new WeakMap,mn=new WeakMap,Jc=new WeakMap,gn=new WeakSet,Pa=function(){return s(this,st).context().connection},Yc=new WeakSet,tf=function(){return[{type:"channel",value:{channel:s(this,rt).args,ownership:"root"}},{type:"channel",value:{channel:s(this,rt).resolve,ownership:"root"}},{type:"channel",value:{channel:s(this,rt).reject,ownership:"root"}}]},Qc=new WeakMap,Zc=new WeakMap,wn=new WeakSet,_a=function(e){const{data:t,source:r}=e;d.assert(t.type==="array"),d.assert(t.value);const i=t.value[0];d.assert(i),d.assert(i.type==="number"),d.assert(typeof i.value=="number");let o=s(this,So).get(r.realm);o||(o=new Map,s(this,So).set(r.realm,o));const a=i.value;let c=o.get(a);return c||(c={resolve:new d.Deferred,reject:new d.Deferred},o.set(a,c)),{callbacks:c,remoteValue:t}};function sf(n){if(Array.isArray(n)){const e=n.some(r=>r!=="domcontentloaded")?"load":"domcontentloaded",t=n.reduce((r,i)=>i==="networkidle0"||r!=="networkidle0"&&i==="networkidle2"?i:r,null);return[e,t]}return n==="networkidle0"||n==="networkidle2"?["load",n]:[n,null]}const Ny=new Map([["load","complete"],["domcontentloaded","interactive"]]);function rf(n){const e=sf(n);return[Ny.get(e[0]),e[1]]}const My=new Map([["load","browsingContext.load"],["domcontentloaded","browsingContext.domContentLoaded"]]);function Zl(n){const e=sf(n);return[My.get(e[0]),e[1]]}function ul(n,e){return d.Wr(t=>{throw t instanceof d.ProtocolError?t.message+=` at ${n}`:t instanceof d.TimeoutError&&(t.message=`Navigation timeout of ${e} ms exceeded`),t})}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const ka=Symbol("mainSandbox"),Ia=Symbol("puppeteerSandbox");var Po;class dl extends d.Realm{constructor(t,r,i,o){super(o);I(this,"name");I(this,"realm");u(this,Po,void 0);this.name=t,this.realm=i,h(this,Po,r),this.realm.setSandbox(this)}get environment(){return s(this,Po)}async evaluateHandle(t,...r){return t=d.withSourcePuppeteerURLIfNone(this.evaluateHandle.name,t),await this.realm.evaluateHandle(t,...r)}async evaluate(t,...r){return t=d.withSourcePuppeteerURLIfNone(this.evaluate.name,t),await this.realm.evaluate(t,...r)}async adoptHandle(t){return await this.evaluateHandle(r=>r,t)}async transferHandle(t){if(t.realm===this)return t;const r=await this.evaluateHandle(i=>i,t);return await t.dispose(),r}async adoptBackendNode(t){const{object:r}=await this.environment.client.send("DOM.resolveNode",{backendNodeId:t});return new ca(this,{handle:r.objectId,type:"node"})}}Po=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Fy=globalThis&&globalThis.__runInitializers||function(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0},ld=globalThis&&globalThis.__esDecorate||function(n,e,t,r,i,o){function a(b){if(b!==void 0&&typeof b!="function")throw new TypeError("Function expected");return b}for(var c=r.kind,l=c==="getter"?"get":c==="setter"?"set":"value",p=!e&&n?r.static?n:n.prototype:null,g=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),m,x=!1,C=t.length-1;C>=0;C--){var v={};for(var w in r)v[w]=w==="access"?{}:r[w];for(var w in r.access)v.access[w]=r.access[w];v.addInitializer=function(b){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(b||null))};var y=(0,t[C])(c==="accessor"?{get:g.get,set:g.set}:g[l],v);if(c==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(m=a(y.get))&&(g.get=m),(m=a(y.set))&&(g.set=m),(m=a(y.init))&&i.unshift(m)}else(m=a(y))&&(c==="field"?i.unshift(m):g[l]=m)}p&&Object.defineProperty(p,r.name,g),x=!0};let ll=(()=>{var o,a,c,l,p,g,m;let n=d.Frame,e=[],t,r,i;return m=class extends n{constructor(v,w,y,b){super();u(this,o,(Fy(this,e),void 0));u(this,a,void 0);u(this,c,void 0);u(this,l,d.Deferred.create());u(this,p,!1);I(this,"sandboxes");I(this,"_id");u(this,g,new Map);h(this,o,v),h(this,a,w),h(this,c,y),this._id=s(this,a).id,this._parentId=b??void 0,this.sandboxes={[ka]:new dl(void 0,this,w,y),[Ia]:new dl(d.UTILITY_WORLD_NAME,this,w.createRealmForSandbox(),y)}}get client(){return this.context().cdpSession}mainRealm(){return this.sandboxes[ka]}isolatedRealm(){return this.sandboxes[Ia]}page(){return s(this,o)}isOOPFrame(){throw new d.UnsupportedOperation}url(){return s(this,a).url}parentFrame(){return s(this,o).frame(this._parentId??"")}childFrames(){return s(this,o).childFrames(s(this,a).id)}async goto(v,w={}){const{waitUntil:y="load",timeout:b=s(this,c).navigationTimeout()}=w,[E,R]=rf(y),_=d.Ee(d.F(s(this,a).connection.send("browsingContext.navigate",{context:s(this,a).id,url:v,wait:E})),...R!==null?[s(this,o).waitForNetworkIdle$({timeout:b,concurrency:R==="networkidle2"?2:0,idleTime:d.NETWORK_IDLE_TIME})]:[]).pipe(d.k(([{result:D}])=>D),d.Fe(d.timeout(b),d.F(s(this,l).valueOrThrow())),ul(v,b)),k=await d.me(_);return s(this,o).getNavigationResponse(k.navigation)}async setContent(v,w={}){const{waitUntil:y="load",timeout:b=s(this,c).navigationTimeout()}=w,[E,R]=Zl(y),_=d.Ee(d.be([d.fromEmitterEvent(s(this,a),E).pipe(d.Pe()),d.F(this.setFrameContent(v))]).pipe(d.k(()=>null)),...R!==null?[s(this,o).waitForNetworkIdle$({timeout:b,concurrency:R==="networkidle2"?2:0,idleTime:d.NETWORK_IDLE_TIME})]:[]).pipe(d.Fe(d.timeout(b),d.F(s(this,l).valueOrThrow())),ul("setContent",b));await d.me(_)}context(){return s(this,a)}async waitForNavigation(v={}){const{waitUntil:w="load",timeout:y=s(this,c).navigationTimeout()}=v,[b,E]=Zl(w),R=d.we(d.be([d.fromEmitterEvent(s(this,a),B.ChromiumBidi.BrowsingContext.EventNames.NavigationStarted).pipe(d.Pe()),d.fromEmitterEvent(s(this,a),b).pipe(d.Pe())]),d.fromEmitterEvent(s(this,a),B.ChromiumBidi.BrowsingContext.EventNames.FragmentNavigated)).pipe(d.k(D=>Array.isArray(D)?{result:D[1]}:{result:D})),_=d.Ee(R,...E!==null?[s(this,o).waitForNetworkIdle$({timeout:y,concurrency:E==="networkidle2"?2:0,idleTime:d.NETWORK_IDLE_TIME})]:[]).pipe(d.k(([{result:D}])=>D),d.Fe(d.timeout(y),d.F(s(this,l).valueOrThrow()))),k=await d.me(_);return s(this,o).getNavigationResponse(k.navigation)}waitForDevicePrompt(){throw new d.UnsupportedOperation}get detached(){return s(this,p)}[(t=[d.throwIfDetached],r=[d.throwIfDetached],i=[d.throwIfDetached],d.disposeSymbol)](){s(this,p)||(h(this,p,!0),s(this,l).reject(new Error("Frame detached")),s(this,a).dispose(),this.sandboxes[ka][d.disposeSymbol](),this.sandboxes[Ia][d.disposeSymbol]())}async exposeFunction(v,w){if(s(this,g).has(v))throw new Error(`Failed to add page binding with name ${v}: globalThis['${v}'] already exists!`);const y=new Oy(this,v,w);s(this,g).set(v,y);try{await y.expose()}catch(b){throw s(this,g).delete(v),b}}waitForSelector(v,w){if(v.startsWith("aria"))throw new d.UnsupportedOperation("ARIA selector is not supported for BiDi!");return super.waitForSelector(v,w)}},o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakMap,g=new WeakMap,(()=>{const v=typeof Symbol=="function"&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;ld(m,null,t,{kind:"method",name:"goto",static:!1,private:!1,access:{has:w=>"goto"in w,get:w=>w.goto},metadata:v},null,e),ld(m,null,r,{kind:"method",name:"setContent",static:!1,private:!1,access:{has:w=>"setContent"in w,get:w=>w.setContent},metadata:v},null,e),ld(m,null,i,{kind:"method",name:"waitForNavigation",static:!1,private:!1,access:{has:w=>"waitForNavigation"in w,get:w=>w.waitForNavigation},metadata:v},null,e),v&&Object.defineProperty(m,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:v})})(),m})();/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var fe;(function(n){n.None="none",n.Key="key",n.Pointer="pointer",n.Wheel="wheel"})(fe||(fe={}));var q;(function(n){n.Pause="pause",n.KeyDown="keyDown",n.KeyUp="keyUp",n.PointerUp="pointerUp",n.PointerDown="pointerDown",n.PointerMove="pointerMove",n.Scroll="scroll"})(q||(q={}));const jn=n=>{switch(n){case"\r":case`
`:n="Enter";break}if([...n].length===1)return n;switch(n){case"Cancel":return"";case"Help":return"";case"Backspace":return"";case"Tab":return"";case"Clear":return"";case"Enter":return"";case"Shift":case"ShiftLeft":return"";case"Control":case"ControlLeft":return"";case"Alt":case"AltLeft":return"";case"Pause":return"";case"Escape":return"";case"PageUp":return"";case"PageDown":return"";case"End":return"";case"Home":return"";case"ArrowLeft":return"";case"ArrowUp":return"";case"ArrowRight":return"";case"ArrowDown":return"";case"Insert":return"";case"Delete":return"";case"NumpadEqual":return"";case"Numpad0":return"";case"Numpad1":return"";case"Numpad2":return"";case"Numpad3":return"";case"Numpad4":return"";case"Numpad5":return"";case"Numpad6":return"";case"Numpad7":return"";case"Numpad8":return"";case"Numpad9":return"";case"NumpadMultiply":return"";case"NumpadAdd":return"";case"NumpadSubtract":return"";case"NumpadDecimal":return"";case"NumpadDivide":return"";case"F1":return"";case"F2":return"";case"F3":return"";case"F4":return"";case"F5":return"";case"F6":return"";case"F7":return"";case"F8":return"";case"F9":return"";case"F10":return"";case"F11":return"";case"F12":return"";case"Meta":case"MetaLeft":return"";case"ShiftRight":return"";case"ControlRight":return"";case"AltRight":return"";case"MetaRight":return"";case"Digit0":return"0";case"Digit1":return"1";case"Digit2":return"2";case"Digit3":return"3";case"Digit4":return"4";case"Digit5":return"5";case"Digit6":return"6";case"Digit7":return"7";case"Digit8":return"8";case"Digit9":return"9";case"KeyA":return"a";case"KeyB":return"b";case"KeyC":return"c";case"KeyD":return"d";case"KeyE":return"e";case"KeyF":return"f";case"KeyG":return"g";case"KeyH":return"h";case"KeyI":return"i";case"KeyJ":return"j";case"KeyK":return"k";case"KeyL":return"l";case"KeyM":return"m";case"KeyN":return"n";case"KeyO":return"o";case"KeyP":return"p";case"KeyQ":return"q";case"KeyR":return"r";case"KeyS":return"s";case"KeyT":return"t";case"KeyU":return"u";case"KeyV":return"v";case"KeyW":return"w";case"KeyX":return"x";case"KeyY":return"y";case"KeyZ":return"z";case"Semicolon":return";";case"Equal":return"=";case"Comma":return",";case"Minus":return"-";case"Period":return".";case"Slash":return"/";case"Backquote":return"`";case"BracketLeft":return"[";case"Backslash":return"\\";case"BracketRight":return"]";case"Quote":return'"';default:throw new Error(`Unknown key: "${n}"`)}};var ve;class nf extends d.Keyboard{constructor(t){super();u(this,ve,void 0);h(this,ve,t)}async down(t,r){await s(this,ve).connection.send("input.performActions",{context:s(this,ve).mainFrame()._id,actions:[{type:fe.Key,id:"__puppeteer_keyboard",actions:[{type:q.KeyDown,value:jn(t)}]}]})}async up(t){await s(this,ve).connection.send("input.performActions",{context:s(this,ve).mainFrame()._id,actions:[{type:fe.Key,id:"__puppeteer_keyboard",actions:[{type:q.KeyUp,value:jn(t)}]}]})}async press(t,r={}){const{delay:i=0}=r,o=[{type:q.KeyDown,value:jn(t)}];i>0&&o.push({type:q.Pause,duration:i}),o.push({type:q.KeyUp,value:jn(t)}),await s(this,ve).connection.send("input.performActions",{context:s(this,ve).mainFrame()._id,actions:[{type:fe.Key,id:"__puppeteer_keyboard",actions:o}]})}async type(t,r={}){const{delay:i=0}=r,o=[...t].map(jn),a=[];if(i<=0)for(const c of o)a.push({type:q.KeyDown,value:c},{type:q.KeyUp,value:c});else for(const c of o)a.push({type:q.KeyDown,value:c},{type:q.Pause,duration:i},{type:q.KeyUp,value:c});await s(this,ve).connection.send("input.performActions",{context:s(this,ve).mainFrame()._id,actions:[{type:fe.Key,id:"__puppeteer_keyboard",actions:a}]})}async sendCharacter(t){if([...t].length>1)throw new Error("Cannot send more than 1 character.");await(await s(this,ve).focusedFrame()).isolatedRealm().evaluate(async i=>{document.execCommand("insertText",!1,i)},t)}}ve=new WeakMap;const hd=n=>{switch(n){case d.MouseButton.Left:return 0;case d.MouseButton.Middle:return 1;case d.MouseButton.Right:return 2;case d.MouseButton.Back:return 3;case d.MouseButton.Forward:return 4}};var ne,Us;class of extends d.Mouse{constructor(t){super();u(this,ne,void 0);u(this,Us,{x:0,y:0});h(this,ne,t)}async reset(){h(this,Us,{x:0,y:0}),await s(this,ne).connection.send("input.releaseActions",{context:s(this,ne).id})}async move(t,r,i={}){const o=s(this,Us),a={x:Math.round(t),y:Math.round(r)},c=[],l=i.steps??0;for(let p=0;p<l;++p)c.push({type:q.PointerMove,x:o.x+(a.x-o.x)*(p/l),y:o.y+(a.y-o.y)*(p/l),origin:i.origin});c.push({type:q.PointerMove,...a,origin:i.origin}),h(this,Us,a),await s(this,ne).connection.send("input.performActions",{context:s(this,ne).id,actions:[{type:fe.Pointer,id:"__puppeteer_mouse",actions:c}]})}async down(t={}){await s(this,ne).connection.send("input.performActions",{context:s(this,ne).id,actions:[{type:fe.Pointer,id:"__puppeteer_mouse",actions:[{type:q.PointerDown,button:hd(t.button??d.MouseButton.Left)}]}]})}async up(t={}){await s(this,ne).connection.send("input.performActions",{context:s(this,ne).id,actions:[{type:fe.Pointer,id:"__puppeteer_mouse",actions:[{type:q.PointerUp,button:hd(t.button??d.MouseButton.Left)}]}]})}async click(t,r,i={}){const o=[{type:q.PointerMove,x:Math.round(t),y:Math.round(r),origin:i.origin}],a={type:q.PointerDown,button:hd(i.button??d.MouseButton.Left)},c={type:q.PointerUp,button:a.button};for(let l=1;l<(i.count??1);++l)o.push(a,c);o.push(a),i.delay&&o.push({type:q.Pause,duration:i.delay}),o.push(c),await s(this,ne).connection.send("input.performActions",{context:s(this,ne).id,actions:[{type:fe.Pointer,id:"__puppeteer_mouse",actions:o}]})}async wheel(t={}){await s(this,ne).connection.send("input.performActions",{context:s(this,ne).id,actions:[{type:fe.Wheel,id:"__puppeteer_wheel",actions:[{type:q.Scroll,...s(this,Us)??{x:0,y:0},deltaX:t.deltaX??0,deltaY:t.deltaY??0}]}]})}drag(){throw new d.UnsupportedOperation}dragOver(){throw new d.UnsupportedOperation}dragEnter(){throw new d.UnsupportedOperation}drop(){throw new d.UnsupportedOperation}dragAndDrop(){throw new d.UnsupportedOperation}}ne=new WeakMap,Us=new WeakMap;var nt;class af extends d.Touchscreen{constructor(t){super();u(this,nt,void 0);h(this,nt,t)}async touchStart(t,r,i={}){await s(this,nt).connection.send("input.performActions",{context:s(this,nt).id,actions:[{type:fe.Pointer,id:"__puppeteer_finger",parameters:{pointerType:"touch"},actions:[{type:q.PointerMove,x:Math.round(t),y:Math.round(r),origin:i.origin},{type:q.PointerDown,button:0}]}]})}async touchMove(t,r,i={}){await s(this,nt).connection.send("input.performActions",{context:s(this,nt).id,actions:[{type:fe.Pointer,id:"__puppeteer_finger",parameters:{pointerType:"touch"},actions:[{type:q.PointerMove,x:Math.round(t),y:Math.round(r),origin:i.origin}]}]})}async touchEnd(){await s(this,nt).connection.send("input.performActions",{context:s(this,nt).id,actions:[{type:fe.Pointer,id:"__puppeteer_finger",parameters:{pointerType:"touch"},actions:[{type:q.PointerUp,button:0}]}]})}}nt=new WeakMap;var _o,ko,Io,Ls,Ro,To,Do;class hl extends d.HTTPRequest{constructor(t,r,i=[]){super();I(this,"_response",null);I(this,"_redirectChain");I(this,"_navigationId");u(this,_o,void 0);u(this,ko,void 0);u(this,Io,void 0);u(this,Ls,void 0);u(this,Ro,{});u(this,To,void 0);u(this,Do,void 0);h(this,_o,t.request.url),h(this,ko,t.initiator.type.toLowerCase()),h(this,Io,t.request.method),h(this,Ls,void 0),h(this,To,t.initiator),h(this,Do,r),this._requestId=t.request.request,this._redirectChain=i,this._navigationId=t.navigation;for(const o of t.request.headers)o.value.type==="string"&&(s(this,Ro)[o.name.toLowerCase()]=o.value.value)}get client(){throw new d.UnsupportedOperation}url(){return s(this,_o)}resourceType(){return s(this,ko)}method(){return s(this,Io)}postData(){return s(this,Ls)}hasPostData(){return s(this,Ls)!==void 0}async fetchPostData(){return s(this,Ls)}headers(){return s(this,Ro)}response(){return this._response}isNavigationRequest(){return!!this._navigationId}initiator(){return s(this,To)}redirectChain(){return this._redirectChain.slice()}enqueueInterceptAction(t){t()}frame(){return s(this,Do)}continueRequestOverrides(){throw new d.UnsupportedOperation}continue(t={}){throw new d.UnsupportedOperation}responseForRequest(){throw new d.UnsupportedOperation}abortErrorReason(){throw new d.UnsupportedOperation}interceptResolutionState(){throw new d.UnsupportedOperation}isInterceptResolutionHandled(){throw new d.UnsupportedOperation}finalizeInterceptions(){throw new d.UnsupportedOperation}abort(){throw new d.UnsupportedOperation}respond(t,r){throw new d.UnsupportedOperation}failure(){throw new d.UnsupportedOperation}}_o=new WeakMap,ko=new WeakMap,Io=new WeakMap,Ls=new WeakMap,Ro=new WeakMap,To=new WeakMap,Do=new WeakMap;var yn,Oo,No,Mo,Fo,jo,Bo,Ao;class cf extends d.HTTPResponse{constructor(t,{response:r}){super();u(this,yn,void 0);u(this,Oo,void 0);u(this,No,void 0);u(this,Mo,void 0);u(this,Fo,void 0);u(this,jo,void 0);u(this,Bo,{});u(this,Ao,void 0);h(this,yn,t),h(this,Oo,{ip:"",port:-1}),h(this,Fo,r.url),h(this,jo,r.fromCache),h(this,No,r.status),h(this,Mo,r.statusText),h(this,Ao,null);for(const i of r.headers||[])i.value.type==="string"&&(s(this,Bo)[i.name.toLowerCase()]=i.value.value)}remoteAddress(){return s(this,Oo)}url(){return s(this,Fo)}status(){return s(this,No)}statusText(){return s(this,Mo)}headers(){return s(this,Bo)}request(){return s(this,yn)}fromCache(){return s(this,jo)}timing(){return s(this,Ao)}frame(){return s(this,yn).frame()}fromServiceWorker(){return!1}securityDetails(){throw new d.UnsupportedOperation}buffer(){throw new d.UnsupportedOperation}}yn=new WeakMap,Oo=new WeakMap,No=new WeakMap,Mo=new WeakMap,Fo=new WeakMap,jo=new WeakMap,Bo=new WeakMap,Ao=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Xt,$o,Jt,Ie,Yt,eu,df,tu,lf,su,hf,ru,pf;class uf extends d.EventEmitter{constructor(t,r){super();u(this,eu);u(this,tu);u(this,su);u(this,ru);u(this,Xt,void 0);u(this,$o,void 0);u(this,Jt,new d.DisposableStack);u(this,Ie,new Map);u(this,Yt,new Map);h(this,Xt,t),h(this,$o,r),s(this,Jt).use(new d.EventSubscription(s(this,Xt),"network.beforeRequestSent",f(this,eu,df).bind(this))),s(this,Jt).use(new d.EventSubscription(s(this,Xt),"network.responseStarted",f(this,tu,lf).bind(this))),s(this,Jt).use(new d.EventSubscription(s(this,Xt),"network.responseCompleted",f(this,su,hf).bind(this))),s(this,Jt).use(new d.EventSubscription(s(this,Xt),"network.fetchError",f(this,ru,pf).bind(this)))}getNavigationResponse(t){return t?s(this,Yt).get(t)??null:null}inFlightRequestsCount(){let t=0;for(const r of s(this,Ie).values())(!r.response()||r._failureText)&&t++;return t}clearMapAfterFrameDispose(t){for(const[r,i]of s(this,Ie).entries())i.frame()===t&&s(this,Ie).delete(r);for(const[r,i]of s(this,Yt).entries())i.frame()===t&&s(this,Yt).delete(r)}dispose(){this.removeAllListeners(),s(this,Ie).clear(),s(this,Yt).clear(),s(this,Jt).dispose()}}Xt=new WeakMap,$o=new WeakMap,Jt=new WeakMap,Ie=new WeakMap,Yt=new WeakMap,eu=new WeakSet,df=function(t){const r=s(this,$o).frame(t.context??"");if(!r)return;const i=s(this,Ie).get(t.request.request);let o;i?(i._redirectChain.push(i),o=new hl(t,r,i._redirectChain)):o=new hl(t,r,[]),s(this,Ie).set(t.request.request,o),this.emit(d.NetworkManagerEvent.Request,o)},tu=new WeakSet,lf=function(t){},su=new WeakSet,hf=function(t){const r=s(this,Ie).get(t.request.request);if(!r)return;const i=new cf(r,t);r._response=i,t.navigation&&s(this,Yt).set(t.navigation,i),i.fromCache()&&this.emit(d.NetworkManagerEvent.RequestServedFromCache,r),this.emit(d.NetworkManagerEvent.Response,i),this.emit(d.NetworkManagerEvent.RequestFinished,r)},ru=new WeakSet,pf=function(t){const r=s(this,Ie).get(t.request.request);r&&(r._failureText=t.errorText,this.emit(d.NetworkManagerEvent.RequestFailed,r),s(this,Ie).delete(t.request.request))};/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var jy=globalThis&&globalThis.__addDisposableResource||function(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose]}if(typeof r!="function")throw new TypeError("Object not disposable.");n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e},By=globalThis&&globalThis.__disposeResources||function(n){return function(e){function t(i){e.error=e.hasError?new n(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}function r(){for(;e.stack.length;){var i=e.stack.pop();try{var o=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(o).then(r,function(a){return t(a),r()})}catch(a){t(a)}}if(e.hasError)throw e.error}return r()}}(typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r}),Uo,se,Ae,Qt,vn,qs,nu,iu,ou,Lo,qo,le,Ko,Ho,zo,Wo,Zt,Ks,Vo,au,mf,cu,gf,uu,wf,du,yf,lu,vf,Go,pl,hu,bf,pu,xf,Xo,fl;class ff extends d.Page{constructor(t,r,i){super();u(this,au);u(this,cu);u(this,uu);u(this,du);u(this,lu);u(this,Go);u(this,hu);u(this,pu);u(this,Xo);u(this,Uo,void 0);u(this,se,void 0);u(this,Ae,new d.FrameTree);u(this,Qt,void 0);u(this,vn,null);u(this,qs,d.Deferred.create());u(this,nu,new Map([["log.entryAdded",f(this,hu,bf).bind(this)],["browsingContext.load",f(this,au,mf).bind(this)],["browsingContext.fragmentNavigated",f(this,cu,gf).bind(this)],["browsingContext.domContentLoaded",f(this,uu,wf).bind(this)],["browsingContext.userPromptOpened",f(this,pu,xf).bind(this)]]));u(this,iu,[[d.NetworkManagerEvent.Request,t=>{this.emit("request",t)}],[d.NetworkManagerEvent.RequestServedFromCache,t=>{this.emit("requestservedfromcache",t)}],[d.NetworkManagerEvent.RequestFailed,t=>{this.emit("requestfailed",t)}],[d.NetworkManagerEvent.RequestFinished,t=>{this.emit("requestfinished",t)}],[d.NetworkManagerEvent.Response,t=>{this.emit("response",t)}]]);u(this,ou,new Map([[exports.BrowsingContextEvent.Created,f(this,du,yf).bind(this)],[exports.BrowsingContextEvent.Destroyed,f(this,lu,vf).bind(this)]]));u(this,Lo,void 0);u(this,qo,void 0);u(this,le,void 0);u(this,Ko,void 0);u(this,Ho,void 0);u(this,zo,void 0);u(this,Wo,void 0);u(this,Zt,void 0);u(this,Ks,void 0);u(this,Vo,void 0);h(this,Zt,t),h(this,Ks,r),h(this,Vo,i),h(this,se,t.connection);for(const[a,c]of s(this,ou))s(this,Zt).on(a,c);h(this,Qt,new uf(s(this,se),this));for(const[a,c]of s(this,nu))s(this,se).on(a,c);for(const[a,c]of s(this,iu))s(this,Qt).on(a,c);const o=new ll(this,s(this,Zt),this._timeoutSettings,s(this,Zt).parent);s(this,Ae).addFrame(o),this.emit("frameattached",o),h(this,Uo,new d.Accessibility(this.mainFrame().context().cdpSession)),h(this,Lo,new d.Tracing(this.mainFrame().context().cdpSession)),h(this,qo,new d.Coverage(this.mainFrame().context().cdpSession)),h(this,le,new d.EmulationManager(this.mainFrame().context().cdpSession)),h(this,Ko,new Dy(t)),h(this,Ho,new of(this.mainFrame().context())),h(this,zo,new af(this.mainFrame().context())),h(this,Wo,new nf(this))}_client(){return this.mainFrame().context().cdpSession}get connection(){return s(this,se)}async setUserAgent(t,r){await this._client().send("Network.setUserAgentOverride",{userAgent:t,userAgentMetadata:r})}async setBypassCSP(t){await this._client().send("Page.setBypassCSP",{enabled:t})}async queryObjects(t){d.assert(!t.disposed,"Prototype JSHandle is disposed!"),d.assert(t.id,"Prototype JSHandle must not be referencing primitive value");const r=await this.mainFrame().client.send("Runtime.queryObjects",{prototypeObjectId:t.id});return Ra(this.mainFrame().mainRealm(),{type:"array",handle:r.objects.objectId})}_setBrowserContext(t){h(this,Ks,t)}get accessibility(){return s(this,Uo)}get tracing(){return s(this,Lo)}get coverage(){return s(this,qo)}get mouse(){return s(this,Ho)}get touchscreen(){return s(this,zo)}get keyboard(){return s(this,Wo)}browser(){return this.browserContext().browser()}browserContext(){return s(this,Ks)}mainFrame(){const t=s(this,Ae).getMainFrame();return d.assert(t,"Requesting main frame too early!"),t}async focusedFrame(){const t={stack:[],error:void 0,hasError:!1};try{const r=jy(t,await this.mainFrame().isolatedRealm().evaluateHandle(()=>{let i,o=window;for(;(o==null?void 0:o.document.activeElement)instanceof HTMLIFrameElement;)i=o.document.activeElement,o=i.contentWindow;return i}),!1);return r instanceof ca?await r.contentFrame():this.mainFrame()}catch(r){t.error=r,t.hasError=!0}finally{By(t)}}frames(){return Array.from(s(this,Ae).frames())}frame(t){return s(this,Ae).getById(t??"")||null}childFrames(t){return s(this,Ae).childFrames(t)}getNavigationResponse(t){return s(this,Qt).getNavigationResponse(t)}isClosed(){return s(this,qs).finished()}async close(t){s(this,qs).finished()||(s(this,qs).reject(new d.TargetCloseError("Page closed!")),s(this,Qt).dispose(),await s(this,se).send("browsingContext.close",{context:this.mainFrame()._id,promptUnload:(t==null?void 0:t.runBeforeUnload)??!1}),this.emit("close",void 0),this.removeAllListeners())}async reload(t={}){const{waitUntil:r="load",timeout:i=this._timeoutSettings.navigationTimeout()}=t,[o,a]=rf(r),c=d.Ee(d.F(s(this,se).send("browsingContext.reload",{context:this.mainFrame()._id,wait:o})),...a!==null?[this.waitForNetworkIdle$({timeout:i,concurrency:a==="networkidle2"?2:0,idleTime:d.NETWORK_IDLE_TIME})]:[]).pipe(d.k(([{result:p}])=>p),d.Fe(d.timeout(i),d.F(s(this,qs).valueOrThrow())),ul(this.url(),i)),l=await d.me(c);return this.getNavigationResponse(l.navigation)}setDefaultNavigationTimeout(t){this._timeoutSettings.setDefaultNavigationTimeout(t)}setDefaultTimeout(t){this._timeoutSettings.setDefaultTimeout(t)}getDefaultTimeout(){return this._timeoutSettings.timeout()}isJavaScriptEnabled(){return s(this,le).javascriptEnabled}async setGeolocation(t){return await s(this,le).setGeolocation(t)}async setJavaScriptEnabled(t){return await s(this,le).setJavaScriptEnabled(t)}async emulateMediaType(t){return await s(this,le).emulateMediaType(t)}async emulateCPUThrottling(t){return await s(this,le).emulateCPUThrottling(t)}async emulateMediaFeatures(t){return await s(this,le).emulateMediaFeatures(t)}async emulateTimezone(t){return await s(this,le).emulateTimezone(t)}async emulateIdleState(t){return await s(this,le).emulateIdleState(t)}async emulateVisionDeficiency(t){return await s(this,le).emulateVisionDeficiency(t)}async setViewport(t){if(!s(this,Zt).supportsCdp()){await s(this,Ko).emulateViewport(t),h(this,vn,t);return}const r=await s(this,le).emulateViewport(t);h(this,vn,t),r&&await this.reload()}viewport(){return s(this,vn)}async pdf(t={}){const{timeout:r=this._timeoutSettings.timeout(),path:i=void 0}=t,{printBackground:o,margin:a,landscape:c,width:l,height:p,pageRanges:g,scale:m,preferCSSPageSize:x}=d.parsePDFOptions(t,"cm"),C=g?g.split(", "):[],{result:v}=await d.me(d.F(s(this,se).send("browsingContext.print",{context:this.mainFrame()._id,background:o,margin:a,orientation:c?"landscape":"portrait",page:{width:l,height:p},pageRanges:C,scale:m,shrinkToFit:!x})).pipe(d.Fe(d.timeout(r)))),w=Buffer.from(v.data,"base64");return await this._maybeWriteBufferToFile(i,w),w}async createPDFStream(t){const r=await this.pdf(t);return new ReadableStream({start(i){i.enqueue(r),i.close()}})}async _screenshot(t){const{clip:r,type:i,captureBeyondViewport:o,quality:a}=t;if(t.omitBackground!==void 0&&t.omitBackground)throw new d.UnsupportedOperation("BiDi does not support 'omitBackground'.");if(t.optimizeForSpeed!==void 0&&t.optimizeForSpeed)throw new d.UnsupportedOperation("BiDi does not support 'optimizeForSpeed'.");if(t.fromSurface!==void 0&&!t.fromSurface)throw new d.UnsupportedOperation("BiDi does not support 'fromSurface'.");if(r!==void 0&&r.scale!==void 0&&r.scale!==1)throw new d.UnsupportedOperation("BiDi does not support 'scale' in 'clip'.");let c;if(r)if(o)c=r;else{const[p,g]=await this.evaluate(()=>{if(!window.visualViewport)throw new Error("window.visualViewport is not supported.");return[window.visualViewport.pageLeft,window.visualViewport.pageTop]});c={...r,x:r.x-p,y:r.y-g}}const{result:{data:l}}=await s(this,se).send("browsingContext.captureScreenshot",{context:this.mainFrame()._id,origin:o?"document":"viewport",format:{type:`image/${i}`,...a!==void 0?{quality:a/100}:{}},...c?{clip:{type:"box",...c}}:{}});return l}async createCDPSession(){const{sessionId:t}=await this.mainFrame().context().cdpSession.send("Target.attachToTarget",{targetId:this.mainFrame()._id,flatten:!0});return new Qu(this.mainFrame().context(),t)}async bringToFront(){await s(this,se).send("browsingContext.activate",{context:this.mainFrame()._id})}async evaluateOnNewDocument(t,...r){const i=Ly(t,...r),{result:o}=await s(this,se).send("script.addPreloadScript",{functionDeclaration:i,contexts:[this.mainFrame()._id]});return{identifier:o.script}}async removeScriptToEvaluateOnNewDocument(t){await s(this,se).send("script.removePreloadScript",{script:t})}async exposeFunction(t,r){return await this.mainFrame().exposeFunction(t,"default"in r?r.default:r)}isDragInterceptionEnabled(){return!1}async setCacheEnabled(t){await this._client().send("Network.setCacheDisabled",{cacheDisabled:!t})}async cookies(...t){const r=(t.length?t:[this.url()]).map(o=>new URL(o));return(await s(this,se).send("storage.getCookies",{partition:{type:"context",context:this.mainFrame()._id}})).result.cookies.map(o=>zy(o)).filter(o=>r.some(a=>Hy(o,a)))}isServiceWorkerBypassed(){throw new d.UnsupportedOperation}target(){return s(this,Vo)}waitForFileChooser(){throw new d.UnsupportedOperation}workers(){throw new d.UnsupportedOperation}setRequestInterception(){throw new d.UnsupportedOperation}setDragInterception(){throw new d.UnsupportedOperation}setBypassServiceWorker(){throw new d.UnsupportedOperation}setOfflineMode(){throw new d.UnsupportedOperation}emulateNetworkConditions(){throw new d.UnsupportedOperation}async setCookie(...t){const r=this.url(),i=r.startsWith("http");for(const o of t){let a=o.url||"";!a&&i&&(a=r),d.assert(a!=="about:blank",`Blank page can not have cookie "${o.name}"`),d.assert(!String.prototype.startsWith.call(a||"","data:"),`Data URL page can not have cookie "${o.name}"`);const c=URL.canParse(a)?new URL(a):void 0,l=o.domain??(c==null?void 0:c.hostname);d.assert(l!==void 0,"At least one of the url and domain needs to be specified");const p={domain:l,name:o.name,value:{type:"string",value:o.value},...o.path!==void 0?{path:o.path}:{},...o.httpOnly!==void 0?{httpOnly:o.httpOnly}:{},...o.secure!==void 0?{secure:o.secure}:{},...o.sameSite!==void 0?{sameSite:Xy(o.sameSite)}:{},...o.expires!==void 0?{expiry:o.expires}:{},...Vy(o,"sameParty","sourceScheme","priority","url")},g=o.partitionKey!==void 0?{type:"storageKey",sourceOrigin:o.partitionKey,userContext:s(this,Ks).id}:{type:"context",context:this.mainFrame()._id};await s(this,se).send("storage.setCookie",{cookie:p,partition:g})}}deleteCookie(){throw new d.UnsupportedOperation}removeExposedFunction(){throw new d.UnsupportedOperation}authenticate(){throw new d.UnsupportedOperation}setExtraHTTPHeaders(){throw new d.UnsupportedOperation}metrics(){throw new d.UnsupportedOperation}async goBack(t={}){return await f(this,Xo,fl).call(this,-1,t)}async goForward(t={}){return await f(this,Xo,fl).call(this,1,t)}waitForDevicePrompt(){throw new d.UnsupportedOperation}}Uo=new WeakMap,se=new WeakMap,Ae=new WeakMap,Qt=new WeakMap,vn=new WeakMap,qs=new WeakMap,nu=new WeakMap,iu=new WeakMap,ou=new WeakMap,Lo=new WeakMap,qo=new WeakMap,le=new WeakMap,Ko=new WeakMap,Ho=new WeakMap,zo=new WeakMap,Wo=new WeakMap,Zt=new WeakMap,Ks=new WeakMap,Vo=new WeakMap,au=new WeakSet,mf=function(t){const r=this.frame(t.context);r&&this.mainFrame()===r&&this.emit("load",void 0)},cu=new WeakSet,gf=function(t){const r=this.frame(t.context);r&&this.emit("framenavigated",r)},uu=new WeakSet,wf=function(t){const r=this.frame(t.context);r&&(r._hasStartedLoading=!0,this.mainFrame()===r&&this.emit("domcontentloaded",void 0),this.emit("framenavigated",r))},du=new WeakSet,yf=function(t){if(!this.frame(t.id)&&(this.frame(t.parent??"")||!s(this,Ae).getMainFrame())){const r=new ll(this,t,this._timeoutSettings,t.parent);s(this,Ae).addFrame(r),r!==this.mainFrame()&&this.emit("frameattached",r)}},lu=new WeakSet,vf=function(t){const r=this.frame(t.id);r&&(r===this.mainFrame()&&this.emit("close",void 0),f(this,Go,pl).call(this,r))},Go=new WeakSet,pl=function(t){for(const r of t.childFrames())f(this,Go,pl).call(this,r);t[d.disposeSymbol](),s(this,Qt).clearMapAfterFrameDispose(t),s(this,Ae).removeFrame(t),this.emit("framedetached",t)},hu=new WeakSet,bf=function(t){const r=this.frame(t.source.context);if(r)if(Ay(t)){const i=t.args.map(a=>Ra(r.mainRealm(),a)),o=i.reduce((a,c)=>{const l=c.isPrimitiveValue?he.deserialize(c.remoteValue()):c.toString();return`${a} ${l}`},"").slice(1);this.emit("console",new d.ConsoleMessage(t.method,o,i,Uy(t.stackTrace)))}else if($y(t)){const i=new Error(t.text??""),o=i.message.split(`
`).length,a=i.stack.split(`
`).splice(0,o),c=[];if(t.stackTrace){for(const l of t.stackTrace.callFrames)if(c.push(`    at ${l.functionName||"<anonymous>"} (${l.url}:${l.lineNumber+1}:${l.columnNumber+1})`),c.length>=Error.stackTraceLimit)break}i.stack=[...a,...c].join(`
`),this.emit("pageerror",i)}else d.debugError(`Unhandled LogEntry with type "${t.type}", text "${t.text}" and level "${t.level}"`)},pu=new WeakSet,xf=function(t){const r=this.frame(t.context);if(!r)return;const i=d.validateDialogType(t.type),o=new Ty(r.context(),i,t.message,t.defaultValue);this.emit("dialog",o)},Xo=new WeakSet,fl=async function(t,r){try{return(await Promise.all([this.waitForNavigation(r),s(this,se).send("browsingContext.traverseHistory",{delta:t,context:this.mainFrame()._id})]))[0]}catch(i){if(d.isErrorLike(i)&&i.message.includes("no such history entry"))return null;throw i}};function Ay(n){return n.type==="console"}function $y(n){return n.type==="javascript"}function Uy(n){const e=[];if(n)for(const t of n.callFrames)e.push({url:t.url,lineNumber:t.lineNumber,columnNumber:t.columnNumber});return e}function Ly(n,...e){return`() => {${d.evaluationString(n,...e)}}`}function qy(n,e){const t=n.domain.toLowerCase(),r=e.hostname.toLowerCase();return t===r}function Ky(n,e){const t=e.pathname,r=n.path;return!!(t===r||t.startsWith(r)&&(r.endsWith("/")||t[r.length]==="/"))}function Hy(n,e){const t=new URL(e);return d.assert(n!==void 0),qy(n,t)?Ky(n,t):!1}function zy(n){return{name:n.name,value:n.value.value,domain:n.domain,path:n.path,size:n.size,httpOnly:n.httpOnly,secure:n.secure,sameSite:Gy(n.sameSite),expires:n.expiry??-1,session:n.expiry===void 0||n.expiry<=0,...Wy(n,"sameParty","sourceScheme","partitionKey","partitionKeyOpaque","priority")}}const ml="goog:";function Wy(n,...e){const t={};for(const r of e)n[ml+r]!==void 0&&(t[r]=n[ml+r]);return t}function Vy(n,...e){const t={};for(const r of e)n[r]!==void 0&&(t[ml+r]=n[r]);return t}function Gy(n){return n==="strict"?"Strict":n==="lax"?"Lax":"None"}function Xy(n){return n==="Strict"?"strict":n==="Lax"?"lax":"none"}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Cf extends d.Target{constructor(t){super();I(this,"_browserContext");this._browserContext=t}_setBrowserContext(t){this._browserContext=t}asPage(){throw new d.UnsupportedOperation}browser(){return this._browserContext.browser()}browserContext(){return this._browserContext}opener(){throw new d.UnsupportedOperation}createCDPSession(){throw new d.UnsupportedOperation}}var bn;class Ef extends d.Target{constructor(t){super();u(this,bn,void 0);h(this,bn,t)}url(){return""}type(){return d.TargetType.BROWSER}asPage(){throw new d.UnsupportedOperation}browser(){return s(this,bn)}browserContext(){return s(this,bn).defaultBrowserContext()}opener(){throw new d.UnsupportedOperation}createCDPSession(){throw new d.UnsupportedOperation}}bn=new WeakMap;class Sl extends Cf{constructor(t,r){super(t);I(this,"_browsingContext");this._browsingContext=r}url(){return this._browsingContext.url}async createCDPSession(){const{sessionId:t}=await this._browsingContext.cdpSession.send("Target.attachToTarget",{targetId:this._browsingContext.id,flatten:!0});return new Qu(this._browsingContext,t)}type(){return d.TargetType.PAGE}}var xn;class Sf extends Sl{constructor(t,r){super(t,r);u(this,xn,void 0);h(this,xn,new ff(r,t,this))}async page(){return s(this,xn)}_setBrowserContext(t){super._setBrowserContext(t),s(this,xn)._setBrowserContext(t)}}xn=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Cn,Jo,ie,Yo,it,En,Sn,Qo,fu,Pf,Zo,wl,mu,_f,ea,yl,gu,kf,ta,vl,sa,bl,wu,If,yu,Rf;const St=class St extends d.Browser{constructor(t,r){super();u(this,fu);u(this,Zo);u(this,mu);u(this,ea);u(this,gu);u(this,ta);u(this,sa);u(this,wu);u(this,yu);I(this,"protocol","webDriverBiDi");u(this,Cn,void 0);u(this,Jo,void 0);u(this,ie,void 0);u(this,Yo,void 0);u(this,it,new Map);u(this,En,new WeakMap);u(this,Sn,void 0);u(this,Qo,new Map([["browsingContext.contextCreated",f(this,sa,bl).bind(this)],["browsingContext.contextDestroyed",f(this,yu,Rf).bind(this)],["browsingContext.domContentLoaded",f(this,gu,kf).bind(this)],["browsingContext.fragmentNavigated",f(this,ta,vl).bind(this)],["browsingContext.navigationStarted",f(this,ta,vl).bind(this)]]));h(this,Cn,r.process),h(this,Jo,r.closeCallback),h(this,ie,t),h(this,Yo,r.defaultViewport),h(this,Sn,new Ef(this));for(const i of s(this,ie).userContexts)f(this,ea,yl).call(this,i)}static async create(t){var o,a;const r=await Ry.from(t.connection,{alwaysMatch:{acceptInsecureCerts:t.ignoreHTTPSErrors,webSocketUrl:!0}});await r.subscribe(r.capabilities.browserName.toLocaleLowerCase().includes("firefox")?St.subscribeModules:[...St.subscribeModules,...St.subscribeCdpEvents]);const i=new St(r.browser,t);return f(o=i,fu,Pf).call(o),await f(a=i,wu,If).call(a),i}userAgent(){throw new d.UnsupportedOperation}get connection(){return s(this,ie).session.connection}wsEndpoint(){return this.connection.url}async close(){var t;for(const[r,i]of s(this,Qo))this.connection.off(r,i);if(!this.connection.closed)try{await s(this,ie).close(),await((t=s(this,Jo))==null?void 0:t.call(null))}catch(r){d.debugError(r)}finally{this.connection.dispose()}}get connected(){return!s(this,ie).disposed}process(){return s(this,Cn)??null}async createBrowserContext(t){const r=await s(this,ie).createUserContext();return f(this,ea,yl).call(this,r)}async version(){return`${s(this,Zo,wl)}/${s(this,mu,_f)}`}browserContexts(){return[...s(this,ie).userContexts].map(t=>s(this,En).get(t))}defaultBrowserContext(){return s(this,En).get(s(this,ie).defaultUserContext)}newPage(){return this.defaultBrowserContext().newPage()}targets(){return[s(this,Sn),...Array.from(s(this,it).values())]}_getTargetById(t){const r=s(this,it).get(t);if(!r)throw new Error("Target not found");return r}target(){return s(this,Sn)}async disconnect(){try{await s(this,ie).session.end()}catch(t){d.debugError(t)}finally{this.connection.dispose()}}get debugInfo(){return{pendingProtocolErrors:this.connection.getPendingProtocolErrors()}}};Cn=new WeakMap,Jo=new WeakMap,ie=new WeakMap,Yo=new WeakMap,it=new WeakMap,En=new WeakMap,Sn=new WeakMap,Qo=new WeakMap,fu=new WeakSet,Pf=function(){var t;s(this,ie).once("disconnected",()=>{this.emit("disconnected",void 0)}),(t=s(this,Cn))==null||t.once("close",()=>{s(this,ie).dispose("Browser process exited.",!0),this.connection.dispose()});for(const[r,i]of s(this,Qo))this.connection.on(r,i)},Zo=new WeakSet,wl=function(){return s(this,ie).session.capabilities.browserName},mu=new WeakSet,_f=function(){return s(this,ie).session.capabilities.browserVersion},ea=new WeakSet,yl=function(t){const r=new Jp(this,t,{defaultViewport:s(this,Yo)});return s(this,En).set(t,r),r},gu=new WeakSet,kf=function(t){const r=s(this,it).get(t.context);r&&(this.emit("targetchanged",r),r.browserContext().emit("targetchanged",r))},ta=new WeakSet,vl=function(t){const r=s(this,it).get(t.context);r&&(this.emit("targetchanged",r),r.browserContext().emit("targetchanged",r))},sa=new WeakSet,bl=function(t){const r=new $p(this.connection,t,s(this,Zo,wl));this.connection.registerBrowsingContexts(r);const i=t.userContext==="default"?this.defaultBrowserContext():this.browserContexts().find(a=>a.id===t.userContext);if(!i)throw new Error("Missing browser contexts");const o=r.parent?new Sl(i,r):new Sf(i,r);s(this,it).set(t.context,o),this.emit("targetcreated",o),o.browserContext().emit("targetcreated",o),r.parent&&this.connection.getTopLevelContext(r.parent).emit(exports.BrowsingContextEvent.Created,r)},wu=new WeakSet,If=async function(){const{result:t}=await this.connection.send("browsingContext.getTree",{});for(const r of t.contexts)f(this,sa,bl).call(this,r)},yu=new WeakSet,Rf=async function(t){const r=this.connection.getBrowsingContext(t.context);this.connection.getTopLevelContext(t.context).emit(exports.BrowsingContextEvent.Destroyed,r);const o=s(this,it).get(t.context),a=await(o==null?void 0:o.page());await(a==null?void 0:a.close().catch(d.debugError)),s(this,it).delete(t.context),o&&(this.emit("targetdestroyed",o),o.browserContext().emit("targetdestroyed",o))},I(St,"subscribeModules",["browsingContext","network","log","script"]),I(St,"subscribeCdpEvents",["cdp.Debugger.scriptParsed","cdp.CSS.styleSheetAdded","cdp.Runtime.executionContextsCleared","cdp.Tracing.tracingComplete","cdp.Network.requestWillBeSent","cdp.Debugger.scriptParsed","cdp.Page.screencastFrame"]);let gl=St;exports.BiDiBrowserTarget=Ef;exports.BiDiBrowsingContextTarget=Sl;exports.BiDiPageTarget=Sf;exports.BidiBrowser=gl;exports.BidiBrowserContext=Jp;exports.BidiConnection=Up;exports.BidiElementHandle=ca;exports.BidiFrame=ll;exports.BidiHTTPRequest=hl;exports.BidiHTTPResponse=cf;exports.BidiJSHandle=Yu;exports.BidiKeyboard=nf;exports.BidiMouse=of;exports.BidiNetworkManager=uf;exports.BidiPage=ff;exports.BidiRealm=il;exports.BidiTarget=Cf;exports.BidiTouchscreen=af;exports.BrowsingContext=$p;exports.CdpSessionWrapper=Qu;exports.MAIN_SANDBOX=ka;exports.PUPPETEER_SANDBOX=Ia;exports.Sandbox=dl;exports.cdpSessions=zn;exports.connectBidiOverCdp=uy;exports.createBidiHandle=Ra;
